<?xml version="1.0"?>
  <!DOCTYPE  viewdef [
  <!ENTITY nbsp "&#160;">
  <!ENTITY copy "&#169;">
  <!ENTITY shy  "&#173;">
]>

<!-- Copyright (c) 1996-2008 Xerox Corporation.  All Rights Reserved.
  Copyright protection claimed includes all forms and matters of copyrightable material
  and information now allowed by statutory or judicial law or herein after granted. -->

<viewdef cdata-section-elements="script"
         messages="dslibMessages.vdf">
  <if cond="${viewdef:dslib:runjs}=='Yes'"></if>
  <define id="cgi"><insert ref="request:config:cmd_base"/></define>
  <define id="global_style">
    <if cond="${viewdef:dslib:routingEnabled}=='Yes'">
      <script type="text/javascript" src="${request:config:abs_path}javascript/common/ds_routing.js?v=${request:config:short_version}" />
    </if>
  </define>

  <!--for jsr168 portlet, set the window target to be _self. otherwise, the window target is _parent  -->
  <define id="window_target"><if cond="${request:get_cmd_arg(argname='portalStyle')}!='naked'">_parent<else>_self</else></if></define>

  <define id="space"><img src="${request:config:abs_path}images/local/sp.gif" width="1" height="$height" border="0" alt="" title=""/></define>
  <define id="space5"><img src="${request:config:abs_path}images/local/sp.gif" width="5" height="1" border="0" alt="" title=""/></define>
  <define id="abs_path"><insert ref="request:config:abs_path"/></define>

  <define id="runjs"><if cond="${request:config:enable_javascript}=='true' and ${request:user_obj:javascriptOn}=='true' and ${request:get_cmd_arg(argname='portalType')}!='sharepointWP'">Yes<else>No</else></if></define>
  <define id="runwysiwyg"><if cond="${request:config:enable_wysiwyg}=='true' and ${request:user_obj:use_rich_text_edit}=='true'">Yes<else>No</else></if></define>
  <define id="routingEnabled"><if cond="${request:config:enable_routing}=='true' and ${request:is_licensed( key='basic_workflow_service' )} and ${local:runjs}=='Yes'">Yes<else>No</else></if></define>
  <define id="report_generatorEnabled"><if cond="${request:is_licensed( key='report_generator' )}">Yes<else>No</else></if></define> 
  <define id="scanningEnabled"><if cond="${request:config:enable_scanning}=='true'">Yes<else>No</else></if></define>
  <define id="langroot"><insert ref="request:config:abs_path"/><insert ref="request:locale:user_lang"/>/</define>
  <define id="mobileDevice"><if cond="${request:is_user_agent(name='blackberry')}">Yes<else>No</else></if></define>

  <define id="head_include">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="shortcut icon" href="${request:config:abs_path}favicon.ico?v=${request:config:short_version}" type="image/x-icon" />
    <link rel="apple-touch-icon" sizes="57x57" href="${request:config:abs_path}apple-icon-57x57.png?v=${request:config:short_version}" />
    <link rel="apple-touch-icon" sizes="60x60" href="${request:config:abs_path}apple-icon-60x60.png?v=${request:config:short_version}" />
    <link rel="apple-touch-icon" sizes="72x72" href="${request:config:abs_path}apple-icon-72x72.png?v=${request:config:short_version}" />
    <link rel="apple-touch-icon" sizes="76x76" href="${request:config:abs_path}apple-icon-76x76.png?v=${request:config:short_version}" />
    <link rel="apple-touch-icon" sizes="114x114" href="${request:config:abs_path}apple-icon-114x114.png?v=${request:config:short_version}" />
    <link rel="apple-touch-icon" sizes="120x120" href="${request:config:abs_path}apple-icon-120x120.png?v=${request:config:short_version}" />
    <link rel="apple-touch-icon" sizes="144x144" href="${request:config:abs_path}apple-icon-144x144.png?v=${request:config:short_version}" />
    <link rel="apple-touch-icon" sizes="152x152" href="${request:config:abs_path}apple-icon-152x152.png?v=${request:config:short_version}" />
    <link rel="apple-touch-icon" sizes="180x180" href="${request:config:abs_path}apple-icon-180x180.png?v=${request:config:short_version}" />
    <link rel="icon" type="image/png" sizes="192x192"  href="${request:config:abs_path}android-icon-192x192.png?v=${request:config:short_version}" />
    <link rel="icon" type="image/png" sizes="32x32" href="${request:config:abs_path}favicon-32x32.png?v=${request:config:short_version}" />
    <link rel="icon" type="image/png" sizes="96x96" href="${request:config:abs_path}favicon-96x96.png?v=${request:config:short_version}" />
    <link rel="icon" type="image/png" sizes="16x16" href="${request:config:abs_path}favicon-16x16.png?v=${request:config:short_version}" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="${request:config:abs_path}ms-icon-144x144.png?v=${request:config:short_version}" />
    <meta name="theme-color" content="#ffffff" />
    <meta name="viewport" content="width=1100" />
    <!-- DocuShare Base CSS -->
    <link rel="stylesheet" type="text/css" href="${request:theme_url}docushare.css?v=${request:config:short_version}"/>
    <link rel="stylesheet" type="text/css" href="${request:theme_url}xsltforms.css?v=${request:config:short_version}"/> <!-- TODO: integrate into docushare.css -->
    
    <!-- Using Roboto on the local server instead of from Google.    
    <if cond="${request:isSSL}">
      <link href="https://fonts.googleapis.com/css?family=Roboto:400,100,200,300,500,700&amp;amp;subset=latin,cyrillic-ext" rel="stylesheet" type="text/css" />
    <else>
      <link href="http://fonts.googleapis.com/css?family=Roboto:400,100,200,300,500,700&amp;amp;subset=latin,cyrillic-ext" rel="stylesheet" type="text/css" />
    </else>
    </if> -->
    

    <!-- Market-specific styling for XC -->
    <!-- ****************************** -->
    <if cond="not ${request:company_brand}=='FX'">
        <!-- Enterprise Edition Licensed Site -->
        <if cond="${request:is_licensed(key='enterprise_edition')}">
          <link rel="stylesheet" type="text/css" href="${request:theme_url}docushare_enterprise.css?v=${request:config:short_version}"/>

        <!-- Education Edition Licensed Site -->
        <elif cond="${request:is_licensed(key='education_edition')}">
          <link rel="stylesheet" type="text/css" href="${request:theme_url}docushare_education.css?v=${request:config:short_version}"/>
        </elif>
        </if>

    <!-- Market-specific styling for FX -->
    <!-- ****************************** -->
    <else>
        <!-- Education Edition Licensed Site -->
        <if cond="${request:is_licensed(key='education_edition')}">
          <link rel="stylesheet" type="text/css" href="${request:theme_url}docushare_education.css?v=${request:config:short_version}"/>

        <!-- CPX logo shows up only for CPX users when NOT licensed for the Education Edition -->
        <elif cond="${request:directory:is_user_level(level='cpx')}">
          <link rel="stylesheet" type="text/css" href="${request:theme_url}docushare_cpx.css?v=${request:config:short_version}"/>
        </elif>

        </if>
    </else>
    </if>

    <!-- Quick Search Feature Licensed Site (no product logo involved) -->
    <if cond="${request:is_licensed(key='file_cabinet_replacement')}">
      <link rel="stylesheet" type="text/css" href="${request:theme_url}docushare_quicksearch.css?v=${request:config:short_version}"/>
    </if>




    <if cond="${viewdef:dslib:runjs}=='Yes'">

      <insert ref="viewdef:javascript:popups_replacement_scripts_and_styles"/>

      <script type="text/javascript" src="${request:config:abs_path}javascript/common/dsutils.js?v=${request:config:short_version}" />
      <script type="text/javascript" src="${request:config:abs_path}javascript/common/dropdown2.js?v=${request:config:short_version}" />
      <script type="text/javascript" src="${request:config:abs_path}javascript/common/webex_functions.js?v=${request:config:short_version}" />

      <script language="javascript" type="text/javascript" defer="defer">
        var ckeditor_lang="<insert ref="request:locale:user_lang"/>",
            ckeditor_runwysiwyg = "<insert ref="viewdef:dslib:runwysiwyg"/>";
      </script>

      <if cond="${viewdef:dslib:runwysiwyg}=='Yes'">
        
        <!-- EA: added link to TinyMCE Javascript here:-->
        <!--
        <script type="text/javascript" src="${request:config:abs_path}javascript/tiny_mce/tiny_mce.js" />
        <script type="text/javascript" src="${request:config:abs_path}javascript/common/tinymce_init.js" /> 
        -->
        <!-- EA: end TinyMCE Javascript addition -->
        <!-- EA: added link to TinyMCE Javascript here: -->
        <!-- 
        <script language="javascript" type="text/javascript" defer="defer">
          initDS_tinyMCE('<insert ref="request:locale:user_lang"/>','<insert ref="request:theme_url"/>');
        </script> 
        -->
        <!-- <script type="text/javascript" src="${request:config:abs_path}javascript/tinymce/tinymce.min.js" data-uri="http://www.tinymce.com" data-version="4.0.21">/* */</script>-->
        <!-- EA: end TinyMCE Javascript addition -->

        <!-- Add CkEditor requirements here -->
        <script type="text/javascript" src="${request:config:abs_path}javascript/ckeditor/ckeditor.js?v=${request:config:short_version}" data-uri="http://ckeditor.com" data-version="4.4.0"/>
        <script type="text/javascript" src="${request:config:abs_path}javascript/ckeditor/adapters/jquery.js?v=${request:config:short_version}" />
        <!-- End of CKEditor requirements -->
      </if>
    </if>

    <!-- Begin TMT stylesheet items -->
    <style type="text/css">
      .TMT_find_collection_button {
	position: absolute;
	left: 168px;
	top: 32px;
	width: 33px;
	height: 32px;
	background: #247ACB;
	cursor: pointer;
	border: 1px solid #247ACB;
	text-align: center;
	padding: 0;
	-webkit-box-sizing: border-box;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
      }
      .TMT_find_collection_button i {
        color: #FFF;
	font-size: 16px;
	vertical-align: middle;
	line-height: 12px;
      } 
      .TMT_find_collection {
	padding-left: 16px;
	box-sizing: border-box;
	height: 32px;
      }
    </style>
    <!-- End TMT stylesheet items -->

</define>

<define id="head_include_customstyle">
    <if cond="${viewdef:dslib:runjs}=='Yes'">
      <insert ref="viewdef:javascript:popups_replacement_scripts_and_styles"/>

      <script type="text/javascript" src="${request:config:abs_path}javascript/common/dsutils.js?v=${request:config:short_version}" />
      <script type="text/javascript" src="${request:config:abs_path}javascript/common/drop_down.js?v=${request:config:short_version}" />
      <script type="text/javascript" src="${request:config:abs_path}javascript/common/dropdown2.js?v=${request:config:short_version}" />
      <script type="text/javascript" src="${request:config:abs_path}javascript/common/webex_functions.js?v=${request:config:short_version}" />
    </if>
  </define>

  <!-- This navbar element may be modified to customize your site
       but mustn't change the name.  Certain code expects there to
       be an element here called "navbar".  If it isn't here it will
       revert to the default navbar markup -->

  <define id="navbar">
    <!-- Admin Messages -->
    <insert ref="local:messages_admin"/>
    <!-- BEGIN HEADER -->
    <div class="header">

    <!-- EA: begin condition portalStyle != 'naked' or portalType == 'sharepointWP' -->
    <if cond="${request:get_cmd_arg(argname='portalStyle')}!='naked' or ${request:get_cmd_arg(argname='portalType')}=='sharepointWP'">
      <!-- EA: begin condition portalStyle != 'naked' or portalPortlet == '' -->
      <if cond="${request:get_cmd_arg(argname='portalStyle')}!='naked' or ${request:get_cmd_arg(argname='portalPortlet')}==''">
        <insert ref="request:html:begin_form(action='ApplySimpleSearch',validate='off',name='Search')"/>
        <div class="header__top">
        <if cond="${request:get_cmd_arg(argname='portalStyle')}!='naked'">

          <insert ref="local:global_style"/>

          <!-- Skip Navigation -->
          <if cond="${request:category}=='HomePage'">
            <a href="#contents" title="${viewdef:dslibMessages:skipToContents}" class="skipnav_header"><insert ref="viewdef:dslibMessages:skipToContents"/></a>
            <if cond="${request:directory:is_guest}">
              <a href="#loginstart" title="${viewdef:dslibMessages:skipToLogin}" class="skipnav_header"><insert ref="viewdef:dslibMessages:skipToLogin"/></a>
            </if>
            <else>
              <a href="#contents" title="${viewdef:dslibMessages:skipToContents}" class="skipnav_header"><insert ref="viewdef:dslibMessages:skipToContents"/></a>
            </else>
          </if>

          <!--Product Logo  -->
          <h1><a href="${request:config:cmd_base}Home" title="${viewdef:dslibMessages:home}">DocuShare</a></h1>

          <ul role="navigation" class="accountlinks">
            <if cond="${request:isValidUser}">
              <li class="accountlinks__login"><a href="${request:config:cmd_base}MyHomePage" title="${viewdef:dslibMessages:clickToPersonalPage}" class="accountslinks__home"><i class="icon-home">&nbsp;</i></a><a href="${request:config:cmd_base}Services/${request:user_obj:handle}" title="${viewdef:dslibMessages:clickViewProps}"><insert ref="request:user_obj:getShortName"/></a></li>
            </if>
            <if cond="not ${request:directory:is_logged_in_user} or not ${request:isValidUser}">

              <!-- Login Link -->
              <if cond="${request:category}!='HomePage'">
                <li class="accountlinks__logout"><a  href="${request:config:cmd_base}Login" title="${viewdef:dslibMessages:clickToLogin}"><insert ref="viewdef:dslibMessages:login" /></a></li>
              <else> <!-- If this page is the homepage -->
                <if cond="${request:directory:is_user_level(level='imageManager')} or
                  ${request:is_licensed(key='image_store')} or
                  ${request:is_licensed(key='file_cabinet_replacement')}">
                  <li class="accountlinks__logout"><a href="${request:config:cmd_base}Login" title="${viewdef:dslibMessages:clickToLogin}"><insert ref="viewdef:dslibMessages:login" /></a></li>
                </if>
              </else>
              </if>

            <else>
              <li class="accountlinks__logout"><a href="${request:config:cmd_base}Logout" title="${viewdef:dslibMessages:clickToLogout}" target="${window_target}"><insert ref="viewdef:dslibMessages:logout" /></a></li>
            </else>
            </if>
          </ul>
        </if>

        <!-- Search Section -->
          <div class="search__wrapper">
            <div role="search" id="subheader_search" class="search">
              <if cond="${request:category}!='SearchForm' and ${request:category}!='RefineCurrentSearch'"><!-- Hide the simple search on the advanced search page -->
                <if cond="${request:category}=='HomePage' and ${request:directory:is_user_level(level='imageManager')}">
                  <else>

                    <input type="text" size="26" class="headersearchbox search__input" placeholder="${viewdef:dslibMessages:entireSite_ph}" name="value1"  />
                    <if cond="${viewdef:dslib:runjs}=='Yes'">
                       <span title="${viewdef:dslibMessages:clickToHideSearchOpt}" style="display: none;" id="searchOptionsHide" class="search__options is-active icon-settings" onclick="showSearchOptions('search_windowshade'); return(false);">
                        
                      </span>
                      <span style="display: ;" id="searchOptionsShow" title="${viewdef:dslibMessages:clickToShowSearchOpt}" class="search__options icon-settings" onclick="showSearchOptions('search_windowshade'); return(false);">
                        
                      </span>
                    </if>
                    <input type="hidden" name="SimpleSearch" value="SimpleSearch" />
                    <input hidden="hidden" type="submit" value="${viewdef:dslibMessages:search}" name="SearchButton" style="display:none" />
                    <button name="SearchButton" class="search__submit" value="${viewdef:dslibMessages:search}"><i class="icon-search"><span/></i></button>

                    <if cond="${request:handle}!='None' and ${request:handle}!='null' and ${request:handle}!='Site' and ${request:handle}!='SearchResults' and ${request:object:is_container}">
                      <!-- begin search insideof -->
                      <div class="search__insideof">
                      <i class="icon icon-arrdown">&nbsp;</i>
                      <span><insert ref="viewdef:dslibMessages:inLabel" /></span>
                      <select size="1" name="D1" id="search__insideof__D1">
                        <option value="${request:object:handle}" data-placeholder="${viewdef:dslibMessages:thisOption_ph(className=${request:object:view_classname})}"><insert ref="viewdef:dslibMessages:thisOption(className=${request:object:view_classname})" /></option>
                        <if cond="${request:within_space}">
                          <option value="Space" data-placeholder="${viewdef:dslibMessages:spaceOnly_ph}"><insert ref="viewdef:dslibMessages:spaceOnly" /></option>
                        </if>
                        <option value="Site" data-placeholder="${viewdef:dslibMessages:entireSite_ph}"><insert ref="viewdef:dslibMessages:entireSite" /></option>

                        <if cond="${request:federated:isFederated}=='true'">
                          <option value="AllFederated" data-placeholder="${viewdef:dslibMessages:allFedSites_ph}"><insert ref="viewdef:dslibMessages:allFedSites" /></option>
                        </if>
                      </select>
                      </div>
                      <else>

                        <if cond="${request:federated:isFederated}=='true'">
                          <div class="search__insideof">
                            <i class="icon icon-arrdown">&nbsp;</i>
                            <span><insert ref="viewdef:dslibMessages:inLabel" /></span>
                            <select class="subheader_formtext" size="1" name="D1" id="search__insideof__D1">
                              <if cond="${request:within_space}">
                                <option value="Space" data-placeholder="${viewdef:dslibMessages:spaceOnly_ph}"><insert ref="viewdef:dslibMessages:spaceOnly" /></option>
                              </if>
                              <option value="Site" data-placeholder="${viewdef:dslibMessages:entireSite_ph}"><insert ref="viewdef:dslibMessages:entireSite" /></option>
                              <option value="AllFederated" data-placeholder="${viewdef:dslibMessages:allFedSites_ph}"><insert ref="viewdef:dslibMessages:allFedSites" /></option>
                            </select>
                          </div>
                        <elif cond="${request:within_space}">
                          <div class="search__insideof">
                            <i class="icon icon-arrdown">&nbsp;</i>
                            <select size="1" name="D1" id="search__insideof__D1">
                              <option value="Space" data-placeholder="${viewdef:dslibMessages:spaceOnly_ph}"><insert ref="viewdef:dslibMessages:spaceOnly" /></option>
                              <option value="Site" data-placeholder="${viewdef:dslibMessages:entireSite_ph}"><insert ref="viewdef:dslibMessages:entireSite" /></option>
                            </select>
                          </div>
                        </elif>
                        <else>
                            <input type="hidden" name="D1" value="Site" placeholder="${viewdef:dslibMessages:entireSite_ph}" id="search__insideof__D1"/>
                        </else>
                        </if>
                        
                      </else>
                      <!-- end search__insideof -->
                    </if>

                  </else>
                </if>
              </if>
              <!-- Begin TMT Collection Search -->
	      <br/><input id="TMT_find_collection" type="text" size="20" class="TMT_find_collection" placeholder="${viewdef:TMTMessages:FindCollection_ph}" name="TMT_find_collection" />
	      <button name="TMT_find_collection_button" id="TMT_find_collection_button" class="TMT_find_collection_button" value="TMT_find_collection_button" onclick="redirect(this);"><i class="icon-search" onclick="redirect(this);"><span onclick="redirect(this);"/></i></button>
              <!-- End TMT Collection Search -->
            </div> <!-- end search -->
            
            <!-- Advanced Search -->
            <div class="search__advanced__cell">
              <if cond="${request:handle}!='None' and ${request:handle}!='null' and ${request:handle}!='Site' and ${request:handle}!='SearchResults' and ${request:object:is_container}">
                <a class="search__advanced" href="${request:config:cmd_base}SearchForm/${request:handle}" title="${viewdef:dslibMessages:clickForAdv}"><insert ref="viewdef:dslibMessages:advanced" /></a>
                <else>
                  <a class="search__advanced" href="${request:config:cmd_base}SearchForm/${request:context}" title="${viewdef:dslibMessages:clickForAdv}"><insert ref="viewdef:dslibMessages:advanced" /></a>
                </else>
              </if>
            </div>

          </div> <!-- end search__wrapper -->
        </div> <!-- end header_top -->

        <!-- Basic Search WindowShade Row -->
        <div role="search" class="search__expanded" id="search_windowshade" style="display:none">
          <div class="search__close icon-x" onclick="showSearchOptions('search_windowshade'); return(false);">&nbsp;</div>
          <h2 class="search__title"><insert ref="viewdef:dslibMessages:extendedSearch" /></h2>
        

          <div class="column1">
            <span class="labelwrapper"><label for="string_prop"><insert ref="viewdef:dslib:PropHelp(name='search_text_contains')"/></label></span>
            <select name="string_prop" size="1" tabindex="1">
              <option value="any" selected="selected"><insert ref="viewdef:dslibMessages:antText" /></option>
              <option value="Object.title,Object.summary,Object.description,Object.keywords,content"><insert ref="viewdef:dslibMessages:listOfKeywords" /></option>
              <option value="Object.title,Object.summary,Object.description,Object.keywords"><insert ref="viewdef:dslibMessages:listOfKeywords2" /></option>
              <if cond="${request:is_licensed( key='full_text_search' )}">
                <option value="content"><insert ref="viewdef:dslibMessages:documentOnly" /></option>
              </if>
              <option value="Object.keywords"><insert ref="viewdef:dslibMessages:keywordsOnly" /></option>
              <option value="owner"><insert ref="viewdef:dslibMessages:ownerOnly" /></option>
              <if cond="${request:is_licensed( key='records_management' )}">
                <option value="Object.readyForDeclare"><insert ref="viewdef:dslibMessages:readyForDeclare" /></option>
              </if>
            </select>

            <span class="labelwrapper"><label for="date_value"><insert ref="viewdef:dslib:PropHelp(name='search_last_modified')"/></label></span>
            <select name="date_value" size="1" tabindex="1">
              <option value="none" selected="selected"><insert ref="viewdef:dslibMessages:none" /></option>
              <option value="86400"><insert ref="viewdef:dslibMessages:today" /></option>     <!-- 24x60x60 -->
              <option value="172800"><insert ref="viewdef:dslibMessages:sinceYesterday" /></option>   <!-- 2x24x60x60 -->
              <option value="604800"><insert ref="viewdef:dslibMessages:withinLastWeek" /></option> <!-- 7x24x60x60 -->
              <option value="1209600"><insert ref="viewdef:dslibMessages:winthin2Weeks" /></option><!-- 14x24x60x60 -->
              <option value="2592000"><insert ref="viewdef:dslibMessages:withinLastMonth" /></option> <!-- 30x24x60x60 -->
              <option value="2592000"><insert ref="viewdef:dslibMessages:withinLastMonth" /></option> <!-- 30x24x60x60 -->
              <option value="5270400"><insert ref="viewdef:dslibMessages:winthinLast2Months" /></option><!-- 61x24x60x60 -->
              <option value="15811200"><insert ref="viewdef:dslibMessages:withinLast6Months" /></option><!-- 183x24x60x60 -->
              <option value="31536000"><insert ref="viewdef:dslibMessages:withinLastYear" /></option> <!-- 365x24x60x60 -->
            </select>
          </div>

          <div class="column2">
            <span class="labelwrapper"><label for="date_value"><insert ref="viewdef:dslib:PropHelp(name='object_type')"/></label></span>
            <select name="object_type" size="1" tabindex="1">
              <option value="any" selected="selected"><insert ref="viewdef:dslibMessages:allObjectTypes" /></option>
              <if cond="${request:canDoSearchClass(class='Document')} and ${request:canDoSearchClass(class='Collection')}">
                <option value="Document,Collection"><insert ref="viewdef:dslibMessages:DocAndCollections" /></option>
              </if>
              <if cond="${request:canDoSearchClass(class='Calendar')} and ${request:canDoSearchClass(class='Event')}">
                <option value="Calendar,Event"><insert ref="viewdef:dslibMessages:calendarsAndEvents" /></option>
              </if>
              <if cond="${request:canDoSearchClass(class='Weblog')} and ${request:canDoSearchClass(class='Wiki')}">
                <option value="Weblog,WeblogEntry,Wiki,WikiPage"><insert ref="viewdef:dslibMessages:weblogAndWikis" /></option>
                <elif cond="${request:canDoSearchClass(class='Wiki')}">
                  <option value="Wiki,WikiPage"><insert ref="viewdef:dslibMessages:wikis" /></option>
                </elif>
                <elif cond="${request:canDoSearchClass(class='Weblog')}">
                  <option value="Weblog,WeblogEntry"><insert ref="viewdef:dslibMessages:weblogs" /></option>
                </elif>
              </if>
              <if cond="${request:canDoSearchClass(class='Bulletin')} and ${request:canDoSearchClass(class='BulletinBoard')}">
                <option value="BulletinBoard,Bulletin"><insert ref="viewdef:dslibMessages:discussionAndTopics" /></option>
              </if>
              <if cond="${request:canDoSearchClass(class='Group')} and ${request:canDoSearchClass(class='User')}">
                <option value="Group,User"><insert ref="viewdef:dslibMessages:usersGroups" /></option>
              </if>
              <if cond="${request:canDoSearchClass(class='Collection')}">
                <option value="Collection"><insert ref="viewdef:dslibMessages:collectionsOnly" /></option>
              </if>
              <if cond="${request:canDoSearchClass(class='Document')}">
                <option value="Document"><insert ref="viewdef:dslibMessages:documentsOnly" /></option>
              </if>
            </select>

            <span class="labelwrapper"><label for="document_type"><insert ref="viewdef:dslib:PropHelp(name='document_type')"/></label></span>
            <select name="document_type" size="1" tabindex="1">
              <option value="any" selected="selected"><insert ref="viewdef:dslibMessages:allDocumentTypes" /></option>
              <option value="
                application/msword,
                application/vnd.ms-powerpoint,
                application/vnd.ms-excel,
                application/vnd.ms-word.document.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.wordprocessingml.document,
                application/vnd.ms-word.template.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.wordprocessingml.template,
                application/vnd.ms-powerpoint.template.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.presentationml.template,
                application/vnd.ms-powerpoint.addin.macroEnabled.12,
                application/vnd.ms-powerpoint.slideshow.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.presentationml.slideshow,
                application/vnd.ms-powerpoint.presentation.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.presentationml.presentation,
                application/vnd.ms-excel.addin.macroEnabled.12,
                application/vnd.ms-excel.sheet.binary.macroEnabled.12,
                application/vnd.ms-excel.sheet.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,
                application/vnd.ms-excel.template.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.spreadsheetml.template
              ">Microsoft Office (Word, Excel, Powerpoint)</option>
              <option value="
                application/msword,
                application/vnd.ms-word.document.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.wordprocessingml.document,
                application/vnd.ms-word.template.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.wordprocessingml.template
                ">Microsoft Word</option>
              <option value="
                application/vnd.ms-powerpoint,
                application/vnd.ms-powerpoint.template.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.presentationml.template,
                application/vnd.ms-powerpoint.addin.macroEnabled.12,
                application/vnd.ms-powerpoint.slideshow.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.presentationml.slideshow,
                application/vnd.ms-powerpoint.presentation.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.presentationml.presentation
                ">Microsoft PowerPoint</option>
              <option value="
                application/vnd.ms-excel,
                application/vnd.ms-excel.addin.macroEnabled.12,
                application/vnd.ms-excel.sheet.binary.macroEnabled.12,
                application/vnd.ms-excel.sheet.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,
                application/vnd.ms-excel.template.macroEnabled.12,
                application/vnd.openxmlformats-officedocument.spreadsheetml.template
                ">Microsoft Excel</option>
              <option value="application/pdf">Adobe PDF (.pdf)</option>
              <option value="image/gif,image/jpeg,image/png,image/tiff,image/ico"><insert ref="viewdef:dslibMessages:anyImageDoc" /></option>
            </select>
          </div>

          <div class="column3">
            <span class="labelwrapper"><label for="nresults"><insert ref="viewdef:dslib:PropHelp(name='maximum_results_query')"/></label></span>
            <select name="nresults" size="1" tabindex="1">
              <option value="5">5</option>
              <option value="20">20</option>
              <option value="50">50</option>
              <option value="100" selected="selected">100</option>
              <option value="250">250</option>
              <option value="500">500</option>
              <option value="1000">1000</option>
            </select>

            <span class="labelwrapper"><label for="sort_key0"><insert ref="viewdef:dslib:PropHelp(name='sort_results_query')"/></label></span>

            <select name="sort_key0" size="1" tabindex="1">
              <option value="no_sort" selected="selected"><insert ref="viewdef:dslibMessages:rankedOrder" /></option>
              <option value="title"><insert ref="viewdef:dslibMessages:byTitle" /></option>
              <option value="date"><insert ref="viewdef:dslibMessages:byDate" /></option>
              <option value="date_ascending"><insert ref="viewdef:dslibMessages:byDateAsc" /></option>
              <option value="type_and_title"><insert ref="viewdef:dslibMessages:byTypeTitle" /></option>
              <option value="type_and_date"><insert ref="viewdef:dslibMessages:byTypeDate" /></option>
              <option value="title_reversed"><insert ref="viewdef:dslibMessages:byTitleReversed" /></option>
              <option value="owner"><insert ref="viewdef:dslibMessages:byOwner" /></option>
              <!-- Please keep an example of searching on a custom property (Collection.option)
                   <option value="Collection.option">By Option</option>
              -->
            </select>
          </div>
          <input type="hidden" name="SimpleSearch" value="SimpleSearch"/>
          <div class="buttonbar">
            <input type="submit" class="search__realsubmit" value="${viewdef:dslibMessages:search}" name="goButton"/>
            <button name="goButton" value="${viewdef:dslibMessages:search}"><span>&nbsp;</span></button>
          </div>
        </div>
        <insert ref="request:html:end_form"/>

        
        <!-- begin header__bottom -->
        <div class="header__bottom">
          <if cond="${request:category}=='HomePage'">
             <div hidden="hidden" id="homepageflag">&nbsp;</div>
          </if>
          <ul role="navigation" class="nav">
            <!-- <if cond="${request:category}=='HomePage' or ${request:category}=='DocuShareHomePage'"> -->
            <!-- AR 33003 -->
            <if cond="${request:category}=='DocuShareHomePage'">
             <li class="nav__classichomepage"><a class="is-active" href="${request:config:cmd_base}Home" title="${viewdef:dslibMessages:home}" target="${viewdef:dslib:window_target}"><insert ref="local:f_showSpaceName" /><insert ref="viewdef:dslibMessages:home" /></a></li>
              <else>
                <li class="nav__classichomepage"><a href="${request:config:cmd_base}Home" title="${viewdef:dslibMessages:home}" target="${viewdef:dslib:window_target}"><insert ref="local:f_showSpaceName" /><insert ref="viewdef:dslibMessages:home" /></a></li>
              </else>
            </if>
            
            


            <if cond="not ${request:directory:is_logged_in_user} or not ${request:isValidUser}">



            <else>

              <!--   <if cond="${request:directory:is_base_admin_or_domain_content_admin}">
                  <li><a href="${request:config:admin_home}" title="${viewdef:dslibMessages:clickToAdminUI}" ><insert ref="viewdef:dslibMessages:adminHome" /></a></li>
                </if> -->
                
                <!-- <if cond="${request:directory:is_user_level(level='imageManager')}"> -->
                  <if cond="${request:category}=='MyHomePage'">
                    <li class="nav__docusharehomepage"><a class="is-active" href="${request:config:cmd_base}MyHomePage" title="${viewdef:dslibMessages:clickToPersonalPage}"><i class="icon-home">&nbsp;</i><insert ref="viewdef:dslibMessages:myDocushare" /></a></li>
                    <else>
                      <li class="nav__docusharehomepage"><a href="${request:config:cmd_base}MyHomePage" title="${viewdef:dslibMessages:clickToPersonalPage}"><i class="icon-home">&nbsp;</i><insert ref="viewdef:dslibMessages:myDocushare" /></a></li>
                    </else>
                  </if>
                  <!-- <else>
                    <if cond="${request:category}=='MyHomePage'">
                        <li><a class="is-active" href="${request:config:cmd_base}MyHomePage" title="${viewdef:dslibMessages:clickToPersonalPage}"><i class="icon-home">&nbsp;</i><insert ref="viewdef:dslibMessages:myDocushare" /></a></li>
                        <else>
                          <li><a href="${request:config:cmd_base}MyHomePage" title="${viewdef:dslibMessages:clickToPersonalPage}"><i class="icon-home">&nbsp;</i><insert ref="viewdef:dslibMessages:myDocushare" /></a></li>
                        </else>
                      </if>
                  </else>
                </if> -->
                <!-- My DocuShare -->
                <!-- <if cond="${request:directory:is_user_level(level='imageManager')}">

                  <if cond="${request:category}!='MyHomePage'">
                    <li><a href="${request:config:cmd_base}MyHomePage" title="${viewdef:dslibMessages:clickToPersonalPage}"><i class="icon-home">&nbsp;</i><insert ref="viewdef:dslibMessages:myDocushare" /></a></li>
                  </if>
                  <elif cond="${request:category}!='HomePage' and ${request:category}!='MyHomePage'">
                    <li><a href="${request:config:cmd_base}MyHomePage" title="${viewdef:dslibMessages:clickToPersonalPage}"><i class="icon-home">&nbsp;</i><insert ref="viewdef:dslibMessages:myDocushare" /></a></li>
                  </elif>
                  <else>
                    <li><a href="${request:config:cmd_base}MyHomePage" title="${viewdef:dslibMessages:clickToPersonalPage}"><i class="icon-home">&nbsp;</i><insert ref="viewdef:dslibMessages:myDocushare" /></a></li>
                  </else>
                </if> -->

                <!-- Document Routing -->
                <if cond="${viewdef:dslib:routingEnabled}=='Yes' and ${request:config:enable_routing} and ${request:canDo(feature='com.xerox.docushare.viewMyTasks')}">
               <define id="routing_mytask1_url"><if cond="${request:within_space}">javascript:openMyTasksWindow('<insert ref="request:config:abs_path"/>space/<insert ref="request:space_name"/>/')<else>javascript:openMyTasksWindow('<insert ref="request:config:abs_path"/>')</else></if></define>
               <li>
                 <a href="$routing_mytask1_url" title="${viewdef:dslibMessages:clickToRoutingTask}">
                   <i class="icon-tasks">&nbsp;</i>
                   <insert ref="viewdef:dslibMessages:myTask" />
                 </a>
               </li>

                  <!-- <li><a href="javascript:openMyTasksWindow('${request:config:abs_path}')" title="${viewdef:dslibMessages:clickToRoutingTask}"><insert ref="viewdef:dslibMessages:myTask" /></a></li> -->
                </if>
            </else>
            </if>
           <!--  <if cond="${request:within_space}">
              <li class="first"><a href="${request:config:dsweb_home}Home"><strong><insert ref="viewdef:dslibMessages:sitehome" /></strong></a></li>
              <li><a href="${request:config:cmd_base}Home"><insert ref="viewdef:dslibMessages:spaceHome" /></a></li>
              <else>
                <li class="first"><a href="${request:config:dsweb_home}Home"><insert ref="viewdef:dslibMessages:home" /></a></li>
              </else>
            </if> -->
           <!--  <if cond="${request:canDo(feature='com.xerox.docushare.viewContentMap')}">
              <li><a href="${request:config:cmd_base}Index/${request:context}?init=true"><if cond="${request:directory:is_user_level(level='imageManager')}"><insert ref="viewdef:ImageStoreHomePageMessages:browse" /><else><insert ref="viewdef:dslibMessages:contentMap" /></else></if></a></li>
            </if> -->
            <if cond=" ${request:directory:is_logged_in_user} and ${request:isValidUser}">
              <li>
                <a href="#"
                   popup-initiator=""
                   data-id="favorites"
                   data-width="600"
                   data-height="572"
                   data-url="${request:config:cmd_base}FavoritesPopupConfirmation/Site"
                   title="${viewdef:dslibMessages:clickToViewFavorites}">
                  <i class="icon-fave">&nbsp;</i>
                  <insert ref="viewdef:dslibMessages:myFavorites"/>
                </a>
              </li>
            </if>

            <if cond="${request:is_licensed(key='file_cabinet_replacement')}">
               <li>
                  <a href="${request:config:cmd_base}QuickSearchHome" title="${viewdef:HomePageMessages:clickToQuickSearchGo}"><i class="icon-search">&nbsp;</i><insert ref="viewdef:FCRHomePageMessages:quick_search" /></a>
              </li>
            </if>

            <!-- <if cond="not ${request:directory:is_user_level(level='imageManager')}"> -->
            <if cond=" ${request:directory:is_logged_in_user} and ${request:isValidUser}">
              <li><a title="${viewdef:dslibMessages:clickToViewRecent}" href="${request:config:cmd_base}ApplyListNew/${request:context}?days=7&amp;amp;nresults=100"><i class="icon-recent">&nbsp;</i><insert ref="viewdef:dslibMessages:whatsNew" /></a></li>
            </if>
            
           <!--  <if cond="${request:directory:has_registry_access}=='true' or ${request:canDo(feature='com.xerox.docushare.createUser')} or ${request:canDo(feature='com.xerox.docushare.createGroup')}">
              <li><a href="${request:config:cmd_base}Registry"><insert ref="viewdef:dslibMessages:usersGroups" /></a></li>
            </if>

            <li><a href="${request:config:cmd_base}helpdesk"><insert ref="viewdef:dslibMessages:help" /></a></li> -->

	    <!-- Begin TMT DCN -->
            <if cond=" ${request:directory:is_logged_in_user} and ${request:isValidUser}">
		<if cond="${request:directory:is_admin}">
		    <li class="nav__right">
		      <a href="${request:config:abs_path}jsp/tmt/index_admin.jsp" title="${viewdef:TMTMessages:clickToManageDCNs}"><i class="icon-properties">&nbsp;</i><insert ref="viewdef:TMTMessages:ManageDCNs" /></a>
		    </li>
		</if>
	        <li class="nav__right">
                  <a href="${request:config:abs_path}jsp/tmt/addDocument.jsp" title="${viewdef:TMTMessages:clickToAddDocument}"><i class="icon-upload">&nbsp;</i><insert ref="viewdef:TMTMessages:AddDocument" /></a>
		</li>
	        <li class="nav__right">
                  <a href="${request:config:abs_path}jsp/tmt/IssueDCN.jsp" title="${viewdef:TMTMessages:clickToIssueDCN}"><i class="icon-copyshortcuts">&nbsp;</i><insert ref="viewdef:TMTMessages:IssueDCN" /></a>
		</li>
	        <li class="nav__right">
                  <a href="${request:config:abs_path}jsp/tmt/index.jsp" title="${viewdef:TMTMessages:clickToViewDCNs}"><i class="icon-tasks">&nbsp;</i><insert ref="viewdef:TMTMessages:MyDCNs" /></a>
		</li>
            </if>
	    <!-- End TMT DCN -->
<!-- Icons -->
<!--
<i class="icon-alert">&nbsp;</i>
<i class="icon-arrdown">&nbsp;</i>
<i class="icon-arrup">&nbsp;</i>
<i class="icon-bell">&nbsp;</i>
<i class="icon-bgjobs">&nbsp;</i>
<i class="icon-blog">&nbsp;</i>
<i class="icon-calendar">&nbsp;</i>
<i class="icon-changelocation">&nbsp;</i>
<i class="icon-changeowner">&nbsp;</i>
<i class="icon-check">&nbsp;</i>
<i class="icon-checkok">&nbsp;</i>
<i class="icon-checkout">&nbsp;</i>
<i class="icon-close">&nbsp;</i>
<i class="icon-cog">&nbsp;</i>
<i class="icon-collections">&nbsp;</i>
<i class="icon-column">&nbsp;</i>
<i class="icon-comment">&nbsp;</i>
<i class="icon-comments">&nbsp;</i>
<i class="icon-communities">&nbsp;</i>
<i class="icon-contentrule">&nbsp;</i>
<i class="icon-contentruledismiss">&nbsp;</i>
<i class="icon-copy">&nbsp;</i>
<i class="icon-copyshortcuts">&nbsp;</i>
<i class="icon-cut">&nbsp;</i>
<i class="icon-delete">&nbsp;</i>
<i class="icon-desktoppublish">&nbsp;</i>
<i class="icon-document">&nbsp;</i>
<i class="icon-download">&nbsp;</i>
<i class="icon-event">&nbsp;</i>
<i class="icon-fave">&nbsp;</i>
<i class="icon-filedocument">&nbsp;</i>
<i class="icon-folder">&nbsp;</i>
<i class="icon-folderfilled">&nbsp;</i>
<i class="icon-folders">&nbsp;</i>
<i class="icon-info">&nbsp;</i>
<i class="icon-link">&nbsp;</i>
<br/>
<i class="icon-list-thick">&nbsp;</i>
<i class="icon-mail">&nbsp;</i>
<i class="icon-meet-online">&nbsp;</i>
<i class="icon-more">&nbsp;</i>
<i class="icon-movetoarchive">&nbsp;</i>
<i class="icon-mytask">&nbsp;</i>
<i class="icon-mytasks">&nbsp;</i>
<i class="icon-newwindow">&nbsp;</i>
<i class="icon-next">&nbsp;</i>
<i class="icon-notifications">&nbsp;</i>
<i class="icon-paste">&nbsp;</i>
<i class="icon-permissions">&nbsp;</i>
<i class="icon-picture">&nbsp;</i>
<i class="icon-plane">&nbsp;</i>
<i class="icon-plus">&nbsp;</i>
<i class="icon-prev">&nbsp;</i>
<i class="icon-properties">&nbsp;</i>
<i class="icon-quota">&nbsp;</i>
<i class="icon-recent">&nbsp;</i>
<i class="icon-rectangle">&nbsp;</i>
<i class="icon-refresh">&nbsp;</i>
<i class="icon-rename">&nbsp;</i>
<i class="icon-upload">&nbsp;</i>
<i class="icon-uploading">&nbsp;</i>
<i class="icon-upload-with-options">&nbsp;</i> -->

            <if cond=" ${request:directory:is_logged_in_user} and ${request:isValidUser}">
            <li class="nav__right">
              <!-- Background Jobs Status Bar -->
              <with name="backgroundJobCount" ref="request:user_obj:backgoundJobCount">
                <if cond="${backgroundJobCount} > 0">
                      <if cond="${request:category}=='BackgroundJobStatus'">
                        <a class="is-active" href="${request:config:cmd_base}BackgroundJobStatus/${request:user_obj:handle}" title="${viewdef:dslibMessages:clickBackgroundJobs}"><i class="icon-bgjobs">&nbsp;</i><insert ref="viewdef:dslibMessages:oneBackgroundJob_footer(count='${backgroundJobCount}')" /></a>
                        <else>
                          <a href="${request:config:cmd_base}BackgroundJobStatus/${request:user_obj:handle}" title="${viewdef:dslibMessages:clickBackgroundJobs}"><i class="icon-bgjobs">&nbsp;</i><insert ref="viewdef:dslibMessages:oneBackgroundJob_footer(count='${backgroundJobCount}')" /></a>
                        </else>
                      </if>
                      
            

                </if>
              </with>
            </li>
            </if>
          </ul>
        </div>
        <!-- end header__bottom -->
        <div hidden='hidden' style="display:none">
          <if cond="${request:directory:is_user_level(level='imageManager')}">
            leve imageManager!
          </if>
          <if cond="not ${request:directory:is_user_level(level='imageManager')}">
            not imageManager!
          </if>
          <if cond="${request:directory:is_logged_in_user}">
            is_logged_in_user!
          </if>
          <if cond="${request:isValidUser}">
            is valid user!
          </if>
          <if cond="${request:directory:is_user_level(level='minimum')}">
            levelminimum!
          </if>
        </div>

        <!-- Space Header -->
        <insert ref="local:space_bar(showEdit='false')" />

        <!-- Background Jobs Status Bar -->

        <!-- User Messages-->
        <insert ref="local:messages_user"/>
      </if>
      <!-- EA: end condition portalStyle != 'naked' or portalPortlet == '' -->
    </if>
    <!-- EA: end condition portalStyle != 'naked' or portalType == 'sharepointWP' -->

    <if cond="${request:checkCookieAcceptance} =='false'">
      <insert ref="viewdef:javascript:acceptCookie"/>
      <div id="cookie_notice" class="notice notice_blue">
        <i class="notice__icon icon-info">&nbsp;</i>
          <insert ref="viewdef:dslibMessages:cookie_warning" />
          <a href="${request:config:cmd_base}AcceptCookie" id="accept_cookie" class="cookieButton cookieCloseBtn notice__button" title="${viewdef:dslibMessages:closeNotice}"> <insert ref="viewdef:dslibMessages:ok" /> </a>
          <a href="${request:config:cmd_base}CookiesInfo" id="more_cookie_info" class="cookieButton notice__more"  title="${viewdef:dslibMessages:moreCookieInfo}"> <insert ref="viewdef:dslibMessages:more_cookie_info" /></a>
          <a href="${request:config:cmd_base}AcceptCookie" id="close_cookie_notice" class="notice__close cookieCloseBtn " title="${viewdef:dslibMessages:closeNotice}"><span class="icon-close">&nbsp;</span></a>
      </div>
    </if>
  </div>
  <!-- end HEADER -->


  <define id="left"><insert ref="request:license_days_left"/></define>
  <define id="ds6_license"><insert ref="request:is_obsolete_license"/></define>
  
  <if cond="${local:ds6_license}">
    <div id="licensemessage">
      <div id="licensemessage_inner">
        <i class="icon icon-info">&nbsp;</i>
        <if cond="${request:directory:is_base_admin_user}">
          <if cond="${request:directory:is_admin}">
            <insert ref="viewdef:dslibMessages:obsoleteLicenseText(absPath=${request:config:abs_path})" />
            <else>
              <insert ref="viewdef:dslibMessages:obsoleteLicenseText2(mailToVar=${request:get_object(handle='Base-User-2'):email})" />
            </else>
          </if>
          <else>
            <insert ref="viewdef:dslibMessages:obsoleteLicenseText3" />
          </else>
        </if>
      </div>
    </div>
  <elif cond="${local:left}&lt;'1' and not ${request:is_licensed(key='evaluation_key')}">
    <div id="licensemessage">
      <div id="licensemessage_inner">
        <i class="icon icon-info">&nbsp;</i>
        <if cond="${request:directory:is_base_admin_user}">
          <if cond="${request:directory:is_admin}">
            <if cond="${request:is_licensed(key='image_store')}">
              <insert ref="viewdef:dslibMessages:notActivatedTextIM(absPath=${request:config:abs_path}, brand=${local:marketBrand})" />
              <else>
                <insert ref="viewdef:dslibMessages:notActivatedText(absPath=${request:config:abs_path}, brand=${local:marketBrand})" />
              </else>
            </if>
            <else>
              <if cond="${request:is_licensed(key='image_store')}">
                <insert ref="viewdef:dslibMessages:notActivatedTextIM2(mailToVar=${request:get_object(handle='Base-User-2'):email}, brand=${local:marketBrand})" />
                <else>
                  <insert ref="viewdef:dslibMessages:notActivatedText2(mailToVar=${request:get_object(handle='Base-User-2'):email}, brand=${local:marketBrand})" />
                </else>
              </if>
            </else>
          </if>
          <else>
            <insert ref="viewdef:dslibMessages:notYetActivatedText" />
          </else>
        </if>
      </div>
    </div>
  </elif>
  </if>

  <if cond="${request:is_licensed(key='evaluation_key')}">
    <div id="licensemessage">
      <div id="licensemessage_inner">
        <i class="icon icon-info">&nbsp;</i>
        <strong><insert ref="viewdef:dslibMessages:limitedLicText1" /></strong><insert ref="local:br"/>
        <if cond="${local:left}&gt;'1'">
          <insert ref="viewdef:dslibMessages:limitedLicText2(timeLeft=${local:left})" />
          <elif cond="${local:left}=='1'">
            <insert ref="viewdef:dslibMessages:limitedLicText3" />
          </elif>
          <else>
            <insert ref="viewdef:dslibMessages:limitedLicText4" />
          </else>
        </if>
        <if cond="${request:directory:is_base_admin_user}">
          <insert ref="viewdef:dslibMessages:obtainLicense(brand=${local:marketBrand})" />
          <insert ref="local:br"/>
          <insert ref="viewdef:dslibMessages:obtainLicense2(mailToVar=${request:get_object(handle='Base-User-2'):email})" />
        </if>
        <if cond="${request:directory:is_admin}"></if>
      </div>
    </div>
  </if>

  </define>

  <define id="FCRnavbar"> 
    <!-- Admin Messages -->
    <insert ref="local:messages_admin"/>
    
    <!-- Site Header -->
    <div class="header">
    
    <!-- EA: begin condition portalStyle != 'naked' or portalType == 'sharepointWP' -->
    <if cond="${request:get_cmd_arg(argname='portalStyle')}!='naked' or ${request:get_cmd_arg(argname='portalType')}=='sharepointWP'">
      <!-- EA: begin condition portalStyle != 'naked' or portalPortlet == '' -->
      <if cond="${request:get_cmd_arg(argname='portalStyle')}!='naked' or ${request:get_cmd_arg(argname='portalPortlet')}==''">

        <insert ref="request:html:begin_form(action='ApplySimpleSearch',validate='off',name='Search')"/>
    
        <!-- begin header__top -->
        <div class="header__top">
          <!-- EA: begin condition portalStyle != 'naked' -->
          <if cond="${request:get_cmd_arg(argname='portalStyle')}!='naked'">

            <insert ref="local:global_style"/>

            <!-- Skip Navigation -->
            <if cond="${request:category}=='HomePage'">
              <a href="#contents" title="${viewdef:dslibMessages:skipToContents}" class="skipnav_header"><insert ref="viewdef:dslibMessages:skipToContents"/></a>
              <if cond="${request:directory:is_guest}">
                <a href="#loginstart" title="${viewdef:dslibMessages:skipToLogin}" class="skipnav_header"><insert ref="viewdef:dslibMessages:skipToLogin"/></a>
              </if>
              <else>
                <a href="#contents" title="${viewdef:dslibMessages:skipToContents}" class="skipnav_header"><insert ref="viewdef:dslibMessages:skipToContents"/></a>
              </else>
            </if>
            
            <!-- Logo Section -->
            <h1><a href="${request:config:cmd_base}Home" title="${viewdef:dslibMessages:home}">DocuShare</a></h1>
            
            <!-- Login & Account Section -->
            <ul role="navigation" class="accountlinks">
              <if cond="${request:isValidUser}">
                <li class="accountlinks__login"><a href="${request:config:cmd_base}MyHomePage" title="${viewdef:dslibMessages:clickToPersonalPage}" class="accountslinks__home"><i class="icon-home">&nbsp;</i></a><a href="${request:config:cmd_base}Services/${request:user_obj:handle}" title="${viewdef:dslibMessages:clickViewProps}"><insert ref="request:user_obj:getShortName"/></a></li>
              </if>
              <if cond="not ${request:directory:is_logged_in_user} or not ${request:isValidUser}">
                
                <!-- Login Link -->
                <if cond="${request:category}!='HomePage'">
                  <li class="accountlinks__logout"><a  href="${request:config:cmd_base}Login" title="${viewdef:dslibMessages:clickToLogin}"><insert ref="viewdef:dslibMessages:login" /></a></li>
                <else> <!-- If this page is the homepage -->
                  <if cond="${request:directory:is_user_level(level='imageManager')} or 
                    ${request:is_licensed(key='image_store')} or 
                    ${request:is_licensed(key='file_cabinet_replacement')}">
                    <li class="accountlinks__logout"><a href="${request:config:cmd_base}Login" title="${viewdef:dslibMessages:clickToLogin}"><insert ref="viewdef:dslibMessages:login" /></a></li>                     
                  </if>
                </else>
                </if>
              
              <else>
                <li class="accountlinks__logout"><a href="${request:config:cmd_base}Logout" title="${viewdef:dslibMessages:clickToLogout}" target="${window_target}"><insert ref="viewdef:dslibMessages:logout" /></a></li>
              </else>
              </if>
            </ul>
         
          </if>

            <!-- Search Section -->
            <div class="search__wrapper">
                <div role="search" id="subheader_search" class="search">
                  <if cond="${request:category}!='SearchForm' and ${request:category}!='RefineCurrentSearch'">
                    <if cond="${request:category}=='HomePage' and ${request:directory:is_user_level(level='imageManager')}">
                      <else>
                        <if cond="${viewdef:dslib:runjs}=='Yes'">
                          <span title="${viewdef:dslibMessages:clickToHideSearchOpt}" style="display: none;" id="searchOptionsHide" class="search__options is-active icon-settings" onclick="showSearchOptions('search_windowshade'); return(false);">
                            
                          </span>
                          <span style="display: ;" id="searchOptionsShow" title="${viewdef:dslibMessages:clickToShowSearchOpt}" class="search__options icon-settings" onclick="showSearchOptions('search_windowshade'); return(false);">
                            
                          </span>
                        </if>
                        <input type="text" size="26" class="headersearchbox search__input" placeholder="${viewdef:dslibMessages:entireSite_ph}" name="value1"  />
                        <input type="hidden"  name="SimpleSearch" value="SimpleSearch"/>
                        <!-- <input type="submit" class="search__submit" value="${viewdef:dslibMessages:search}" name="SearchButton" /> -->
                        <button name="SearchButton" class="search__submit" value="${viewdef:dslibMessages:search}"><i class="icon-search"><span/></i></button>

                        <if cond="${request:handle}!='None' and ${request:handle}!='null' and ${request:handle}!='Site' and ${request:handle}!='SearchResults' and ${request:object:is_container}">
                          <div class="search__insideof">
                          <i class="icon icon-arrdown">&nbsp;</i>
                          <span><insert ref="viewdef:dslibMessages:inLabel" /></span>
                          <select size="1" name="D1" id="search__insideof__D1">
                            <option value="${request:object:handle}" data-placeholder="${viewdef:dslibMessages:thisOption_ph(className=${request:object:view_classname})}"><insert ref="viewdef:dslibMessages:thisOption(className=${request:object:view_classname})" /></option>
                            <if cond="${request:within_space}">
                              <option value="Space" data-placeholder="${viewdef:dslibMessages:spaceOnly_ph}"><insert ref="viewdef:dslibMessages:spaceOnly" /></option>
                            </if>
                            <option value="Site" data-placeholder="${viewdef:dslibMessages:entireSite_ph}"><insert ref="viewdef:dslibMessages:entireSite" /></option>

                            <if cond="${request:federated:isFederated}=='true'">
                              <option value="AllFederated" data-placeholder="${viewdef:dslibMessages:allFedSites_ph}"><insert ref="viewdef:dslibMessages:allFedSites" /></option>
                            </if>
                          </select>
                          </div>
                          <else>
                            
                            <if cond="${request:federated:isFederated}=='true'">
                              <div class="search__insideof">
                                <i class="icon icon-arrdown">&nbsp;</i>
                                <span><insert ref="viewdef:dslibMessages:inLabel" /></span>
                                <select class="subheader_formtext" size="1" name="D1" id="search__insideof__D1">
                                  <if cond="${request:within_space}">
                                    <option value="Space" data-placeholder="${viewdef:dslibMessages:spaceOnly_ph}"><insert ref="viewdef:dslibMessages:spaceOnly" /></option>
                                  </if>
                                  <option value="Site" data-placeholder="${viewdef:dslibMessages:entireSite_ph}"><insert ref="viewdef:dslibMessages:entireSite" /></option>
                                  <option value="AllFederated" data-placeholder="${viewdef:dslibMessages:allFedSites_ph}"><insert ref="viewdef:dslibMessages:allFedSites" /></option>
                                </select>
                              </div>
                              <elif cond="${request:within_space}">
                                <div class="search__insideof">
                                  <i class="icon icon-arrdown">&nbsp;</i>
                                  <select size="1" name="D1" id="search__insideof__D1">
                                    <option value="Space" data-placeholder="${viewdef:dslibMessages:spaceOnly_ph}"><insert ref="viewdef:dslibMessages:spaceOnly" /></option>
                                    <option value="Site" data-placeholder="${viewdef:dslibMessages:entireSite_ph}"><insert ref="viewdef:dslibMessages:entireSite" /></option>
                                  </select>
                                </div>
                              </elif>
                              <else>
                                <input type="hidden" name="D1" placeholder="${viewdef:dslibMessages:entireSite_ph}" value="Site" id="search__insideof__D1"/>
                              </else>
                            </if>
                            
                          </else>
                          <!-- end search__insideof -->
                        </if>
                        
                      </else>
                    </if>
                  </if>
                </div> <!-- end search -->

                <div class="search__advanced__cell">
                  <if cond="${request:handle}!='None' and ${request:handle}!='null' and ${request:handle}!='Site' and ${request:handle}!='SearchResults' and ${request:object:is_container}">
                    <a class="search__advanced" href="${request:config:cmd_base}SearchForm/${request:handle}" title="${viewdef:dslibMessages:clickForAdv}"><insert ref="viewdef:dslibMessages:advanced" /></a>
                    <else>
                      <a class="search__advanced" href="${request:config:cmd_base}SearchForm/${request:context}" title="${viewdef:dslibMessages:clickForAdv}"><insert ref="viewdef:dslibMessages:advanced" /></a>
                    </else>
                  </if>
                </div>

              </div> <!-- end search__wrapper -->
        </div> <!-- end header__top -->
    

            <!-- Basic Search WindowShade Row -->
            <div role="search" class="search__expanded" id="search_windowshade" style="display:none">
              <div class="search__close icon-x" onclick="showSearchOptions('search_windowshade'); return(false);">&nbsp;</div>
              <h2 class="search__title"><insert ref="viewdef:dslibMessages:extendedSearch" /></h2>
              <div class="column1">
                <span class="labelwrapper"><label for="string_prop"><insert ref="viewdef:dslib:PropHelp(name='search_text_contains')"/></label></span>
                <select name="string_prop" size="1" tabindex="1">
                  <option value="any" selected="selected"><insert ref="viewdef:dslibMessages:antText" /></option>
                  <option value="Object.title,Object.summary,Object.description,Object.keywords,content"><insert ref="viewdef:dslibMessages:listOfKeywords" /></option>
                  <option value="Object.title,Object.summary,Object.description,Object.keywords"><insert ref="viewdef:dslibMessages:listOfKeywords2" /></option>
                  <if cond="${request:is_licensed( key='full_text_search' )}">
                    <option value="content"><insert ref="viewdef:dslibMessages:documentOnly" /></option>
                  </if>
                  <option value="Object.keywords"><insert ref="viewdef:dslibMessages:keywordsOnly" /></option>
                  <option value="owner"><insert ref="viewdef:dslibMessages:ownerOnly" /></option>
                  <if cond="${request:is_licensed( key='records_management' )}">
                    <option value="Object.readyForDeclare"><insert ref="viewdef:dslibMessages:readyForDeclare" /></option>
                  </if>
                </select>

                <span class="labelwrapper"><label for="date_value"><insert ref="viewdef:dslib:PropHelp(name='search_last_modified')"/></label></span>
                <select name="date_value" size="1" tabindex="1">
                  <option value="none" selected="selected"><insert ref="viewdef:dslibMessages:none" /></option>
                  <option value="86400"><insert ref="viewdef:dslibMessages:today" /></option>     <!-- 24x60x60 -->
                  <option value="172800"><insert ref="viewdef:dslibMessages:sinceYesterday" /></option>   <!-- 2x24x60x60 -->
                  <option value="604800"><insert ref="viewdef:dslibMessages:withinLastWeek" /></option> <!-- 7x24x60x60 -->
                  <option value="1209600"><insert ref="viewdef:dslibMessages:winthin2Weeks" /></option><!-- 14x24x60x60 -->
                  <option value="2592000"><insert ref="viewdef:dslibMessages:withinLastMonth" /></option> <!-- 30x24x60x60 -->
                  <option value="5270400"><insert ref="viewdef:dslibMessages:winthinLast2Months" /></option><!-- 61x24x60x60 -->
                  <option value="15811200"><insert ref="viewdef:dslibMessages:withinLast6Months" /></option><!-- 183x24x60x60 -->
                  <option value="31536000"><insert ref="viewdef:dslibMessages:withinLastYear" /></option> <!-- 365x24x60x60 -->
                </select>
              </div>

              <div class="column2">
                <span class="labelwrapper"><label for="date_value"><insert ref="viewdef:dslib:PropHelp(name='object_type')"/></label></span>
                <select name="object_type" size="1" tabindex="1">
                  <option value="any" selected="selected"><insert ref="viewdef:dslibMessages:allObjectTypes" /></option>
                  <if cond="${request:canDoSearchClass(class='Document')} and ${request:canDoSearchClass(class='Collection')}">
                    <option value="Document,Collection"><insert ref="viewdef:dslibMessages:DocAndCollections" /></option>
                  </if>
                  <if cond="${request:canDoSearchClass(class='Calendar')} and ${request:canDoSearchClass(class='Event')}">
                    <option value="Calendar,Event"><insert ref="viewdef:dslibMessages:calendarsAndEvents" /></option>
                  </if>
                  <if cond="${request:canDoSearchClass(class='Weblog')} and ${request:canDoSearchClass(class='Wiki')}">
                    <option value="Weblog,WeblogEntry,Wiki,WikiPage"><insert ref="viewdef:dslibMessages:weblogAndWikis" /></option>
                    <elif cond="${request:canDoSearchClass(class='Wiki')}">
                      <option value="Wiki,WikiPage"><insert ref="viewdef:dslibMessages:wikis" /></option>
                    </elif>
                    <elif cond="${request:canDoSearchClass(class='Weblog')}">
                      <option value="Weblog,WeblogEntry"><insert ref="viewdef:dslibMessages:weblogs" /></option>
                    </elif>
                  </if>
                  <if cond="${request:canDoSearchClass(class='Bulletin')} and ${request:canDoSearchClass(class='BulletinBoard')}">
                    <option value="BulletinBoard,Bulletin"><insert ref="viewdef:dslibMessages:discussionAndTopics" /></option>
                  </if>
                  <if cond="${request:canDoSearchClass(class='Group')} and ${request:canDoSearchClass(class='User')}">
                    <option value="Group,User"><insert ref="viewdef:dslibMessages:usersGroups" /></option>
                  </if>
                  <if cond="${request:canDoSearchClass(class='Collection')}">
                    <option value="Collection"><insert ref="viewdef:dslibMessages:collectionsOnly" /></option>
                  </if>
                  <if cond="${request:canDoSearchClass(class='Document')}">
                    <option value="Document"><insert ref="viewdef:dslibMessages:documentsOnly" /></option>
                  </if>
                </select>

                <span class="labelwrapper"><label for="document_type"><insert ref="viewdef:dslib:PropHelp(name='document_type')"/></label></span>
                <select name="document_type" size="1" tabindex="1">
                  <option value="any" selected="selected"><insert ref="viewdef:dslibMessages:allDocumentTypes" /></option>
                  <option value="
                    application/msword,
                    application/vnd.ms-powerpoint,
                    application/vnd.ms-excel,
                    application/vnd.ms-word.document.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.wordprocessingml.document,
                    application/vnd.ms-word.template.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.wordprocessingml.template,
                    application/vnd.ms-powerpoint.template.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.presentationml.template,
                    application/vnd.ms-powerpoint.addin.macroEnabled.12,
                    application/vnd.ms-powerpoint.slideshow.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.presentationml.slideshow,
                    application/vnd.ms-powerpoint.presentation.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.presentationml.presentation,
                    application/vnd.ms-excel.addin.macroEnabled.12,
                    application/vnd.ms-excel.sheet.binary.macroEnabled.12,
                    application/vnd.ms-excel.sheet.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,
                    application/vnd.ms-excel.template.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.spreadsheetml.template
                  ">Microsoft Office (Word, Excel, Powerpoint)</option>
                  <option value="
                    application/msword,
                    application/vnd.ms-word.document.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.wordprocessingml.document,
                    application/vnd.ms-word.template.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.wordprocessingml.template
                    ">Microsoft Word</option>
                  <option value="
                    application/vnd.ms-powerpoint,
                    application/vnd.ms-powerpoint.template.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.presentationml.template,
                    application/vnd.ms-powerpoint.addin.macroEnabled.12,
                    application/vnd.ms-powerpoint.slideshow.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.presentationml.slideshow,
                    application/vnd.ms-powerpoint.presentation.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.presentationml.presentation
                    ">Microsoft PowerPoint</option>
                  <option value="
                    application/vnd.ms-excel,
                    application/vnd.ms-excel.addin.macroEnabled.12,
                    application/vnd.ms-excel.sheet.binary.macroEnabled.12,
                    application/vnd.ms-excel.sheet.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,
                    application/vnd.ms-excel.template.macroEnabled.12,
                    application/vnd.openxmlformats-officedocument.spreadsheetml.template
                    ">Microsoft Excel</option>
                  <option value="application/pdf">Adobe PDF (.pdf)</option>
                  <option value="image/gif,image/jpeg,image/png,image/tiff,image/ico"><insert ref="viewdef:dslibMessages:anyImageDoc" /></option>
                </select>
              </div>

              <div class="column3">
                <span class="labelwrapper"><label for="nresults"><insert ref="viewdef:dslib:PropHelp(name='maximum_results_query')"/></label></span>
                <select name="nresults" size="1" tabindex="1">
                  <option value="5">5</option>
                  <option value="20">20</option>
                  <option value="50">50</option>
                  <option value="100" selected="selected">100</option>
                  <option value="250">250</option>
                  <option value="500">500</option>
                  <option value="1000">1000</option>
                </select>

                <span class="labelwrapper"><label for="sort_key0"><insert ref="viewdef:dslib:PropHelp(name='sort_results_query')"/></label></span>

                <select name="sort_key0" size="1" tabindex="1">
                  <option value="no_sort" selected="selected"><insert ref="viewdef:dslibMessages:rankedOrder" /></option>
                  <option value="title"><insert ref="viewdef:dslibMessages:byTitle" /></option>
                  <option value="date"><insert ref="viewdef:dslibMessages:byDate" /></option>
                  <option value="date_ascending"><insert ref="viewdef:dslibMessages:byDateAsc" /></option>
                  <option value="type_and_title"><insert ref="viewdef:dslibMessages:byTypeTitle" /></option>
                  <option value="type_and_date"><insert ref="viewdef:dslibMessages:byTypeDate" /></option>
                  <option value="title_reversed"><insert ref="viewdef:dslibMessages:byTitleReversed" /></option>
                  <option value="owner"><insert ref="viewdef:dslibMessages:byOwner" /></option>
                  <!-- Please keep an example of searching on a custom property (Collection.option)
                       <option value="Collection.option">By Option</option>
                  -->
                </select>
              </div>
              <input type="hidden" name="SimpleSearch" value="SimpleSearch"/>
              <div class="buttonbar"><input class="search__submit" type="submit" value="${viewdef:dslibMessages:search}" name="goButton"/></div>
            </div>
    <insert ref="request:html:end_form"/>
    <!-- end form -->
    <!-- begin header__bottom -->
    <div class="header__bottom">
      <ul role="navigation" class="nav">

        
        
        <if cond="not ${request:directory:is_logged_in_user} or not ${request:isValidUser}">
          
          
        
        <else>

          <!--   <if cond="${request:directory:is_base_admin_or_domain_content_admin}">
              <li><a href="${request:config:admin_home}" title="${viewdef:dslibMessages:clickToAdminUI}" ><insert ref="viewdef:dslibMessages:adminHome" /></a></li>
            </if> -->
            <!-- AR 33003 -->
            <li><a href="${request:config:cmd_base}Home" title="${viewdef:dslibMessages:home}" target="${viewdef:dslib:window_target}"><insert ref="local:f_showSpaceName" /><insert ref="viewdef:dslibMessages:home" /></a></li>
            <!-- My DocuShare -->
            <if cond="${request:directory:is_user_level(level='imageManager')}">
              <!-- do not put the MyHomePage link on MyHomePage -->
              <if cond="${request:category}!='MyHomePage'">
                <li><a href="${request:config:cmd_base}MyHomePage" title="${viewdef:dslibMessages:clickToPersonalPage}"><i class="icon-home">&nbsp;</i><insert ref="viewdef:dslibMessages:myDocushare" /></a></li>
              </if>
              <elif cond="${request:category}!='HomePage' and ${request:category}!='MyHomePage'">
                <li><a href="${request:config:cmd_base}MyHomePage" title="${viewdef:dslibMessages:clickToPersonalPage}"><i class="icon-home">&nbsp;</i><insert ref="viewdef:dslibMessages:myDocushare" /></a></li>
              </elif>
              <else>
                <li><a href="${request:config:cmd_base}MyHomePage" title="${viewdef:dslibMessages:clickToPersonalPage}"><i class="icon-home">&nbsp;</i><insert ref="viewdef:dslibMessages:myDocushare" /></a></li>
              </else>
            </if>
            
            <!-- Document Routing -->
            <if cond="${viewdef:dslib:routingEnabled}=='Yes' and ${request:config:enable_routing} and ${request:canDo(feature='com.xerox.docushare.viewMyTasks')}">
               <define id="routing_mytask1_url"><if cond="${request:within_space}">javascript:openMyTasksWindow('<insert ref="request:config:abs_path"/>space/<insert ref="request:space_name"/>/')<else>javascript:openMyTasksWindow('<insert ref="request:config:abs_path"/>')</else></if></define>
               <li>
                 <a href="$routing_mytask1_url" title="${viewdef:dslibMessages:clickToRoutingTask}">
                   <i class="icon-tasks">&nbsp;</i>
                   <insert ref="viewdef:dslibMessages:myTask" />
                 </a>
               </li>
            </if>

        </else>
        </if>
       <!--  <if cond="${request:within_space}">
          <li class="first"><a href="${request:config:dsweb_home}Home"><strong><insert ref="viewdef:dslibMessages:sitehome" /></strong></a></li>
          <li><a href="${request:config:cmd_base}Home"><insert ref="viewdef:dslibMessages:spaceHome" /></a></li>
          <else>
            <li class="first"><a href="${request:config:dsweb_home}Home"><insert ref="viewdef:dslibMessages:home" /></a></li>
          </else>
        </if> -->
       <!--  <if cond="${request:canDo(feature='com.xerox.docushare.viewContentMap')}">
          <li><a href="${request:config:cmd_base}Index/${request:context}?init=true"><if cond="${request:directory:is_user_level(level='imageManager')}"><insert ref="viewdef:ImageStoreHomePageMessages:browse" /><else><insert ref="viewdef:dslibMessages:contentMap" /></else></if></a></li>
        </if> -->
        <if cond=" ${request:directory:is_logged_in_user} and ${request:isValidUser}">
          <li>
            <a href="#"
               popup-initiator=""
               data-id="favorites"
               data-width="600"
               data-height="572"
               data-url="${request:config:cmd_base}FavoritesPopupConfirmation/Site"
               title="${viewdef:dslibMessages:clickToViewFavorites}">
              <i class="icon-fave">&nbsp;</i>
              <insert ref="viewdef:dslibMessages:myFavorites"/>
            </a>
          </li>
        </if>
        <!-- <if cond="not ${request:directory:is_user_level(level='imageManager')}"> -->
 <!--        <if cond=" ${request:directory:is_logged_in_user} and ${request:isValidUser}">
          <li><a title="${viewdef:dslibMessages:clickToViewRecent}" href="${request:config:cmd_base}ApplyListNew/${request:context}?nresults=100"><i class="icon-recent">&nbsp;</i><insert ref="viewdef:dslibMessages:whatsNew" /></a></li>
        </if> -->

        <if cond="${request:is_licensed(key='file_cabinet_replacement')}">
           <li><a class="is-active" href="${request:config:cmd_base}QuickSearchHome" title="${viewdef:HomePageMessages:clickToQuickSearchGo}"><i class="icon-search">&nbsp;</i><insert ref="viewdef:FCRHomePageMessages:quick_search" /></a></li>
        </if>

        <if cond="${request:isValidUser}">
          <li><a title="${viewdef:dslibMessages:clickToViewRecent}" href="${request:config:cmd_base}ApplyListNew/${request:context}?days=7&amp;amp;nresults=100"><i class="icon-recent">&nbsp;</i><insert ref="viewdef:dslibMessages:whatsNew" /></a></li>
        </if>
        
        
       <!--  <if cond="${request:directory:has_registry_access}=='true' or ${request:canDo(feature='com.xerox.docushare.createUser')} or ${request:canDo(feature='com.xerox.docushare.createGroup')}">
          <li><a href="${request:config:cmd_base}Registry"><insert ref="viewdef:dslibMessages:usersGroups" /></a></li>
        </if>
        
        <li><a href="${request:config:cmd_base}helpdesk"><insert ref="viewdef:dslibMessages:help" /></a></li> -->

	<!-- Begin TMT DCN -->
	<if cond=" ${request:directory:is_logged_in_user} and ${request:isValidUser}">
	    <if cond="${request:directory:is_admin}">
		<li class="nav__right">
		  <a href="${request:config:cmd_base}ManageDCNs" title="${viewdef:TMTMessages:clickToManageDCNs}"><i class="icon-properties">&nbsp;</i><insert ref="viewdef:TMTMessages:ManageDCNs" /></a>
		</li>
	    </if>
	    <li class="nav__right">
	      <a href="${request:config:cmd_base}AddDocWithDCN" title="${viewdef:TMTMessages:clickToAddDocument}"><i class="icon-upload">&nbsp;</i><insert ref="viewdef:TMTMessages:AddDocument" /></a>
	    </li>
	    <li class="nav__right">
	      <a href="${request:config:cmd_base}IssueDCN" title="${viewdef:TMTMessages:clickToIssueDCN}"><i class="icon-copyshortcuts">&nbsp;</i><insert ref="viewdef:TMTMessages:IssueDCN" /></a>
	    </li>
	    <li class="nav__right">
	      <a href="${request:config:cmd_base}ViewDCNs" title="${viewdef:TMTMessages:clickToViewDCNs}"><i class="icon-tasks">&nbsp;</i><insert ref="viewdef:TMTMessages:MyDCNs" /></a>
	    </li>
	</if>
	<!-- End TMT DCN -->

        <li class="nav__right">
          <!-- Background Jobs Status Bar -->
          <with name="backgroundJobCount" ref="request:user_obj:backgoundJobCount">
            <if cond="${backgroundJobCount} > 0">

                <if cond="${backgroundJobCount} == 1">
                  <a href="${request:config:cmd_base}BackgroundJobStatus/${request:user_obj:handle}" title="${viewdef:dslibMessages:clickBackgroundJobs}"><i class="icon-bgjobs">&nbsp;</i><insert ref="viewdef:dslibMessages:oneBackgroundJob_footer(count='${backgroundJobCount}')" /></a>
                  <else>
                    <a href="${request:config:cmd_base}BackgroundJobStatus/${request:user_obj:handle}" title="${viewdef:dslibMessages:clickBackgroundJobs}"><i class="icon-bgjobs">&nbsp;</i><insert ref="viewdef:dslibMessages:backgroundJobs_footer(count='${backgroundJobCount}')" /></a>
                  </else>
                </if>

            </if>
          </with>
        </li>
      </ul>
    </div>
    <!-- end header__bottom -->

    <!-- Space Header -->
        <insert ref="local:space_bar(showEdit='false')" />

        <!-- Background Jobs Status Bar -->

        <!-- User Messages-->
        <insert ref="local:messages_user"/>
      </if>
      <!-- EA: end condition portalStyle != 'naked' or portalPortlet == '' -->
    </if>
    <!-- EA: end condition portalStyle != 'naked' or portalType == 'sharepointWP' -->


    <if cond="${request:checkCookieAcceptance} =='false'">
      <insert ref="viewdef:javascript:acceptCookie"/>
      <div id="cookie_notice" class="notice notice_blue"> 
        <div  class="notice__icon icon-info">&nbsp;</div>
        <p>
          <insert ref="viewdef:dslibMessages:cookie_warning" />
          <a href="${request:config:cmd_base}AcceptCookie" id="accept_cookie" class="cookieButton cookieCloseBtn notice__button" title="${viewdef:dslibMessages:closeNotice}"> <insert ref="viewdef:dslibMessages:ok" /> </a>
          <a href="${request:config:cmd_base}CookiesInfo" id="more_cookie_info" class="cookieButton notice__more"  title="${viewdef:dslibMessages:moreCookieInfo}"> <insert ref="viewdef:dslibMessages:more_cookie_info" /></a>
          <a href="${request:config:cmd_base}AcceptCookie" id="close_cookie_notice" class="cookieCloseBtn notice__close" title="${viewdef:dslibMessages:closeNotice}" ><i class="icon-close">&nbsp;</i></a>
        </p>
      </div>
    </if>
    </div> <!-- end header -->
    
    <define id="left"><insert ref="request:license_days_left"/></define>
    <if cond="${local:left}&lt;'1' and not ${request:is_licensed(key='evaluation_key')}">
      <div id="licensemessage">
        <div id="licensemessage_inner">
          <i class="icon icon-info">&nbsp;</i>
          <if cond="${request:directory:is_base_admin_user}">
            <if cond="${request:directory:is_admin}">
              <if cond="${request:is_licensed(key='image_store')}">
                <insert ref="viewdef:dslibMessages:notActivatedTextIM(absPath=${request:config:abs_path}, brand=${local:marketBrand})" />
                <else>
                  <insert ref="viewdef:dslibMessages:notActivatedText(absPath=${request:config:abs_path}, brand=${local:marketBrand})" />
                </else>
              </if>
              <else>
                <if cond="${request:is_licensed(key='image_store')}">
                  <insert ref="viewdef:dslibMessages:notActivatedTextIM2(mailToVar=${request:get_object(handle='Base-User-2'):email}, brand=${local:marketBrand})" />
                  <else>
                    <insert ref="viewdef:dslibMessages:notActivatedText2(mailToVar=${request:get_object(handle='Base-User-2'):email}, brand=${local:marketBrand})" />
                  </else>
                </if>
              </else>
            </if>
            <else>
              <insert ref="viewdef:dslibMessages:notYetActivatedText" />
            </else>
          </if>
        </div>
      </div>
    </if>

    <if cond="${request:is_licensed(key='evaluation_key')}">
      <div id="licensemessage">
        <div id="licensemessage_inner">
          <i class="icon icon-info">&nbsp;</i>
          <strong><insert ref="viewdef:dslibMessages:limitedLicText1" /></strong><insert ref="local:br"/>
          <if cond="${local:left}&gt;'1'">
            <insert ref="viewdef:dslibMessages:limitedLicText2(timeLeft=${local:left})" />
            <elif cond="${local:left}=='1'">
              <insert ref="viewdef:dslibMessages:limitedLicText3" />
            </elif>
            <else>
              <insert ref="viewdef:dslibMessages:limitedLicText4" />
            </else>
          </if>
          <if cond="${request:directory:is_base_admin_user}">
            <insert ref="viewdef:dslibMessages:obtainLicense(brand=${local:marketBrand})" />
            <insert ref="local:br"/>
            <insert ref="viewdef:dslibMessages:obtainLicense2(mailToVar=${request:get_object(handle='Base-User-2'):email})" />
          </if>
        </div>
      </div>
    </if>
  </define>

  <define id="admin_navbar">
    <!--Gum Drop Image and Links Row -->
    <div class="header header--admin">
      <div class="header__top">
        <h1><a href="${request:config:cmd_base}Home" title="${viewdef:dslibMessages:home}" target="_parent">DocuShare</a></h1>
        <ul role="navigation" class="otherlinks">
          <li>
            <a rel="top" href="${request:config:cmd_base}Home" target="${window_target}"><insert ref="viewdef:dslibMessages:home" /></a>
          </li>
          <if cond="not ${request:directory:is_logged_in_user} or not ${request:isValidUser}">
            <!-- Login Link -->
            <li class="accountlinks__logout">
              <a  href="${request:config:cmd_base}Login" title="${viewdef:dslibMessages:clickToLogin}">
                <insert ref="viewdef:dslibMessages:login" />              
              </a>
            </li>
          <else>
            <li class="accountlinks__logout">
              <a href="${request:config:cmd_base}Logout" title="${viewdef:dslibMessages:clickToLogout}" target="${window_target}">
                <insert ref="viewdef:dslibMessages:logout" />              
              </a>
            </li>
          </else>
          </if>
          <li>
            <a role="help" href="${request:config:cmd_base}helpdesk" target="${window_target}"><insert ref="viewdef:dslibMessages:help" /></a>
          </li>
        </ul>
      </div>
    </div>
  </define>


  <define id="messages_admin">
    <!-- Admin Message -->
    <if cond="${request:config:show_msg}">
      <define id="adminMsg"><insert ref="request:config:admin_msg"/></define>
      <div role="alert" class="notice notice_admin-message">
        <i class="notice__icon icon-info">&nbsp;</i>
        <p><insert ref="request:xss_safe_value(value='$local:adminMsg')" /></p>
      </div>
    </if>
   </define>

   <define id="messages_user">
    <!-- User Info Message -->
    <!-- show/hide toggle main div element in error message, created in ApplyAddDocumentMulti.java -->
    <insert ref="viewdef:javascript:showHideMainDiv"/> 
    <if cond="${request:has_multi_file_msg}">
      <!-- multi file upload -->
      <div role="status" class="notice notice_green">
        <div class="notice__icon icon-info"><insert ref="request:get_multi_file_msg" /></div>
        <div class="notice__multifile_list">
          <iter ref="request:get_user_msgs">
            <if cond="${request:counter} > 0">,&nbsp;</if>  <!-- add comma separator -->
            <insert ref=":get(key='message')" />
            <insert ref="request:increment" />
            <if cond="${request:counter} > 19">...</if><!-- we only show the names of 20 files; if there are more, add the ellipsis -->
          </iter>
        </div>
      </div>
      
     
      <!-- individual error messages for files which failed to upload with multi-file drag/drop -->
      <if cond="${request:has_error_msgs}">
        <div role="alert" class="notice notice_red">
          <p><insert ref="viewdef:dslibMessages:errorMessagesMultiFile" /></p>
          <ul>
          <iter ref="request:get_error_msgs">
            <li><insert ref=":"/></li>
          </iter>
          </ul>
          <if cond="${request:has_error_files_String}">
            <p><insert ref="viewdef:dslibMessages:notUploadedErrors(filesWithErrors=$request:get_error_files_String)" /></p>
          </if>
        </div>
      </if>

      <!-- a single list of comma-separated names of files which exceeded drag/drop limit and were not uploaded -->
      <if cond="${request:has_removed_files_msg}">
        <div role="alert" class="notice notice_red">
          <p><insert ref="request:get_removed_files_msg"/></p>
        </div>
      </if>
    <elif cond="${request:has_user_msgs}">
      <iter ref="request:get_user_msgs">
        <!-- also can use $:get(key='provider') to determine format-->
        <if cond="$:get(key='type')=='error'">
          <div role="alert" class="notice notice_red">
            <p><insert ref=":get(key='message')"/></p>
          </div>
        <elif cond="$:get(key='type')=='warning'">
          <div role="alert" class="notice notice_red">
            <p><insert ref=":get(key='message')"/></p>
          </div>
        </elif>
        <else>
          <div role="status" class="notice notice_green">
            <i class="notice__icon icon-info">&nbsp;</i>
            <p><insert ref=":get(key='message')"/></p>
          </div>
        </else>
        </if>
      </iter>
    </elif>

    </if>
  </define>

  <!-- expects the following parameters:  1.) valign - typically set to 'top'.  2.) field.  Set it to '' for top
       toolbars and '2' for bottom toolbars.  3.) caller.  Set it to 'collection' for View Collection, 'search' for
       viewing search results, and 'bulletinboard' for viewing bulletin boards.  Conditionally generates some menus
  -->
  <define id="toolbar_multi">
    <define id="toolFormName"><if cond="${caller} == 'search_image' or ${caller} == 'search'">ViewList<else>ToolbarMulti</else></if></define>
    <script src="${request:config:abs_path}javascript/common/tables/toolbar-selection-system.js?v=${request:config:short_version}">
    </script>
    <if cond="${viewdef:dslib:runjs}=='Yes'">
      <script type="text/javascript">
        ToolbarSelectionSystem.initialize("<insert ref='local:toolFormName'/>");
      </script>
    </if>

    <table class="toolbar_multi" width="${request:page_width}">

  <tr>
    <td>
      <if cond="${request:directory:is_logged_in_user}">
        <if cond="${viewdef:dslib:runjs}=='Yes'">
    <if cond="${caller}=='collection_image' or ${caller}=='search_image'">
                <input type="checkbox" name="selectcheckbox" value="selected"
                       class="checkbox"
                       id="image_view_select_all"
                       onclick="if (this.checked==true) { SelectAll(true); this.checked = true; } else { SelectAll(false); this.checked = false; }"
                       onmouseover="if (this.checked==true) { describe('${viewdef:dslibMessages:clickToUnselectAll}'); } else { describe('${viewdef:dslibMessages:clickToSelectAll}'); }; return true;"
                       onmouseout="clearstatus();"/>
                <label for="image_view_select_all">&nbsp;</label>
    </if>
    <else>
      <if cond="${caller}=='collection_image' or ${caller}=='collection' or ${caller}=='search' or ${caller}=='search_image' or ${caller}=='collection_speed'">
        <input type="reset" value="${viewdef:dslibMessages:clear}" class="bs"/>
      </if>
    </else>
        </if>
      </if>

            <insert ref="viewdef:EditSelectedMenu:getMenu(caller=${caller},field=${field},toolFormName=${local:toolFormName})"/>

              <if cond="${caller}!='search' and ${caller}!='search_image'">
                <if cond="${caller} != 'delete_user' and ${caller} != 'sitemap' and ${caller} != 'favorites' and ${caller} != 'restore_results'">
                  <if cond="${request:object:canIAdd} and ${request:config:read_only}==0">
                    <if cond="${viewdef:dslib:runjs}=='Yes'">
                  <div class="add-type-wrapper">
                    <select name="add_type$field" size="1" class="VariableWidth9 selectbox selectbox-plain"
                            onchange="if (this.options[this.selectedIndex].value!='None') {document.${local:toolFormName}.go_add${field}.click()}">
                          <insert ref="local:addPulldown"/>
                      </select>
                  </div>
                      <else>
                        <select name="add_type$field" size="1" class="VariableWidth9">
                          <insert ref="local:addPulldown"/>
                        </select>
                      </else>
                    </if>

                    <input type="submit" name="go_add$field" value="${viewdef:dslibMessages:go}" class="bs"/>
                  </if>
                </if>

    <else>

      <!-- comes here only for the search results page.  Do the save search menu -->

                  <if cond="${request:url_parameter(name='scope',sep='&amp;')}!='WikiPageAttachments'">
          <if cond="not ${request:directory:is_user_level(level='minimum')}"><!-- read-only users can't add savedqueries -->
                  <div class="add-type-wrapper">
                    <select name="add_type$field" size="1" class=" selectbox selectbox-plain"
                            onchange="if (this.options[this.selectedIndex].value!='None') {document.${local:toolFormName}.go_add${field}.click()}">
          <insert ref="local:addSearchPulldown"/>
        </select>
                  </div>
      <input type="submit" name="go_add$field" value="${viewdef:dslibMessages:go}" class="bs"/>
      </if>
      </if>
              <!-- not 'WikiPageAttachments' -->
    </else>
         </if>


    </td>

    <!-- selector for show/hide abstracts and discussions -->
      <if cond="${caller}=='collection_image' or ${caller}=='search' or ${caller}=='search_image' or ${caller}=='collection_speed'">
          <td>
            <div class="presentation">
              <define id="toolbar_multi_container_key"><if cond="${request:handle}=='Site'">Site<else><insert ref="request:object:handle"/></else></if></define>
              <define id="toolbar_multi_viewformat"><if cond="${request:has_object} and ${caller} in ['collection_image', 'collection_speed']"><insert ref="request:object:view_format(appl='Paging')" /><else><insert ref="request:paging_value(appl='SearchPaging',container='${toolbar_multi_container_key}',name='view',default='view_list')"/></else></if></define>
              <define id="toolbar_multi_is_list_active"><if cond="${toolbar_multi_viewformat} == 'view_list'">active</if></define>
              <define id="toolbar_multi_is_image_active"><if cond="${toolbar_multi_viewformat} == 'view_image'">active</if></define>
              <define id="toolbar_multi_is_mail_active"><if cond="${toolbar_multi_viewformat} == 'view_email'">active</if></define>


          <define id="appl"><if cond="${caller}=='collection_speed' or ${caller}=='collection_image'">Paging<else>SearchPaging</else></if></define>

          <if cond="${caller}!='search' and ${caller}!='search_image'">
              <a href="${local:cgi}ProcessMultipleCommand?goRangeButton=refresh&amp;amp;container=${request:object:handle}&amp;amp;application=${appl}&amp;amp;collection=${request:object:handle}">
                  <span class="icon icon-refresh"></span>
              </a>
          </if>

            <if cond="${caller}=='search' or ${caller}=='search_image'">
              <if cond="${request:search_result:getTotalCount}!='0'">
                    <a href="javascript:void(0);" onclick="showDiv('abstracttext'); return(false);" class="show-hide-details">
                      <insert ref="viewdef:dslibMessages:showHideDetails"/>
                    </a>
              </if>
            <elif cond="${caller}=='discussion'">
                    <a href="javascript:void(0);" onclick="showDiv('descriptiontext'); return(false);" class="show-hide-details">
                      <insert ref="viewdef:dslibMessages:showHideDetails"/>
                    </a>
            </elif>
            </if>

          <if cond="not ${request:directory:is_user_level(level='imageManager')}">

          <if cond="${request:handle}=='Site'">
                <a href="${local:cgi}ProcessMultipleCommand?view=view_list&amp;amp;container=Site&amp;amp;application=${appl}&amp;amp;collection=Collection-0"
                     class="${toolbar_multi_is_list_active}"
                   title="${viewdef:dslibMessages:viewList}">
                    <span class="icon icon-rectangle"></span>
                </a>
            <if cond="${request:canDo(feature='com.xerox.docushare.viewThumbnails')}">
                  <a href="${local:cgi}ProcessMultipleCommand?view=view_image&amp;amp;container=Site&amp;amp;application=${appl}&amp;amp;collection=Collection-0"
                       class="${toolbar_multi_is_image_active}"
                     title="${viewdef:dslibMessages:viewImages}">
                      <span class="icon icon-folder-view"></span>
                  </a>
            </if>
                <a href="${local:cgi}ProcessMultipleCommand?view=view_email&amp;amp;container=Site&amp;amp;application=${appl}&amp;amp;collection=Collection-0"
                     class="${toolbar_multi_is_mail_active}"
                   title="${viewdef:dslibMessages:viewEmail}">
                    <span class="icon icon-mail"></span>
                </a>
            <else>
                  <a href="${local:cgi}ProcessMultipleCommand?view=view_list&amp;amp;container=${request:object:handle}&amp;amp;application=${appl}&amp;amp;collection=${request:object:handle}"
                       class="${toolbar_multi_is_list_active}"
                     title="${viewdef:dslibMessages:viewList}">
                      <span class="icon icon-rectangle"></span>
                  </a>
              <if cond="${request:canDo(feature='com.xerox.docushare.viewThumbnails')}">
                    <a href="${local:cgi}ProcessMultipleCommand?view=view_image&amp;amp;container=${request:object:handle}&amp;amp;application=${appl}&amp;amp;collection=${request:object:handle}"
                         class="${toolbar_multi_is_image_active}"
                       title="${viewdef:dslibMessages:viewImages}">
                        <span class="icon icon-folder-view"></span>
                    </a>
              </if>
                  <a href="${local:cgi}ProcessMultipleCommand?view=view_email&amp;amp;container=${request:object:handle}&amp;amp;application=${appl}&amp;amp;collection=${request:object:handle}"
                       class="${toolbar_multi_is_mail_active}"
                     title="${viewdef:dslibMessages:viewEmail}">
                      <span class="icon icon-mail"></span>
                  </a>
            </else>
          </if>

            </if>
            </div>
            <!-- directory:is_user_level(level='imageManager') -->
        </td>
      </if>
  </tr>
   </table>

  <insert ref="local:toolbar_multi_paginator(field='${field}', caller='${caller}')"/>
  </define>

<define id="toolbar_multi_paginator">
  <if cond="${caller}!='collection_speed' and ${caller}!='collection_image' and ${caller}!='search' and ${caller}!='search_image'">
    <if cond="${request:totalNumChildren(caller='${caller}')}!='0'">
        <div class="pagination-wrapper">
        <insert ref="local:page_handling(field='${field}', caller='${caller}')"/>
      </div>
    </if>
  </if>
</define>





   <define id="toolbar_multi_with_pref">
    <define id="toolFormName"><if cond="${caller} == 'search_image' or ${caller} == 'search'">ViewList<else>ToolbarMulti</else></if></define>
    <if cond="${viewdef:dslib:runjs}=='Yes'">
      <script src="${request:config:abs_path}javascript/common/tables/toolbar-selection-system.js?v=${request:config:short_version}">
      </script>
      <script type="text/javascript">
        ToolbarSelectionSystem.initialize("<insert ref='local:toolFormName'/>");

      </script>
    </if>

    <div id="pref_propSelector" class="view-options-wrapper" style="display: none;">

      <div class="view-options">

        <h1><insert ref="viewdef:dslibMessages:preferenceViewOptions"/></h1>

    <table>
    <tr>
            <td>
              <div class="view-options-title"><insert ref="viewdef:dslibMessages:preferenceAvailable" /></div>
              <select id="pref_available_props" name="search_available_props" size="15" tabindex="1" multiple="multiple" class="multiselect">
            <define id="defaultPropLabel"><insert ref="viewdef:dslibMessages:preferencePropertiesDP" /></define>
            <optgroup label="${defaultPropLabel}">
              <option value="Object.type"><insert ref="viewdef:dslibMessages:type" /></option>
              <option value="Object.title"><insert ref="request:propLabel(longPropName='Object.title')" /></option>
              <option value="Object.owner"><insert ref="viewdef:dslibMessages:owner" /> </option>
              <option value="Object.modified_date"><insert ref="request:propLabel(longPropName='Object.modified_date')" /></option>
              <option value="Object.size"><insert ref="viewdef:dslibMessages:size" /></option>
              <option value="Object.action"><insert ref="viewdef:ContentPortletMessages:actions" /></option>
            </optgroup>
            <define id="globalPropLabel"><insert ref="viewdef:dslibMessages:preferencePropertiesGP" /></define>
            <optgroup label="${globalPropLabel}">
              <iter ref="request:preference_obj:get_Properties(className='Object')">
                <option value="${:fullname}"><insert ref=":label"/></option>
              </iter>
           </optgroup>
           <iter ref="request:preference_obj:get_availbale_classes(appl='${pref_appl}',container='${pref_container}')">
            <optgroup label="${:label}">
                <define id="class_name"><insert ref=":name"/></define>
            <iter ref="request:preference_obj:get_Properties(className='${class_name}')">
              <option value="${:fullname}"><insert ref=":label"/></option>
              </iter>
            </optgroup>
           </iter>
        </select>
        </td>
            <td class="select-option-group">

              <i onclick="addProp()" class="move-right-action">&nbsp;</i>
        <br />
        <br />
              <i onclick="removeProp()" class="move-left-action">&nbsp;</i>

       </td>
            <td>
              <div class="view-options-title"><insert ref="viewdef:dslibMessages:preferenceVisible" /></div>
              <select id="pref_selected_props" name="search_selected_props" size="15" tabindex="1" multiple="multiple" class="multiselect">
          <if cond="$request:preference_obj:isSelectedProps(appl='${pref_appl}',container='${pref_container}') ">
             <iter ref="request:preference_obj:selectedProps(appl='${pref_appl}',container='${pref_container}')">
              <define id="fullName"><insert ref=":classname" />.<insert ref=":name" /></define>
              <option value="${fullName}">
              <if cond="${:classname}=='Object'">
                <if cond="${:name}=='type'">
                  <insert ref="viewdef:dslibMessages:type" />
                <elif cond="${:name}=='title'">
                  <insert ref="request:propLabel(longPropName='Object.title')" />
                </elif>
                <elif cond="${:name}=='owner'">
                  <insert ref="viewdef:dslibMessages:owner" />
                </elif>
                <elif cond="${:name}=='modified_date'">
                  <insert ref="request:propLabel(longPropName='Object.modified_date')" />
                </elif>
                <elif cond="${:name}=='size'">
                  <insert ref="viewdef:dslibMessages:size" />
                </elif>
                <elif cond="${:name}=='action'">
                   <insert ref="viewdef:ContentPortletMessages:actions" />
                </elif>
                <else>
                  <insert ref=":label" />
                </else>
                </if>
              <elif cond="${:classname}=='BulletinBoard'"> <!-- AR 31625 -->
                (<insert ref="viewdef:ViewDiscussionMessages:discussion" />)&nbsp;<insert ref=":label" />
              </elif>
              <else>
                (<insert ref=":classlabel" />)&nbsp;<insert ref=":label" />
              </else>
              </if>
              </option>
             </iter>
                 <else>
               <option value="Object.type"><insert ref="viewdef:dslibMessages:type" /></option>
               <option value="Object.title"><insert ref="request:propLabel(longPropName='Object.title')" /></option>
               <option value="Object.owner"><insert ref="viewdef:dslibMessages:owner" /></option>
               <option value="Object.modified_date"><insert ref="request:propLabel(longPropName='Object.modified_date')" /></option>
               <option value="Object.size"> <insert ref="viewdef:dslibMessages:size" /></option>
               <if cond="${caller}=='search' and ${request:has_spaces}">
                <option value="Object.space"><insert ref="viewdef:dslibMessages:space" /></option>
              </if>
               <option value="Object.action"><insert ref="viewdef:dslibMessages:actions" /></option>
             </else>
             </if>
            </select>
        </td>
            <td class="sort-option-group">
              <i class="move-up-action" title="${viewdef:dslibMessages:searchResultsPropMoveUp}" onclick="SearchPropertiesmoveUpSelected(document.getElementById('pref_selected_props'));">&nbsp;</i>
           <br/>
           <br/>
              <i class="move-down-action" title="${viewdef:dslibMessages:searchResultsPropMoveDown}" onclick="SearchPropertiesmoveDownSelected(document.getElementById('pref_selected_props'));">&nbsp;</i>
        </td>
      </tr>
      <tr>
      <td/>
      <td/>
      <td align="right" class="submit-group">
        <if cond="${caller} =='collection_speed' or ${caller}=='search'">
          <input type="submit" name="prefApplyButton" value="${viewdef:dslibMessages:preferenceApply}" class="submit submit_white" onclick="changePref()" />
          <if cond="${caller} != 'search'">
            <if cond="${request:object:is_managable}">
              <input type="submit" name="prefSaveButton" value="${viewdef:dslibMessages:preferenceSave}" class="submit submit_white" onclick="changePref()" />
            </if>
          </if>
        </if>
      </td>
      <td/>
      </tr>
    </table>
    <input type="hidden" id="prefPropsStr" name="prefPropsStr" value=""/>
      </div>
    </div>



    <table border="0" cellspacing="0" cellpadding="2" class="toolbar_multi" width="${request:page_width}">

  <tr>
    <td>
      <if cond="${request:directory:is_logged_in_user}">
        <if cond="${viewdef:dslib:runjs}=='Yes'">
    <if cond="${caller}=='collection_image' or ${caller}=='search_image'">
      <input type="checkbox" name="selectcheckbox" value="selected" onclick="if (this.checked==true) { SelectAll(true); this.checked = true; } else { SelectAll(false); this.checked = false; }" onmouseover="if (this.checked==true) { describe('${viewdef:dslibMessages:clickToUnselectAll}'); } else { describe('${viewdef:dslibMessages:clickToSelectAll}'); }; return true;" onmouseout="clearstatus();"/>
    </if>
    <else>
      <if cond="${caller}=='collection_image' or ${caller}=='collection' or ${caller}=='search' or ${caller}=='search_image' or ${caller}=='collection_speed'">
        <input type="reset" value="${viewdef:dslibMessages:clear}" class="bs"/>
      </if>
    </else>
        </if>
      </if>

            <insert ref="viewdef:EditSelectedMenu:getMenu(caller=${caller},field=${field},toolFormName=${local:toolFormName})"/>

              <if cond="${caller}!='search' and ${caller}!='search_image'">
                <if cond="${caller} != 'delete_user' and ${caller} != 'sitemap' and ${caller} != 'favorites' and ${caller} != 'restore_results'">
                  <if cond="${request:object:canIAdd} and ${request:config:read_only}==0">
                    <if cond="${viewdef:dslib:runjs}=='Yes'">
                            <div class="add-type-wrapper">
                                <select name="add_type$field" size="1" class="VariableWidth9 selectbox selectbox-plain"
                                        onchange="if (this.options[this.selectedIndex].value!='None') {document.${local:toolFormName}.go_add${field}.click()}">
                          <insert ref="local:addPulldown"/>
                      </select>
                            </div>
                      <else>
                                <div class="add-type-wrapper">
                                    <select name="add_type$field" size="1" class="VariableWidth9 selectbox selectbox-plain">
                          <insert ref="local:addPulldown"/>
                        </select>
                                </div>
                      </else>
                    </if>

                    <input type="submit" name="go_add$field" value="${viewdef:dslibMessages:go}" class="bs"/>
                  </if>
                </if>

    <else>
      <!-- comes here only for the search results page.  Do the save search menu -->
                  <if cond="${request:url_parameter(name='scope',sep='&amp;')}!='WikiPageAttachments'">
          <if cond="not ${request:directory:is_user_level(level='minimum')}"><!-- read-only users can't add savedqueries -->
      <if cond="${viewdef:dslib:runjs}=='Yes'">
                                <div class="add-type-wrapper">
                                    <select name="add_type$field" size="1" class="selectbox selectbox-plain"
                                            onchange="if (this.options[this.selectedIndex].value!='None') {document.${local:toolFormName}.go_add${field}.click()}">
          <insert ref="local:addSearchPulldown"/>
        </select>
                                </div>
        <else>
                                    <div class="add-type-wrapper">
                                        <select name="add_type$field" size="1" class="VariableWidth9 selectbox selectbox-plain">
            <insert ref="local:addSearchPulldown"/>
          </select>
                                    </div>
        </else>
      </if>
      <input type="submit" name="go_add$field" value="${viewdef:dslibMessages:go}" class="bs"/>
      </if>
                    </if>
                    <!-- not 'WikiPageAttachments' -->
    </else>
         </if>
    </td>

    <!-- selector for show/hide abstracts and discussions -->
      <if cond="${caller}=='collection_image' or ${caller}=='search' or ${caller}=='search_image' or ${caller}=='collection_speed'">
              <td>
                  <div class="presentation">
                    <define id="toolbar_multi_with_pref_container_key"><if cond="${request:handle}=='Site'">Site<else><insert ref="request:object:handle"/></else></if></define>
                    <define id="toolbar_multi_with_pref_viewformat"><if cond="${request:has_object} and ${caller} in ['collection_image', 'collection_speed']"><insert ref="request:object:view_format(appl='Paging')" /><else><insert ref="request:paging_value(appl='SearchPaging',container='${toolbar_multi_with_pref_container_key}',name='view',default='view_list')"/></else></if></define>
                    <define id="toolbar_multi_with_pref_is_list_active"><if cond="${toolbar_multi_with_pref_viewformat} == 'view_list'">active</if></define>
                    <define id="toolbar_multi_with_pref_is_image_active"><if cond="${toolbar_multi_with_pref_viewformat} == 'view_image'">active</if></define>
                    <define id="toolbar_multi_with_pref_is_mail_active"><if cond="${toolbar_multi_with_pref_viewformat} == 'view_email'">active</if></define>
          <define id="appl"><if cond="${caller}=='collection_speed' or ${caller}=='collection_image'">Paging<else>SearchPaging</else></if></define>

          <if cond="${caller}!='search' and ${caller}!='search_image'">
                      <a href="${local:cgi}ProcessMultipleCommand?goRangeButton=refresh&amp;amp;container=${request:object:handle}&amp;amp;application=${appl}&amp;amp;collection=${request:object:handle}"
                         title="${viewdef:dslibMessages:refresh}">
                            <span class="icon icon-refresh"></span>
                      </a>
          </if>

          <if cond="${viewdef:dslib:runjs}=='Yes'">
            <if cond="${caller}=='search' or ${caller}=='search_image'">
              <if cond="${request:search_result:getTotalCount}!='0'">
                                <a href="javascript:void(0);" onclick="showDiv('abstracttext'); return(false);" class="show-hide-details">
                                  <insert ref="viewdef:dslibMessages:showHideDetails"/>
                              </a>
              </if>
            <elif cond="${caller}=='discussion'">
                                <a href="javascript:void(0);" onclick="showDiv('descriptiontext'); return(false);" class="show-hide-details">
                                      <insert ref="viewdef:dslibMessages:showHideDetails"/>
                                  </a>
            </elif>
            </if>
          </if>

          <if cond="not ${request:directory:is_user_level(level='imageManager')}">

          <if cond="${request:handle}=='Site'">
                            <a href="${local:cgi}ProcessMultipleCommand?view=view_list&amp;amp;container=Site&amp;amp;application=${appl}&amp;amp;collection=Collection-0"
                               class="${toolbar_multi_with_pref_is_list_active}"
                               title="${viewdef:dslibMessages:viewList}">
                                <span class="icon icon-rectangle"></span>
                          </a>
            <if cond="${request:canDo(feature='com.xerox.docushare.viewThumbnails')}">
                                <a href="${local:cgi}ProcessMultipleCommand?view=view_image&amp;amp;container=Site&amp;amp;application=${appl}&amp;amp;collection=Collection-0"
                                   class="${toolbar_multi_with_pref_is_image_active}"
                                   title="${viewdef:dslibMessages:viewImages}">
                                    <span class="icon icon-folder-view"></span>
                              </a>
            </if>
                            <a href="${local:cgi}ProcessMultipleCommand?view=view_email&amp;amp;container=Site&amp;amp;application=${appl}&amp;amp;collection=Collection-0"
                               class="${toolbar_multi_with_pref_is_mail_active}"
                               title="${viewdef:dslibMessages:viewEmail}">
                                <span class="icon icon-mail"></span>
                          </a>
                            <a style="cursor:pointer" onclick="showHideViewOption();" title="${viewdef:dslibMessages:preferenceChangeViewOptions}" id="show_pref">
                                <span class="icon icon-column"></span>
                          </a>
            <else>
                            <a href="${local:cgi}ProcessMultipleCommand?view=view_list&amp;amp;container=${request:object:handle}&amp;amp;application=${appl}&amp;amp;collection=${request:object:handle}"
                               class="${toolbar_multi_with_pref_is_list_active}"
                               title="${viewdef:dslibMessages:viewList}">
                                <span class="icon icon-rectangle"></span>
                              </a>
              <if cond="${request:canDo(feature='com.xerox.docushare.viewThumbnails')}">
                                <a href="${local:cgi}ProcessMultipleCommand?view=view_image&amp;amp;container=${request:object:handle}&amp;amp;application=${appl}&amp;amp;collection=${request:object:handle}"
                                   class="${toolbar_multi_with_pref_is_image_active}"
                                   title="${viewdef:dslibMessages:viewImages}">
                                    <span class="icon icon-folder-view"></span>
                                  </a>
              </if>
                            <a href="${local:cgi}ProcessMultipleCommand?view=view_email&amp;amp;container=${request:object:handle}&amp;amp;application=${appl}&amp;amp;collection=${request:object:handle}"
                               class="${toolbar_multi_with_pref_is_mail_active}"
                               title="${viewdef:dslibMessages:viewEmail}">
                                <span class="icon icon-mail"></span>
                              </a>
              <if cond="${request:is_type_of(classname='${request:object:classname}', base_class='Collection')}">
                                  <a style="cursor:pointer" onclick="showHideViewOption();" title="${viewdef:dslibMessages:preferenceChangeViewOptions}">
                                    <span class="icon icon-column"></span>
                                  </a>
              </if>
            </else>
          </if>

                  </if>
                  </div>
                  <!-- directory:is_user_level(level='imageManager') -->
        </td>
      </if>
  </tr>
   </table>
  <if cond="${caller}!='collection_speed' and ${caller}!='collection_image' and ${caller}!='search' and ${caller}!='search_image'">
      <if cond="${request:totalNumChildren(caller='${caller}')}!='0'">
        <div class="toolbar_paging"><insert ref="local:page_handling(field='${field}', caller='${caller}')"/></div>
      </if>
  </if>
  </define>

<define id="addPulldown">
      <option value="None" selected="selected"><insert ref="viewdef:dslibMessages:addMore" /></option>
      <iter ref="request:object:legal_children">
                          <if cond="not $:name in ['MailMessage', 'SavedQuery']"> <!-- Add Menu filtering -->
                            <if cond="${request:directory:is_user_level(level='imageManager')} and ${request:is_type_of( classname='$:name', base_class='Document' )}">
                              <!-- don't do anything -->
                            <else>
                              <option value="$:name"><insert ref=":label"/></option>
                            </else>
                            </if>
                          </if>
      </iter>
      <!--<if cond="${request:canDo(feature='com.xerox.docushare.createInteract')}">
        <if cond="${request:object:is_type_of( classname='Collection' )}">
          <option value="Interact"><insert ref="viewdef:dslibMessages:interactPage" /></option>
        </if>
      </if>-->
</define>

<define id="addSearchPulldown">
    <if cond="${request:within_space}">
        <if cond="$request:space_member and ${request:space:legal_class(classname='SavedQuery')}">
            <insert ref="local:searchMenu"/>
        </if>
    <else>
        <insert ref="local:searchMenu"/>
    </else>
    </if>
</define>

<define id="searchMenu">
    <if cond="$request:config:read_only==0">
        <option value="None" selected="selected"><insert ref="viewdef:dslibMessages:addMore" /></option>
        <option value="ThisQuery"><insert ref="request:objmgr:view_type(type='SavedQuery')"/></option>
    <else>
        <option value="None" selected="selected"><insert ref="viewdef:dslibMessages:readOnlyMode" /></option>
    </else>
    </if>
</define>

<define id="container_key"><if cond="${request:handle}=='Site'">Site<else><insert ref="request:object:handle"/></else></if></define>
<define id="searchAppl">SearchPaging</define>
<define id="isArchiver"><insert ref="request:paging_value(container='${container_key}', appl='${searchAppl}', name='dsarchive', default='false')"/></define>

  <define id="show_hide_abstracts">
    <!-- selector for show/hide abstracts and discussions -->
    <td align="left" valign="middle">
      <if cond="${viewdef:dslib:runjs}=='Yes'">
        <if cond="${caller}=='search' or ${caller}=='search_image'">
          <a href="javascript:void(0);" onclick="showDiv('abstracttext'); return(false);" class="show-hide-details"><insert ref="viewdef:dslibMessages:showHideDetails" /></a>
          <elif cond="${caller}=='discussion'">
            <a href="javascript:void(0);" onclick="showDiv('descriptiontext'); return(false);" class="show-hide-details"><insert ref="viewdef:dslibMessages:showHideDetails" /></a>
          </elif>
        </if>
      </if>
    </td>
  </define>

  <define id="page_handling">
      <if cond="${caller}=='collection' or ${caller}=='collection_image' or ${caller}=='search' or ${caller}=='search_image'">
        <!-- This section contains the controls for paging and only requires translation of the img alt tags -->


              <if cond="${request:previous(caller='${caller}')} != ''">
          <input rel="prev" type="submit" class="midalign prev-button" value="" alt="${viewdef:dslibMessages:previousPage}" name="previous$field" />
                <else>
          <img src='${request:theme_url}images/paging/left_disabled.png' class="midalign" border='0' alt='${viewdef:WorkspaceHomepageMessages:previousPage}' title='${viewdef:WorkspaceHomepageMessages:previousPage}' />
                </else>
              </if>

        <span class="summaryText"><insert ref="viewdef:dslibMessages:view" /></span>

        <span style="display:none"><input class="bs" type="submit" value="${viewdef:WorkspaceHomepageMessages:go}" name="goRangeButton$field" id="goPageButton$field"/></span>

        <div class="page-list-wrapper">
          <insert ref="request:rangeSelection(caller='${caller}', field='${field}')" />
        </div>

              <if cond="${request:next(caller='${caller}')} != ''">
          <input rel="next" type="submit" value="" class="midalign next-button" hspace="0" alt="${viewdef:dslibMessages:nextPage}" name="next$field"  />
                <else>
          <img src='${request:theme_url}images/paging/right_disabled.png' class="midalign" border='0' alt='${viewdef:WorkspaceHomepageMessages:nextPage}' title='${viewdef:WorkspaceHomepageMessages:nextPage}' />
                </else>
              </if>


            <span class="summaryText"><insert ref="viewdef:dslibMessages:showingText(pageIncrement=${request:pageIncrement(caller='${caller}')})" /></span>


        <elif cond="${caller}=='favorites'">

          <!-- left -->
                <if cond="${request:previous(caller='${caller}', javaClass='FavoritesListImpl', sessionKey='com.xerox.docushare.favorites${local:space_name}')} != ''">
            <input rel="prev" type="submit" class="midalign prev-button" value="" alt="${viewdef:dslibMessages:previousPage}" name="previous$field" />
                  <else>
            <img src='${request:theme_url}images/paging/left_disabled.png' class="midalign" border='0' alt='${viewdef:WorkspaceHomepageMessages:previousPage}' title='${viewdef:WorkspaceHomepageMessages:previousPage}' />
                  </else>
                </if>

          <span class="summaryText"><insert ref="viewdef:dslibMessages:view" /></span>
          <span style="display:none"><input class="bs" type="submit" value="${viewdef:WorkspaceHomepageMessages:go}" name="goPageButton$field" id="goPageButton$field"/></span>

          <div class="page-list-wrapper">
              <insert ref="request:rangeSelection(caller='${caller}', field='${field}', javaClass='FavoritesListImpl', sessionKey='com.xerox.docushare.favorites${local:space_name}')" />
          </div>

          <!-- right -->
                <if cond="${request:next(caller='${caller}', javaClass='FavoritesListImpl', sessionKey='com.xerox.docushare.favorites${local:space_name}')} != ''">
            <input rel="next" type="submit" value="" class="midalign next-button" hspace="0" alt="${viewdef:dslibMessages:nextPage}" name="next$field"  />
                  <else>
            <img src='${request:theme_url}images/paging/right_disabled.png' class="midalign" border='0' alt='${viewdef:WorkspaceHomepageMessages:nextPage}' title='${viewdef:WorkspaceHomepageMessages:nextPage}' />
                  </else>
                </if>

        </elif>
      </if>
  </define>

  <define id="remote_toolbar_multi"> <!-- ONLY called from search_results.vdf page when displaying federated search results -->
    <define id="remoteToolFormName">ViewList</define>
    <table border="0" cellspacing="0" cellpadding="0" class="toolbar_multi" width="${request:page_width}">

  <tr>
    <!-- selector for show/hide abstracts and discussions -->
        <td>

          <div class="presentation">
            <define id="remote_toolbar_multi_container_key"><if cond="${request:handle}=='Site'">Site<else><insert ref="request:object:handle"/></else></if></define>
            <define id="remote_toolbar_multi_viewformat"><if cond="${request:has_object} and ${caller} in ['collection_image', 'collection_speed']"><insert ref="request:object:view_format(appl='Paging')" /><else><insert ref="request:paging_value(appl='SearchPaging',container='${remote_toolbar_multi_container_key}',name='view',default='view_list')"/></else></if></define>
            <define id="remote_toolbar_multi_is_list_active"><if cond="${remote_toolbar_multi_viewformat} == 'view_list'">active</if></define>
            <define id="remote_toolbar_multi_is_image_active"><if cond="${remote_toolbar_multi_viewformat} == 'view_image'">active</if></define>
            <define id="remote_toolbar_multi_is_mail_active"><if cond="${remote_toolbar_multi_viewformat} == 'view_email'">active</if></define>

              <if cond="${request:search_result:getTotalCount}!='0'">
              <span>
                <a href="javascript:void(0);" onclick="showDiv('abstracttext'); return(false);" class="show-hide-details">
                  <insert ref="viewdef:dslibMessages:showHideDetails"/>
                </a>
                </span>
              </if>

          <if cond="not ${request:directory:is_user_level(level='imageManager')}">

          <if cond="${request:handle}=='Site'">
                <a href="${local:cgi}ProcessMultipleCommand?view=view_list&amp;amp;container=Site&amp;amp;application=${appl}&amp;amp;collection=Collection-0"
                   class="${remote_toolbar_multi_is_list_active}"
                   title="${viewdef:dslibMessages:viewList}">
                  <span class="icon icon-rectangle"></span>
                </a>
                <a href="${local:cgi}ProcessMultipleCommand?view=view_image&amp;amp;container=Site&amp;amp;application=${appl}&amp;amp;collection=Collection-0"
                   class="${remote_toolbar_multi_is_image_active}"
                   title="${viewdef:dslibMessages:viewImages}">
                  <span class="icon icon-folder-view"></span>
                </a>
                <a href="${local:cgi}ProcessMultipleCommand?view=view_email&amp;amp;container=Site&amp;amp;application=${appl}&amp;amp;collection=Collection-0"
                   class="${remote_toolbar_multi_is_mail_active}"
                   title="${viewdef:dslibMessages:viewEmail}">
                  <span class="icon icon-mail"></span>
                </a>
              <else>
                <a href="${local:cgi}ProcessMultipleCommand?view=view_list&amp;amp;container=${request:object:handle}&amp;amp;application=${appl}&amp;amp;collection=${request:object:handle}"
                   class="${remote_toolbar_multi_is_list_active}"
                   title="${viewdef:dslibMessages:viewList}">
                  <span class="icon icon-rectangle"></span>
                </a>
                <a href="${local:cgi}ProcessMultipleCommand?view=view_image&amp;amp;container=${request:object:handle}&amp;amp;application=${appl}&amp;amp;collection=${request:object:handle}"
                   class="${remote_toolbar_multi_is_image_active}"
                   title="${viewdef:dslibMessages:viewImages}">
                  <span class="icon icon-folder-view"></span>
                </a>
                <a href="${local:cgi}ProcessMultipleCommand?view=view_email&amp;amp;container=${request:object:handle}&amp;amp;application=${appl}&amp;amp;collection=${request:object:handle}"
                   class="${remote_toolbar_multi_is_mail_active}"
                   title="${viewdef:dslibMessages:viewEmail}">
                  <span class="icon icon-mail"></span>
                </a>
            </else>
          </if>

          </if>
          </div>
          <!-- directory:is_user_level(level='imageManager') -->
        </td>
  </tr>
    </table>

  </define>

  <define id="brief_list">
    <tr>
      <td class="icon">
  <a href="${request:html:url_escape(astring=$object:get_url)}">
      <img src="${request:config:abs_path}images/${object:icon}?v=${request:config:short_version}" class="linklabel" alt="$object:view_classname" title="$object:view_classname"/>
  </a>
      </td>
      <td class="name">
      <div class="preventNameOverflow">
      <a  href="${request:html:url_escape(astring=$object:get_url)}"><strong><insert ref="object:title"/></strong></a>
      <if cond="$object:is_new">
        <span class="new-item" title="${viewdef:dslibMessages:new}"><insert ref="viewdef:dslibMessages:new"/></span>
      </if>
      </div>
      </td>
    </tr>
  </define>

  <define id="summarize">
    <if cond="$object:is_type_of( classname='Subscription' )">
      <insert ref="viewdef:dslib:summarize_subscription(object=${object},cgi=${cgi})"/>
      <else>
  <tr>
    <td align="center" valign="top">
      <a href="$object:get_url" target="${window_target}"><insert ref="request:img(src='images/${object:icon}?v=${request:config:short_version}', width='30', height='30', border='0', alt='$object:view_classname', title='$object:view_classname')"/></a>
    </td>
    <td valign="top">
      <a href="$object:get_url" target="${window_target}"><insert ref="object:title"/></a>
      <if cond="$object:is_new">
        <span class="new-item" title="${viewdef:dslibMessages:new}"><insert ref="viewdef:dslibMessages:new"/></span>
      </if>
      <if cond="${object:summary:gets}!=''">
        <font size="-1">
    <insert ref="viewdef:dslib:br"/><insert ref="object:summary"/>
        </font>
      </if>
      <if cond="${appears_in}=='yes'">
        <if cond="${object:num_parents}!=0">
    <font size="-1"><insert ref="viewdef:dslib:br"/><em><insert ref="viewdef:dslibMessages:appearsIn" /></em>
    <iter ref="object:parents">
      <a href="${:get_url}" target="${window_target}"><insert ref=":title"/></a>
      <if cond="$:_last!=1">,&nbsp;</if>
    </iter>
    </font>
        </if>
      </if>
      <if cond="${abstract}=='yes' and ${object:is_type_of( classname='Document' )}">
        <if cond="${object:abstract}!=''">
    <font size="-1"><insert ref="viewdef:dslib:br"/><em><insert ref="viewdef:dslibMessages:abstract" /></em>
    <insert ref="object:abstract"/></font>
        </if>
      </if>
    </td>
    <td valign="top"><font size="-1">
      <a href="${cgi}ViewProps/${object:owner_obj:handle}" target="${window_target}"><insert ref="object:owner_obj:getShortName"/>
    </a></font></td>
    <td valign="top"><font size="-1"><insert ref="object:date(type='modified',format='short')"/></font></td>
    <td align="center" valign="top"><font size="-1">
    <i><insert ref="object:size"/></i></font></td>
    <td valign="top"><font size="-1">
      <a href="${cgi}ViewProps/$object:handle" target="${window_target}"><img border="0" alt="${viewdef:dslibMessages:properties}" title="${viewdef:dslibMessages:properties}" src="${request:config:abs_path}images/local/dsdriver.gif"/></a>
    </font></td>
    <if cond="$object:is_type_of( classname='File' )">
      <if cond="${object:locked_by:gets}==''">
        <if cond="not ${object:is_deleted}">
    <td valign="top">
      <a href="${cgi}CheckOut/${object:handle}/${request:html:underscore_escape(astring=$object:document)}" target="${window_target}"><img border="0" alt="${viewdef:dslibMessages:checkout}" title="${viewdef:dslibMessages:checkout}" src="${request:config:abs_path}images/local/checkout.gif"/></a>
    </td>
        </if>
        <else>
    <td valign="top">
      <a href="${cgi}ViewProps/${object:handle}" target="${window_target}"><img border="0" alt="${viewdef:dslibMessages:lockText(lockBy=$object:locked_by:getShortName)}" title="${viewdef:dslibMessages:lockText(lockBy=$object:locked_by:getShortName)}" src="${request:config:abs_path}images/local/doclock.gif"/></a>
    </td>
        </else>
      </if>
      <td>
        <!-- Document Routing -->
        <if cond="${viewdef:dslib:routingEnabled}=='Yes'">
        <define id="routing_slip_url"><if cond="${request:within_space}">javascript:openRoutingSlip('<insert ref="request:config:abs_path"/>space/<insert ref="request:space_name"/>/', '${object:handle}')<else>javascript:openRoutingSlip('<insert ref="request:config:abs_path"/>', '${object:handle}')</else></if></define>
    <a href="$routing_slip_url"><img border="0" alt="${viewdef:dslibMessages:route}" title="${viewdef:dslibMessages:route}" src="${request:config:abs_path}images/action_routing.gif"/></a>
    <!-- <a href="javascript:openRoutingSlip('${request:config:abs_path}', '${object:handle}')"><img border="0" alt="${viewdef:dslibMessages:route}" title="${viewdef:dslibMessages:route}" src="${request:config:abs_path}images/action_routing.gif"/></a> -->
        </if>
      </td>
      <if cond="${object:is_viewable}==1">
        <td valign="top"><font size="-1">
    <a href="${cgi}GetRepr/${object:handle}/html" target="${window_target}"><img border="0" alt="${viewdef:dslibMessages:view}" title="${viewdef:dslibMessages:view}" src="${request:config:abs_path}images/small/html.gif"/></a>
        </font></td>
      </if>
      <else>
        <td valign="top"/>
      </else>
    </if>
  </tr>
      </else>
    </if>
  </define>

  <define id="container_key"><if cond="${request:handle}=='Site' or ${request:handle}==''">Site<else><insert ref="request:object:handle"/></else></if></define>
  <define id="set_checkbox">
    <if cond="${request:directory:is_logged_in_user}">
      <if cond="${viewdef:dslib:runjs}=='Yes'">
        <if cond="${request:want_checkbox(appl='Paging',container='${local:container_key}',handle='${object:handle}')}">
          <td class="icon checkbox">
            <input type="checkbox" id="checkbox${object:_sequence}" name="cbx${object:_sequence}" value="selected" class="checkbox" checked="checked" onclick="hiLight(this, 'row${object:_sequence}')" /><label for="checkbox${object:_sequence}">&nbsp;</label>
            <input type="hidden" name="cbx${object:_sequence}_obj" value="${object:handle}" />
          </td>
          <else>
            <td class="icon checkbox">
              <input type="checkbox" id="checkbox${object:_sequence}" name="cbx${object:_sequence}" value="selected" class="checkbox" onclick="hiLight(this, 'row${object:_sequence}')" /> <label for="checkbox${object:_sequence}">&nbsp;</label>
              <input type="hidden" name="cbx${object:_sequence}_obj" value="${object:handle}" />
            </td>
          </else>
        </if>
        <else>
          <if cond="${request:want_checkbox(appl='Paging',container='${local:container_key}',handle='${object:handle}')}">
            <td class="icon checkbox">
              <input type="checkbox" id="checkbox${object:_sequence}" name="cbx${object:_sequence}" value="selected" class="checkbox" checked="checked" /> <label for="checkbox${object:_sequence}">&nbsp;</label>
              <input type="hidden" name="cbx${object:_sequence}_obj" value="${object:handle}" />
            </td>
            <else>
              <td class="icon checkbox">
                <input type="checkbox" id="checkbox${object:_sequence}" name="cbx${object:_sequence}" class="checkbox" value="selected" /> <label for="checkbox${object:_sequence}">&nbsp;</label>
                <input type="hidden" name="cbx${object:_sequence}_obj" value="${object:handle}" />
              </td>
            </else>
          </if>
        </else>
      </if>
      <else>
        <td class="nospace"><insert ref="viewdef:dslib:nbsp" /></td>
      </else>
    </if>
  </define>

  <define id="summarize_speed">

      <define id="objectSequenceNum"><if cond="$ref == 'duplicateItems'"><insert ref="sequenceNum" /><else><insert ref="object:_sequence" /></else></if></define>

      <define id="t"><insert ref="object:get_url" /></define>
      <tr about="$request:html:url_escape(astring='${t}')" id="row${objectSequenceNum}">

      <!-- Checkbox -->
      <!--<if cond="${request:isLocalSite}=='true' and ${ref}!='portlet' and $ref != 'duplicateItems'">-->
      <if cond="not ${object:handleIsRemote} and ${ref}!='portlet' and $ref != 'duplicateItems'">
            <insert ref="local:set_checkbox(object=${object})"/>
      </if>

      <!-- ICON -->
      <insert ref="local:set_icon(object=${object}, locked_by=${locked_by})"/>

      <!--Title -->
      <insert ref="local:set_title(object=${object}, appears_in=${appears_in}, abstract=${abstract})"/>

      <!-- Owner -->
      <td class="generic">
  <if cond="${owner}!='no'">
    <if cond="${object:isFromExternalServer}">
      <insert ref="object:owner_obj:getShortName"/>
      <else>
        <insert ref="viewdef:dslib:href_link_text(func='${viewdef:dslibMessages:clicktoViewProps}',handle='${object:owner_obj:handle}',url='${object:cgi}Services/${object:owner_obj:handle}', label='${object:owner_obj:getShortName}')"/>
      </else>
    </if>
  </if>
      </td>

      <!-- Security Level -->
      <if cond="$request:config:enable_security_icon">
  <td class="nospace">
    <!--<if cond="not ${object:isFromExternalServer} and ${request:isLocalSite}=='true'">-->
    <if cond="not ${object:isFromExternalServer} and not ${object:handleIsRemote}">
    <if cond="$object:is_type_of(classname='User')=='false' and $object:is_type_of(classname='Group')=='false'">
      <if cond="$object:securityLevel=='1'">
        <a href="${object:cgi}ServicesLib/${object:handle}/Permissions">
                  <img src='${request:config:abs_path}images/small/access_user.png?v=${request:config:short_version}' width='20' height='20' border='0' alt='${viewdef:dslibMessages:individualAccess}' title='${viewdef:dslibMessages:individualAccess}' />
        </a>
        <elif cond="$object:securityLevel=='2'">
    <a href="${object:cgi}ServicesLib/${object:handle}/Permissions">
                    <img src='${request:config:abs_path}images/small/access_group.png?v=${request:config:short_version}' width='20' height='20' border='0' alt='${viewdef:dslibMessages:groupAccess}' title='${viewdef:dslibMessages:groupAccess}' />
    </a>
        </elif>
        <elif cond="$object:securityLevel=='3'">
    <a href="${object:cgi}ServicesLib/${object:handle}/Permissions">
                    <img src='${request:config:abs_path}images/small/access_public.png?v=${request:config:short_version}' width='20' height='20' border='0' alt='${viewdef:dslibMessages:openAccess}' title='${viewdef:dslibMessages:openAccess}' />
    </a>
        </elif>
      </if>
    </if>
    <else>
    <insert ref="viewdef:dslib:nbsp"/>
    </else>
    </if>
  </td>
      </if>

      <!-- Date -->
      <if cond="${abstract}=='yes'">
        <td property="dc:date" class="generic"><insert ref="object:date(type='modified',format='short_time_date')"/></td>
        <else>
          <td property="dc:date" class="generic"><insert ref="object:date(type='modified',format='short')"/></td>
        </else>
      </if>
      <!-- Size -->
      <td class="nospace summaryText"><insert ref="object:size_string"/></td>

      <!-- Please Keep Custom property example (Collection.option): the following code displays a sortable new column.  The custom property exists on the Collection class only.
           <td width="${request:size_width}" align="right" valign="top" class="VariableWidth9">
           <if cond="$object:is_type_of(classname='Collection')"><insert ref="object:option"/></if>
           </td>
      -->

      <insert ref="local:space_info"/>

      <!-- Services icon -->
      <if cond="not ${object:canSearchOnly}">
        <if cond="${ref}=='portlet'">
          <td class="actions_nomore">
              <insert ref="viewdef:uilib:SummarizeActionsMore(object=${object})" />
          </td>
          <else>
            <td class="actions">
              <insert ref="viewdef:uilib:SummarizeActionsPart1(object=${object})" />
            </td>
          </else>
        </if>
      </if>

      </tr>

  </define>

   <define id="summarize_speed_selectedProps">

      <define id="objectSequenceNum"><if cond="$ref == 'duplicateItems'"><insert ref="sequenceNum" /><else><insert ref="object:_sequence" /></else></if></define>

      <define id="t"><insert ref="object:get_url" /></define>
      <tr about="$request:html:url_escape(astring='${t}')" id="row${objectSequenceNum}">

      <!-- Checkbox -->
      <if cond="not ${object:handleIsRemote} and ${ref}!='portlet' and $ref != 'duplicateItems'">
            <insert ref="local:set_checkbox(object=${object})"/>
      </if>

     <iter ref="request:preference_obj:selectedProps(appl='${appl}',container=${container})">
      <if cond="${:classname}=='Object'">
        <if cond="${:name}=='type'">
           <!-- ICON -->
           <insert ref="local:set_icon(object=${object}, locked_by=${locked_by})"/>
        <elif cond="${:name}=='title'">
           <!--Title -->
           <insert ref="local:set_title(object=${object}, appears_in=${appears_in}, abstract=${abstract})"/>
        </elif>
        <elif cond="${:name}=='owner'">
           <!-- Owner -->
            <td class="generic">
            <if cond="${owner}!='no'">
              <if cond="${object:isFromExternalServer}">
              <insert ref="object:owner_obj:getShortName"/>
              <else>
                <insert ref="viewdef:dslib:href_link_text(func='${viewdef:dslibMessages:clicktoViewProps}',handle='${object:owner_obj:handle}',url='${object:cgi}Services/${object:owner_obj:handle}', label='${object:owner_obj:getShortName}')"/>
              </else>
              </if>
            </if>
            </td>
        </elif>
        <elif cond="${:name}=='size'">
            <td class="nospace summaryText"><insert ref="object:size_string"/></td>
        </elif>
        <elif cond="${:name}=='space'">
          <td class="generic"><if cond="${object:within_space}"><insert ref="object:space_title(truncate='40')"/></if></td>
         </elif>
        <elif cond="${:name}=='action'">
            <!-- Services icon -->
            <if cond="not ${object:canSearchOnly}">
            <if cond="${ref}=='portlet' or ${object:is_type_of(classname='Subscription')} or ${object:is_type_of(classname='User')} or ${object:is_type_of(classname='Group')}">
              <td class="actions_nomore">
              <insert ref="viewdef:uilib:SummarizeActionsMore(object=${object})" />
              </td>
              <else>
              <td class="actions">
                <insert ref="viewdef:uilib:SummarizeActionsPart1(object=${object})" />
              </td>
              </else>
            </if>
            </if>
        </elif>
        <else>
          <if cond="$request:preference_obj:isDateProp(propType=$:type)">
            <if cond="${abstract}=='yes'">
              <td property="dc:date" class="generic"><insert ref="object:date(type=$:name,format='short_time_date')"/></td>
            <else>
              <td property="dc:date" class="generic"><insert ref="object:date(type=$:name,format='short')"/></td>
            </else>
            </if>
          <else>
            <td width="${request:size_width}" align="right" valign="top" class="VariableWidth9">
              <insert ref="object:get_prop_pref(offset='-1',name=$:name):gets"/>
            </td>
          </else>
          </if>
        </else>
        </if>
      <else>
        <if cond="$request:preference_obj:isDateProp(propType=$:type) and $object:is_type_of(classname=$:classname)">
            <if cond="${abstract}=='yes'">
              <td property="dc:date" class="generic"><insert ref="object:date(type=$:name,format='short_time_date')"/></td>
            <else>
              <td property="dc:date" class="generic"><insert ref="object:date(type=$:name,format='short')"/></td>
            </else>
            </if>
        <else>
          <td width="${request:size_width}" align="right" valign="top" class="VariableWidth9">
            <if cond="$object:classname == $:classname"> <!-- AR 32932 -->
              <insert ref="object:get_prop_pref(offset='-1',name=$:name):gets"/>
            </if>
           </td>
         </else>
         </if>
      </else>
      </if>
       </iter>

      <!-- Security Level -->
      <if cond="$request:config:enable_security_icon">
  <td class="nospace">
    <!--<if cond="not ${object:isFromExternalServer} and ${request:isLocalSite}=='true'">-->
    <if cond="not ${object:isFromExternalServer} and not ${object:handleIsRemote}">
    <if cond="$object:is_type_of(classname='User')=='false' and $object:is_type_of(classname='Group')=='false'">
      <if cond="$object:securityLevel=='1'">
        <a href="${object:cgi}ServicesLib/${object:handle}/Permissions">
    <img src='${request:config:abs_path}images/small/access_user.png?v=${request:config:short_version}' width='20' height='20' border='0' alt='${viewdef:dslibMessages:individualAccess}' title='${viewdef:dslibMessages:individualAccess}' />
        </a>
        <elif cond="$object:securityLevel=='2'">
    <a href="${object:cgi}ServicesLib/${object:handle}/Permissions">
      <img src='${request:config:abs_path}images/small/access_group.png?v=${request:config:short_version}' width='20' height='20' border='0' alt='${viewdef:dslibMessages:groupAccess}' title='${viewdef:dslibMessages:groupAccess}' />
    </a>
        </elif>
        <elif cond="$object:securityLevel=='3'">
    <a href="${object:cgi}ServicesLib/${object:handle}/Permissions">
      <img src='${request:config:abs_path}images/small/access_public.png?v=${request:config:short_version}' width='20' height='20' border='0' alt='${viewdef:dslibMessages:openAccess}' title='${viewdef:dslibMessages:openAccess}' />
    </a>
        </elif>
      </if>
    </if>
    <else>
    <insert ref="viewdef:dslib:nbsp"/>
    </else>
    </if>
  </td>
      </if>


      </tr>

  </define>

  <define id="summarize_speed_image_store">
    <define id="objectSequenceNum"><if cond="$ref == 'duplicateItems'"><insert ref="sequenceNum" /><else><insert ref="object:_sequence" /></else></if></define>
    <tr id="row${objectSequenceNum}">

      <!-- Checkbox -->
      <!--<if cond="${request:isLocalSite}=='true' and ${ref}!='portlet' and $ref != 'duplicateItems'">-->
      <if cond="not ${object:handleIsRemote} and ${ref}!='portlet' and $ref != 'duplicateItems'">
        <insert ref="local:set_checkbox(object=${object})"/>
      </if>

      <!-- ICON -->
      <insert ref="local:set_icon(object=${object}, locked_by=${locked_by})"/>
      <define id="fname"><if cond="${request:is_licensed(key='file_cabinet_replacement')}">FCRUI<else>ImageStore</else></if></define>
      <iter ref="request:imageStoreDisplayProps(page='search', classname=${object:classname}, filename='${fname}')">
        <if cond="${:name} == 'title'">

          <!--TITLE -->
          <insert ref="local:set_title(object=${object}, appears_in=${appears_in}, abstract=${abstract})"/>

          <else>
            <!-- ALL OTHER PROPERTIES -->
            <td class="generic">
              <insert ref="object:prop(name='${:name}'):gets"/>
            </td>
          </else>
        </if>
      </iter>

      <insert ref="local:space_info"/>

      <!-- Services icon -->
      <if cond="not ${object:canSearchOnly}">
        <td class="actions">
          <insert ref="viewdef:uilib:SummarizeActionsPart1(object=${object})" />
        </td>
      </if>

    </tr>
  </define>

  <define id="space_info">
    <if cond="${ref}=='space' and ${request:has_spaces}">
      <td class="generic"><if cond="${object:within_space}"><insert ref="object:space_title(truncate='40')"/></if></td>
    </if>
  </define>

  <define id="set_icon">

    <!-- ICON Title -->
    <define id="get_iconTitle"><if cond="$object:is_type_of(classname='Document') and ${request:is_licensed(key='file_cabinet_replacement')} and not ${object:is_interact}"><if cond="${object:canDo(feature='com.xerox.docushare.viewSplitScreen')}"><!-- Document mime-types that can be viewed in all supported browsers --><if cond="${object:content_type:get} in [ 'image/gif', 'image/jpeg', 'image/png', 'text/plain', 'text/html', 'text/xml', 'image/tif', 'image/tiff', 'image/bmp', 'application/pdf', 'application/vnd.fujixerox.docuworks', 'application/vnd.fujixerox.docuworks.binder', 'application/vnd.fujixerox.docuworks.container']"><insert ref="viewdef:dslibMessages:fcr_iconTitle(className=$object:view_classname)"/><!-- Document mime types that can be viewed only in I.E. --><elif cond="${object:content_type:get} in [ 'application/msword', 'application/vnd.ms-powerpoint', 'application/vnd.ms-excel', 'application/vnd.ms-word.document.macroEnabled.12', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/vnd.ms-word.template.macroEnabled.12', 'application/vnd.openxmlformats-officedocument.wordprocessingml.template', 'application/vnd.ms-powerpoint.template.macroEnabled.12', 'application/vnd.openxmlformats-officedocument.presentationml.template', 'application/vnd.ms-powerpoint.addin.macroEnabled.12', 'application/vnd.ms-powerpoint.slideshow.macroEnabled.12', 'application/vnd.openxmlformats-officedocument.presentationml.template', 'application/vnd.ms-powerpoint.addin.macroEnabled.12', 'application/vnd.ms-powerpoint.slideshow.macroEnabled.12', 'application/vnd.openxmlformats-officedocument.presentationml.slideshow', 'application/vnd.ms-powerpoint.presentation.macroEnabled.12', 'application/vnd.openxmlformats-officedocument.presentationml.presentation', 'application/vnd.ms-excel.addin.macroEnabled.12', 'application/vnd.ms-excel.sheet.binary.macroEnabled.12', 'application/vnd.ms-excel.sheet.macroEnabled.12', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel.template.macroEnabled.12', 'application/vnd.openxmlformats-officedocument.spreadsheetml.template'] and ${request:IE}"><insert ref="viewdef:dslibMessages:fcr_iconTitle(className=$object:view_classname)"/></elif><else><insert ref="object:view_classname"/></else></if><else><insert ref="object:view_classname"/></else></if><else><insert ref="object:view_classname"/></else></if></define>

    <!-- ICON Image -->
    <td class="icon">
      <if cond="not ${object:isFromExternalServer} and ${object:is_type_of( classname='MailMessage' )}">
        <a href="${object:get_url}/${request:handle}">
          <img src='${request:config:abs_path}images/${object:icon}?v=${request:config:short_version}' width='30' height='30' border='0' alt='$object:view_classname' class='midalign' title='$object:view_classname' />
        </a>
        <else>
          <define id="t"><insert ref="object:get_url(record='check')" /></define>
          <if cond="not ${object:is_type_of( classname='WikiPage' )}">
            <a href="$request:html:url_escape(astring=${t})" target="${local:url_targettype}">
        <img src='${request:config:abs_path}images/${object:icon}?v=${request:config:short_version}' width='30' height='30' border='0' alt='$object:view_classname' class='midalign' title='$local:get_iconTitle' />
            </a>
          <else>
            <a href="${t}" target="${local:url_targettype}">
        <img src='${request:config:abs_path}images/${object:icon}?v=${request:config:short_version}' width='30' height='30' border='0' alt='$object:view_classname' class='midalign' title='$local:get_iconTitle' />
            </a>
          </else>
          </if>
        </else>
      </if>
      <if cond="$object:is_type_of( classname='Document' )">
        <if cond="not ${object:isFromExternalServer}">
          <if cond="$object:allow_versions"> <!-- if document is locked -->
            <if cond="${locked_by}=='yes' and $object:is_locked">
              <a href="$request:html:url_escape(astring=$object:get_url)" class="lock-sign"><img class="lockicon" src='${request:theme_url}images/lock.png' border='0' alt='${viewdef:dslibMessages:currentlyLockedBy(lockedBy=$object:locked_by:getShortName)}' title='${viewdef:dslibMessages:currentlyLockedBy(lockedBy=$object:locked_by:getShortName)}'/></a>
            </if>
          </if>
        </if>
      </if>
      <if cond="$object:is_type_of( classname='Document' ) or $object:is_type_of( classname='MailMessage' )">
        <if cond="not ${object:isFromExternalServer}">
          <if cond="${object:isRecord} == 'true' and ${request:is_licensed( key='records_management' )}"> <!-- if document is a declared record -->
            <a href="${object:cgi}ServicesLib/${object:handle}/Classification"><img src='${request:config:abs_path}images/lock.gif' class="recordicon" border='0' alt='${viewdef:dslibMessages:declaredRecord}' title='${viewdef:dslibMessages:declaredRecord}'/></a>
          </if>
        </if>
      </if>
    </td>
  </define> <!-- end of set_icon -->

  <define id="set_title">
    <!--Title -->
    <td class="name">

      <if cond="not ${object:isFromExternalServer} and ${object:is_type_of( classname='MailMessage' )}">
        <!--<if cond="${request:isLocalSite}=='true' and $request:inCutQueue(handle='$object:handle')">-->
        <if cond="not ${object:handleIsRemote} and $request:inCutQueue(handle='$object:handle')">
          <a href="${object:get_url}/${request:handle}"><p property="dc:title"><insert ref="object:getTitle"/></p></a>
        <else>
          <a href="${object:get_url}/${request:handle}"><b property="dc:title"><insert ref="object:getTitle"/></b></a>
        </else>
        </if>
        <if cond="${object:originally_encrypted}">
          <img src="${request:config:abs_path}images/small/bluelock.gif" width="13" height="18" title="${viewdef:dslibMessages:orginallyEncripted}" alt="${viewdef:dslibMessages:orginallyEncripted}"/>
        </if>
        <if cond="${object:originally_signed}">
          <img src="${request:config:abs_path}images/small/redribbon.gif" width="13" height="18" title="${viewdef:dslibMessages:orginallySigned}" alt="${viewdef:dslibMessages:orginallySigned}"/>
        </if>
      <else>
        <define id="t"><insert ref="object:get_url(record='check')" /></define>
        <!--<if cond="${request:isLocalSite}=='true' and $request:inCutQueue(handle='$object:handle')">-->
        <if cond="not ${object:handleIsRemote} and $request:inCutQueue(handle='$object:handle')">
          <if cond="${object:is_type_of(classname='URL')} and ${object:getDisplayInNewWindow}">
            <define id="u1"><a target="_blank" href="$request:html:url_escape(astring=${t})"><span class="summarytext"><insert ref="object:getTitle"/></span></a></define>
            <insert ref="request:xss_safe_value(value=$u1)" />
          <else>
              <define id="u2"><a href="$request:html:url_escape(astring=${t})"><span class="summarytext"><insert ref="object:getTitle"/></span></a></define>
            <insert ref="request:xss_safe_value(value=$u2)" />
          </else>
          </if>
        <else>

          <if cond="${object:is_type_of(classname='URL')}">

            <define id="url_targettype"><if cond="${object:is_type_of(classname='URL')} and ${object:getDisplayInNewWindow} == 'true'">_blank<else>_top</else></if></define>
            <define id="u3"><a target="${local:url_targettype}" href="$request:html:escape_cdata(astring=${t})"><b property="dc:title"><insert ref="object:getTitle"/></b></a></define>
            <insert ref="request:xss_safe_value(value=$u3)" />

            <define id="splitscreen_onclick_script">
              window.open('<insert ref="local:cgi"/>ImageStoreViewer/<insert ref="object:handle"/>','mywindow','width=1200,height=650,left=400,top=0,resizable=yes,scrollbars=yes')
            </define>

          <elif cond="not ${object:handleIsRemote} and not ${object:isFromExternalServer} and ${object:is_type_of(classname='Document')} and ${request:is_licensed(key='file_cabinet_replacement')} and not ${object:is_interact}">
            <!-- if FCR Site and a document or custom document class object... -->
              <if cond="${object:canDo(feature='com.xerox.docushare.viewSplitScreen')}">

                <!-- Document mime-types that can be viewed in all supported browsers -->
                <if cond="${object:content_type:get} in [
                          'image/gif',
                          'image/jpeg',
                          'image/png',
                          'text/plain',
                          'text/html',
                          'text/xml',
                          'image/tif',
                          'image/tiff',
                          'image/bmp',
                          'application/pdf',
                          'application/vnd.fujixerox.docuworks',
                          'application/vnd.fujixerox.docuworks.binder',
                          'application/vnd.fujixerox.docuworks.container']" >

                  <define id="u4"><insert ref="object:getTitle"/></define>
                  <a href="$request:html:url_escape(astring=${t})" >
                    <strong property="dc:title"><insert ref="request:xss_safe_value(value=$u4)" /></strong>
                  </a>&nbsp;&nbsp;
                  <a href="$request:html:url_escape(astring=${t})" onclick="${local:splitscreen_onclick_script};return false;" title="${viewdef:dslibMessages:fcr_openwindowhovertext}">
                    <i class="icon icon-newwindow"><insert ref="viewdef:dslib:nbsp"/></i>
                  </a>

                <!-- Document mime types that can be viewed only in I.E.

                // Doesn't work in any OS other than XP without a registry hack!!
                // Commenting out this feature from DS.

                <elif cond="${object:content_type:get} in [
                          'application/msword',
                          'application/vnd.ms-powerpoint',
                          'application/vnd.ms-excel',
                          'application/vnd.ms-word.document.macroEnabled.12',
                          'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                          'application/vnd.ms-word.template.macroEnabled.12',
                          'application/vnd.openxmlformats-officedocument.wordprocessingml.template',
                          'application/vnd.ms-powerpoint.template.macroEnabled.12',
                          'application/vnd.openxmlformats-officedocument.presentationml.template',
                          'application/vnd.ms-powerpoint.addin.macroEnabled.12',
                          'application/vnd.ms-powerpoint.slideshow.macroEnabled.12',
                          'application/vnd.openxmlformats-officedocument.presentationml.template',
                          'application/vnd.ms-powerpoint.addin.macroEnabled.12',
                          'application/vnd.ms-powerpoint.slideshow.macroEnabled.12',
                          'application/vnd.openxmlformats-officedocument.presentationml.slideshow',
                          'application/vnd.ms-powerpoint.presentation.macroEnabled.12',
                          'application/vnd.openxmlformats-officedocument.presentationml.presentation',
                          'application/vnd.ms-excel.addin.macroEnabled.12',
                          'application/vnd.ms-excel.sheet.binary.macroEnabled.12',
                          'application/vnd.ms-excel.sheet.macroEnabled.12',
                          'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
                          'application/vnd.ms-excel.template.macroEnabled.12',
                          'application/vnd.openxmlformats-officedocument.spreadsheetml.template'] and ${request:IE}">
                  <define id="u5"><insert ref="object:getTitle"/></define>
                  <a href="$request:html:url_escape(astring=${t})"  onclick="${local:splitscreen_onclick_script};return false;">
                    <strong property="dc:title"><insert ref="request:xss_safe_value(value=$u5)" /></strong>
                    <span class="openwindowicon" title="${viewdef:dslibMessages:fcr_openwindowhovertext}"><insert ref="viewdef:dslib:nbsp"/></span>
                  </a>
                </elif>-->

                <!-- Document mime types that cannot be viewed in a browser -->
                <else>
                  <define id="u6"><a href="$request:html:url_escape(astring=${t})"><b property="dc:title"><insert ref="object:getTitle"/></b></a></define>
                  <insert ref="request:xss_safe_value(value=$u6)" />
                </else>
                </if>

              <else>
                <define id="u7"><a href="$request:html:url_escape(astring=${t})"><b property="dc:title"><insert ref="object:getTitle"/></b></a></define>
                <insert ref="request:xss_safe_value(value=$u7)" />
              </else>
              </if>
          </elif>
          <elif cond="${object:is_type_of( classname='WikiPage' )}">
              <define id="u8"><a href="${t}"><b property="dc:title"><insert ref="object:getTitle"/></b></a></define>
              <insert ref="request:xss_safe_value(value=$u8)" />
          </elif>
          <else>
              <define id="u8"><a href="$request:html:url_escape(astring=${t})" class="uline" ><b property="dc:title"><insert ref="object:getTitle"/></b></a></define>
              <insert ref="request:xss_safe_value(value=$u8)" />
          </else>

          </if>
        </else>
        </if>
      </else>
      </if>

      <if cond="$object:is_new">
        <span class="new-item" title="${viewdef:dslibMessages:new}"><insert ref="viewdef:dslibMessages:new"/></span>
      </if>
<!-- Begin RKent modification 2018-09-07 -->
      <if cond="not ${object:is_type_of( classname='Bulletin' )}">
        <if cond="${object:summary:gets}!=''">
            <if cond="${object:is_type_of( classname='Document' )} and ${object:DCN:gets}!=''">
		<p property="dc:description">
                    <insert ref="request:xss_safe_value(value=$object:DCN)" /><br/>
		    <insert ref="request:xss_safe_value(value=$object:summary)"/>
		</p>
	        <else>
		    <p property="dc:description">
			<insert ref="request:xss_safe_value(value=$object:summary)"/>
		    </p>
		</else>
            </if>
	    <else>
                <if cond="${object:is_type_of( classname='Document' )} and ${object:DCN:gets}!=''">
		    <p property="dc:description">
			<insert ref="request:xss_safe_value(value=$object:DCN)" />
		    </p>
		</if>
	    </else>
        </if>
<!-- End RKent modification 2018-09-07 -->
        <else>
          <if cond="${object:get_description}!=''">
              <p property="dc:description">
                <insert ref="request:xss_safe_value(value=$request:html:escape(astring='${object:get_description}'))"/>
              </p>
          </if>
        </else>
      </if>
      <if cond="${appears_in}=='yes'">
        <if cond="${object:num_parents}!=0">

          <p style="padding-top:3px;">
            <if cond="not ${object:isFromExternalServer}">
              <strong><insert ref="viewdef:dslibMessages:appearsIn" /></strong>
              <else>
                <strong><insert ref="viewdef:dslibMessages:appearedIn" /></strong>
              </else>
            </if>

            <iter ref="object:parents">
              <a rel="up" href="${:get_url}"><insert ref=":title"/></a>
              <if cond="$:_last!=1">,&nbsp;</if>
            </iter>
          </p>
        </if>
      </if>
      <!-- ${abstract}=='yes' means the user wants to display snippets (Snippets replace Abstracts).-->
      <if cond="${abstract}=='yes' and ${object:is_type_of( classname='Document' )}">
        <!--<if cond="${object:abstract:gets}!=''">-->
        <if cond="${object:getSnippet}!=''">
          <if cond="${viewdef:dslib:runjs}=='Yes'">
            <!-- show/hide details; selector in toolbar_multi -->
            <!-- Uncomment this line and comment out the next if you want the abstract details hidden when the page is first displayed. -->
            <!--<div style="display: none;" id="abstracttext">-->
            <div style="display: ;" id="abstracttext">
              <p><strong><insert ref="viewdef:dslibMessages:contentSnippet" /></strong></p>
              <p><insert ref="request:xss_safe_value(value=$object:getSnippet)"/></p>
            </div>
            <else>
              <div>
                <p><strong><insert ref="viewdef:dslibMessages:contentSnippet" /></strong></p>
              <p><insert ref="request:xss_safe_value(value=$object:getSnippet)"/></p></div>
            </else>
          </if>

        </if>
        <elif cond="${abstract}=='yes' and ${object:is_type_of( classname='Subscription' )}">
          <div style="display: ;" id="abstracttext">
            <p><strong><insert ref="viewdef:dslibMessages:subscriptionDetails" /></strong></p>
            <div style="margin-left:5px;padding:3px;background:#fff;border:1px solid #f3f3f3;">
              <p><strong><insert ref="viewdef:dslibMessages:publisher" /></strong><if cond ="${object:canViewPublisher}=='true'"><a href="${object:publisher:get_url}" class="fieldvalue"><insert ref="object:publisher:title"/></a></if><br/>
              <strong><insert ref="viewdef:dslibMessages:event" /></strong><insert ref="object:events"/><br />
              <strong><insert ref="viewdef:dslibMessages:recipients" /></strong>
              <insert ref="request:set_request_var(varname='is_first',varval=1)"/>
              <iter ref="object:recipients">
                <insert ref="request:set_request_var(varname='is_first',varval=0)"/>

                <a href="${:get_url}" class="fieldvalue"><insert ref=":getTitle"/></a>

                <if cond="$:_last!=1">,</if>
              </iter>
              </p>
            </div>
          </div>
        </elif>
      </if>
    </td>
  </define> <!-- end of set_title -->

  <define id="summarize_mailmessagethread">
    <tr id="row${object:_sequence}">

      <!-- Checkbox -->
      <if cond="${caller}!='mailmessagethread'">
        <!--<if cond="${request:isLocalSite}=='true' and ${ref}!='portlet'">-->
        <if cond="not ${object:handleIsRemote} and ${ref}!='portlet'">
          <insert ref="local:set_checkbox(object=${object})"/>
        </if>
      </if>
      <!-- ICON -->
      <td class="icon">
        <if cond="not ${object:isFromExternalServer} and ${object:is_type_of( classname='MailMessage' )}">
          <a href="${object:get_url}/${request:handle}">
            <img rel="icon" src='${request:config:abs_path}images/${object:icon}?v=${request:config:short_version}' border='0' alt='$object:view_classname' title='$object:view_classname' />
          </a>
          <else>
            <a href="${request:html:url_escape(astring=$object:get_url)}">
              <img rel="icon" src='${request:config:abs_path}images/${object:icon}?v=${request:config:short_version}' border='0' alt='$object:view_classname' title='$object:view_classname' />
            </a>
          </else>
        </if>
        <if cond="$object:is_type_of( classname='Document' )">
          <if cond="not ${object:isFromExternalServer}">
            <if cond="$object:allow_versions"><!-- if document is locked -->
              <if cond="${locked_by}=='yes' and $object:is_locked">
                <a href="${request:html:url_escape(astring=$object:get_url)}" class="lock-sign">
                  <img role="status" class="lockicon" src='${request:theme_url}images/lock.png' border='0' alt='${viewdef:dslibMessages:currentlyLockedBy(lockedBy=$object:locked_by:getShortName)}' title='${viewdef:dslibMessages:currentlyLockedBy(lockedBy=$object:locked_by:getShortName)}' />
                </a>
              </if>
            </if>
          </if>
        </if>
        <if cond="$object:is_type_of( classname='Document' ) or $object:is_type_of( classname='MailMessage' )">
          <if cond="not ${object:isFromExternalServer}">
            <if cond="${object:isRecord} == 'true' and ${request:is_licensed( key='records_management' )}"> <!-- if document is a declared record -->
              <a href="${object:cgi}ServicesLib/${object:handle}/Classification"><img src='${request:config:abs_path}images/record_declared.gif' class="recordicon" border='0' alt='${viewdef:dslibMessages:declaredRecord}' title='${viewdef:dslibMessages:declaredRecord}'/></a>
            </if>
          </if>
        </if>
      </td>

      <!-- Subject -->
      <td class="name">
        <!--<if cond="${request:isLocalSite}=='true' and $request:inCutQueue(handle='$object:handle')">-->
        <if cond="not ${object:handleIsRemote} and not ${object:isFromExternalServer} and $request:inCutQueue(handle='$object:handle')">
          <!-- The next object is has been cut and should be painted as a light grey to let people know -->
          <a  href="${request:html:url_escape(astring=$object:get_url(record='check'))}"><insert ref="object:getTitle" /></a>
          <else>
            <a  href="${request:html:url_escape(astring=$object:get_url(record='check'))}"><strong><insert ref="object:getTitle" /></strong></a>
          </else>
        </if>
        <if cond="$object:is_new">
          <span class="new-item" title="${viewdef:dslibMessages:new}"><insert ref="viewdef:dslibMessages:new"/></span>
        </if>
        <if cond="not ${object:is_type_of( classname='Bulletin' )}">
          <if cond="${object:summary:gets}!=''">
            <p property="dc:description"><insert ref="object:summary" /></p>
          </if>
          <else>
            <if cond="${object:get_description}!=''">
              <p property="dc:description"><insert ref="request:html:escape(astring='${object:get_description}')" /></p>
            </if>
          </else>
        </if>
        <if cond="${appears_in}=='yes'">
          <if cond="${object:num_parents}!=0">
            <if cond="not ${object:isFromExternalServer}">
              <p><em><insert ref="viewdef:dslibMessages:appearsIn" /></em></p>
              <else>
                <p><em><insert ref="viewdef:dslibMessages:appearedIn" /></em></p>
              </else>
            </if>
            <p>
              <iter ref="object:parents">
                <a rel="up" href="${:get_url}"><insert ref=":title" /></a>
                <if cond="$:_last!=1">, &nbsp;</if>
              </iter>
            </p>
          </if>
        </if>
        <!-- ${abstract}=='yes' means the user wants to display snippets (Snippets replace Abstracts).-->
        <if cond="${abstract}=='yes' and ${object:is_type_of( classname='Document' )}">
          <!--<if cond="${object:abstract:gets}!=''">-->
          <if cond="${object:getSnippet}!=''">
            <if cond="${viewdef:dslib:runjs}=='Yes'">
              <!-- show/hide details; selector in toolbar_multi -->
              <!-- Uncomment this line and comment out the next if you want the abstract details hidden when the page is first displayed. -->
              <!--<div style="display: none;" id="abstracttext">-->
              <div style="display: ;" id="abstracttext">

                <p><insert ref="request:xss_safe_value(value=$object:getSnippet)" /></p>
                <!--<insert ref="object:abstract"/>-->
              </div>
              <else>
                <div>
                  <p><insert ref="request:xss_safe_value(value=$object:getSnippet)" /></p>
                </div>
                <!--<insert ref="object:abstract"/>-->
              </else>
            </if>

          </if>
          <elif cond="${abstract}=='yes' and ${object:is_type_of( classname='Subscription' )}">
            <insert ref="viewdef:dslib:br" />
            <span class="fieldvalue">
              <em>Publisher:</em>
            </span>
            <if cond="not ${object:isFromExternalServer}">
              <a href="${object:publisher:get_url}" class="fieldvalue">
                <insert ref="object:publisher:title" />
              </a>
              <else>
                <insert ref="object:publisher:title" />
              </else>
            </if>
            <insert ref="viewdef:dslib:br" />
            <span class="fieldvalue">
              <em>Events:</em>
            </span>
            <insert ref="object:events" />
            <br />
            <span class="fieldvalue">
              <em>Recipients:</em>
            </span>
            <insert ref="request:set_request_var(varname='is_first',varval=1)" />
            <iter ref="object:recipients">
              <insert ref="request:set_request_var(varname='is_first',varval=0)" />

              <if cond="not ${object:isFromExternalServer}">
                <a href="${:get_url}" class="fieldvalue">
                  <insert ref=":title" />
                </a>
                <else>
                  <insert ref=":title" />
                </else>
              </if>

              <if cond="$:_last!=1">,</if>
            </iter>
          </elif>
        </if>
      </td>

      <!-- Encrypted/Signed -->
      <td class="nospace">
        <if cond="${object:is_type_of( classname='MailMessage' )}">
          <if cond="${object:originally_signed}">
            <img src="${request:config:abs_path}images/small/redribbon.gif" width="13" height="18" title="${viewdef:dslibMessages:orginallySigned}" alt="${viewdef:dslibMessages:orginallySigned}" />
          </if>
          <if cond="${object:originally_encrypted}">
            <img src="${request:config:abs_path}images/small/bluelock.gif" width="13" height="18" title="${viewdef:dslibMessages:orginallyEncripted}" alt="${viewdef:dslibMessages:orginallyEncripted}" />
          </if>
        </if>
      </td>

      <!-- From -->
      <td>
        <if cond="${object:is_type_of( classname='MailMessage' )}">
          <insert ref="request:html:escape(astring=$object:from:gets)" />
        </if>
      </td>

      <!-- Owner -->
      <td class="generic">
        <if cond="${owner}!='no'">
          <if cond="${object:isFromExternalServer}">
            <insert ref="object:owner_obj:getShortName" />
            <else>
              <insert ref="viewdef:dslib:href_link_text(func='${viewdef:dslibMessages:clicktoViewProps}',handle='${object:owner_obj:handle}',url='${object:cgi}Services/${object:owner_obj:handle}', label='${object:owner_obj:getShortName}')" />
            </else>
          </if>
        </if>
      </td>

      <!-- Security Level -->
      <if cond="$request:config:enable_security_icon">
        <td class="nospace">
          <!--<if cond="not ${object:isFromExternalServer} and ${request:isLocalSite}=='true'">-->
          <if cond="not ${object:isFromExternalServer} and not ${object:handleIsRemote}">
            <if cond="$object:is_type_of(classname='User')=='false' and $object:is_type_of(classname='Group')=='false'">
              <if cond="$object:securityLevel=='1'">
                <a href="${object:cgi}ServicesLib/${object:handle}/Permissions">
                  <img src='${request:config:abs_path}images/small/access_user.png?v=${request:config:short_version}' width='20' height='20' border='0' alt='${viewdef:dslibMessages:individualAccess}' title='${viewdef:dslibMessages:individualAccess}' />
                </a>
                <elif cond="$object:securityLevel=='2'">
                  <a href="${object:cgi}ServicesLib/${object:handle}/Permissions">
                    <img src='${request:config:abs_path}images/small/access_group.png?v=${request:config:short_version}' width='20' height='20' border='0' alt='${viewdef:dslibMessages:groupAccess}' title='${viewdef:dslibMessages:groupAccess}' />
                  </a>
                </elif>
                <elif cond="$object:securityLevel=='3'">
                  <a href="${object:cgi}ServicesLib/${object:handle}/Permissions">
                    <img src='${request:config:abs_path}images/small/access_public.png?v=${request:config:short_version}' width='20' height='20' border='0' alt='${viewdef:dslibMessages:openAccess}' title='${viewdef:dslibMessages:openAccess}' />
                  </a>
                </elif>
              </if>
            </if>
            <else>
              <insert ref="viewdef:dslib:nbsp"/>
            </else>
          </if>
        </td>
      </if>

      <!-- Date -->
      <if cond="${abstract}=='yes'">
        <if cond="${object:is_type_of( classname='MailMessage' )}">
          <td class="largedate">
            <insert ref="object:date(type='received',format='short_time_date')" />
          </td>
          <else>
            <td class="largedate">
              <insert ref="object:date(type='modified',format='short_time_date')" />
            </td>
          </else>
        </if>
        <else>
          <if cond="${object:is_type_of( classname='MailMessage' )}">
            <td class="largedate">
              <insert ref="object:date(type='received',format='short')" />
            </td>
            <else>
              <td class="largedate">
                <insert ref="object:date(type='modified',format='short')" />
              </td>
            </else>
          </if>
        </else>
      </if>

      <!-- Size -->
      <td class="generic">
        <insert ref="object:size_string" />
        <if cond="${object:is_type_of( classname='MailMessage' )} and ${object:num_attachments} != '0'">
          <img src="${request:config:abs_path}images/small/paperclip.gif" border="0" />
        </if>
      </td>

      <insert ref="local:space_info"/>

      <!-- Services icon -->
      <if cond="not ${object:canSearchOnly}">
        <td class="actions">
          <!-- actions in the actionnav list are visible, icons in the list inside the last list item are in the more actions pop-up -->
          <if cond="${ref}=='portlet'">
            <insert ref="viewdef:uilib:SummarizeActionsMore(object=${object},ApplyChanges=1,Locks=1,AddVersions=1,Deletes=1,Favorites=1,NewClassification=1)" />
            <else>
              <insert ref="viewdef:uilib:SummarizeActionsPart1(object=${object},ApplyChanges=1,Locks=1,AddVersions=1,Deletes=1,Favorites=1,NewClassification=1)" />
            </else>
          </if>
        </td>
      </if>
    </tr>
  </define>

  <define id="summarize_subscription">
    <tr>
      <td>
        <if cond="not ${object:isFromExternalServer}">
          <a href="$object:get_url" class="fieldvalue">
            <insert ref="request:img(src='images/${object:icon}?v=${request:config:short_version}', width='30', height='30', border='0', alt='$object:view_classname', title='$object:view_classname')" />
          </a>
          <else>
            <insert ref="request:img(src='images/${object:icon}?v=${request:config:short_version}', width='30', height='30', border='0', alt='$object:view_classname', title='$object:view_classname')" />
          </else>
        </if>
      </td>
      <td class="name">
        <if cond="not ${object:isFromExternalServer}">
          <a href="$object:get_url"><strong><insert ref="object:title" /></strong></a>
          <else>
            <strong><insert ref="object:title" /></strong>
          </else>
        </if>
        <if cond="$object:is_new">
          <span class="new-item" title="${viewdef:dslibMessages:new}"><insert ref="viewdef:dslibMessages:new"/></span>
        </if>
        <if cond="${object:summary:gets}!=''">
          <p><insert ref="object:summary" /></p>
        </if>

        <p><strong><insert ref="viewdef:dslibMessages:publisher" /></strong> <if cond="not ${object:isFromExternalServer}"><a href="$request:html:url_escape(astring='${object:publisher:get_url}')" class="fieldvalue"><insert ref="object:publisher:title" /></a><else><insert ref="object:publisher:title" /></else></if></p>
        <p><strong><insert ref="viewdef:dslibMessages:events" /></strong> <insert ref="object:events" /></p>
        <p><strong><insert ref="viewdef:dslibMessages:recipients" /></strong>
        <insert ref="request:set_request_var(varname='is_first',varval=1)" />
        <iter ref="object:recipients">
          <insert ref="request:set_request_var(varname='is_first',varval=0)" />
          <if cond="not ${object:isFromExternalServer}">
            <a href="${:get_url}" class="fieldvalue">
              <if cond="${:is_type_of(classname='User')}">
                <insert ref=":getPersonalName" />
                <else>
                  <insert ref=":title" />
                </else>
              </if>
            </a>
            <else>
              <if cond="${:is_type_of(classname='User')}">
                <insert ref=":getPersonalName" />
                <else>
                  <insert ref=":title" />
                </else>
              </if>
            </else>
          </if>
          <if cond="$:_last!=1">,</if>
        </iter>
        </p>
      </td>
      <td>
        <a href="${object:cgi}ViewProps/${object:owner_obj:handle}" class="fieldvalue">
          <insert ref="object:owner_obj:getShortName" />
        </a>
      </td>
      <td>
        <insert ref="object:date(type='modified',format='short')" />
      </td>
      <td>
        <if cond="not ${object:isFromExternalServer}">
          <insert ref="viewdef:uilib:SummarizeActionsMore(object=$object)"/>
          <else>
            <a href="${object:cgi}dsarchive/Services/$object:handle" target="${window_target}">
              <img src="${request:config:abs_path}images/action_properties.gif" border="0" alt="${viewdef:dslibMessages:properties}" title="${viewdef:dslibMessages:properties}" />
            </a>
          </else>
        </if>
      </td>
    </tr>
  </define>
  <define id="breadcrumbs">
    <!-- EA: added condition portalType == 'sharepointWP' -->
    <if cond="${request:get_cmd_arg(argname='portalStyle')}!='naked' or ${request:get_cmd_arg(argname='portalType')}=='sharepointWP'">
      <!-- for 2.2 style appears in, uncomment the first line and comment out the second -->
      <!-- for 3.0 style breadcrumbs, comment the first line and uncomment the second -->
      <!--<insert ref="viewdef:dslib:appears(handle=${handle})"/>-->

      <if cond="$request:has_spaces and not $request:within_space and $request:user_obj:isSpaceMember">
        <insert ref="local:space_navigator" />
      </if>

      <div class="breadcrumbs">
        <if cond="$request:has_spaces ">
          <if cond="$request:within_space">
            <insert ref="viewdef:dslib:parentage(handle=${handle}, label=${label}, current=${current})"/>
            <else>
              <if cond="$request:user_obj:isSpaceMember">
                <!--<if cond="$request:category != 'HomePage'">-->
                  <ul class="breadcrumbs__list">
                    <li><span><insert ref="viewdef:dslib:parentage(handle=${handle}, label=${label}, current=${current})"/></span></li>
                 </ul>
                 <!-- <else>
                    <insert ref="viewdef:dslib:parentage(handle=${handle}, label=${label}, current=${current})"/>
                  </else>
                </if>-->
                <else>
                  <insert ref="viewdef:dslib:parentage(handle=${handle}, label=${label}, current=${current})"/>
                </else>
              </if>
            </else>
          </if>
          <else>
            <insert ref="viewdef:dslib:parentage(handle=${handle}, label=${label}, current=${current})"/>
          </else>
        </if>
      </div>


      <div id="contents_anchor">
        <table width="0" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="0"><a name="contents"><img src="${request:config:abs_path}images/small/spacesep.gif" border="0" height="1" width="1"/></a></td>
          </tr>
        </table>
      </div>
    </if>
    <!-- EA: end condition portalStyle != 'naked' or portalType == 'sharepointWP' -->

  </define>

  <define id="space_bar">
    <if cond="$request:has_spaces ">
      <if cond="$request:within_space">
        <div id="space_subheader">
            <h1><insert ref="request:space_title_truncated" /></h1>
            <!--  <if cond="$showEdit == 'true' and $request:can_manage(handle='$request:space_handle')"> -->
            <if cond="$request:space_member and $request:can_manage(handle='$request:space_handle')">
              <a id="space_editlink" href="${request:config:dsweb_home}Services/${request:space_handle}" title="${viewdef:dslibMessages:spaceprops}"><span class="icon icon-properties"> </span></a>
            </if>
            <insert ref="local:space_navigator" />
          </div>
      </if>
    </if>
  </define>

  <!--  Add space navigator -->
  <!-- only call this after checking $request:has_spaces -->
  <define id="space_navigator">
    <define id="redirectTo"><if cond="$request:category == 'MyHomePage'">MyHomePage<elif cond="$request:category == 'HomePage'">HomePage</elif><!--<elif cond="$request:config:enable_home_page_on_login">MyHomePage</elif>--><else>HomePage</else></if></define>
    <define id="siteLabel"><if cond="$local:redirectTo == 'HomePage'"><insert ref="viewdef:dslibMessages:siteGoToHome" /><else><insert ref="viewdef:dslibMessages:siteGoToMyDocuShare" /></else></if></define>
    <!-- <define id="spaceLabel"><if cond="$local:redirectTo == 'HomePage'"><insert ref="viewdef:dslibMessages:spaceGoToHome(title='$spaceTitle')" /><else><insert ref="viewdef:dslibMessages:spaceGoToMyDocuShare(title='$spaceTitle')" /></else></if></define> -->
    <define id="spaceLabel"><if cond="$local:redirectTo == 'HomePage'"><insert ref="viewdef:dslibMessages:spaceGoToHome(title='$spaceTitle')" /><else><insert ref="spaceTitle" /></else></if></define>
    <div id="space_navigator">
        <form name="SpaceNav" method="post" action="${local:cgi}ApplySpace">
          <fieldset>
            <label><insert ref="viewdef:dslibMessages:spaceLabel" /></label>
            <input type="hidden" name="redirectTo" value="$local:redirectTo" />
            <select name="space_nav" size="1" class="selectbox" onchange="this.form.go_space_nav.click()">
              <if cond="$request:within_space">
                <option value=""><!--<insert ref="local:siteLabel" />--><insert ref="viewdef:dslibMessages:defaultSpace" /></option>
                <else>
                  <option value="" selected="selected"><!-- <insert ref="local:siteLabel" /> --><insert ref="viewdef:dslibMessages:defaultSpace" /></option>
                </else>
              </if>
              <iter ref="request:user_obj:getSpaces">
                <if cond="${request:same_space(space='$:spaceName')}">
                  <option value="$:spaceName" selected="selected"><insert ref=":getTitleTruncated"/></option>
                  <else>
                    <option value="$:spaceName"><insert ref=":getTitleTruncated"/></option>
                  </else>
                </if>
              </iter>
            </select>
            <input type="submit" name="go_space_nav" value="${viewdef:dslibMessages:go}" class="bs"/>
          </fieldset>
        </form>
      </div>
  </define>

    <define id="parentage">
    <if cond="${request:initBreadcrumbs(handle=${request:handle}, label=${label}, current=${current})}!='error'">
      <table class="breadcrumbs__list">
        <insert ref="request:getPreferredBreadcrumbPath(handle=${request:handle}, label=${label}, current=${current})"/>
      </table>
      <if cond="${viewdef:dslib:runjs}=='Yes'">
        <if cond="not ${request:isBreadcrumbListEmpty}">
          <div class="breadcrumbs__toggle" id="bcExpand" title="${viewdef:dslibMessages:showAltBreadcrumbs}" onclick="showHideBC(this.id); return(false);"><i class="icon-arrdown">&nbsp;</i></div>
          <div class="breadcrumbs__toggle is-active" id="bcCollapse" style="display:none"  title="${viewdef:dslibMessages:hideAltBreadcrumbs}" onclick="showHideBC(this.id); return(false);"><i class="icon-arrdown">&nbsp;</i></div>
          <div style="display: none;" id="bcAdditional" class="breadcrumbs__more">
            <table class="breadcrumbs__list">
              <insert ref="request:breadcrumbs(handle=${request:handle}, label=${label}, current=${current})"/>
            </table>
          </div>
        </if>
        <else>
          <table class="breadcrumbs__list">
            <insert ref="request:breadcrumbs(handle=${request:handle}, label=${label}, current=${current})"/>
          </table>

        </else>
      </if>
    </if>
  </define>

  <define id="appears">
    <if cond="${handle} != 'Site'">
      <iter ref="request:get_object(handle=${handle}):parents">
        <a href="$:get_url" class="fieldvalue"><insert ref=":title"/></a>
        <if cond="$:_last!=1">,&nbsp;</if>
      </iter>
      <else>
        <a href="/" class="fieldvalue"><insert ref="viewdef:dslibMessages:home" /></a>
      </else>
    </if>
  </define>

  <define id="appears_no_table">
    <tr>
      <if cond="${request:object:isFromExternalServer}">
        <td align="right" valign="top" class="fieldname"><insert ref="viewdef:dslib:PropHelp(name='former_parents')"/></td>
        <else>
          <td align="right" valign="top" class="fieldname"><insert ref="viewdef:dslib:PropHelp(name='parents')"/></td>
        </else>
      </if>
      <td>
        <iter ref="request:object:parents">
          <a href="${request:html:url_escape(astring=$:get_url)}" class="fieldvalue">
          <insert ref=":title"/></a>
          <if cond="$:_last!=1">,&nbsp;
          </if>
        </iter>
      </td>
    </tr>
  </define>

  <!-- Arguments are 'name' (link name; e.g. associatedCollection) and a boolean named, 'source'.
       'Source' indicates whether the current object is the source or dest end of the link (set to 'true' if
       the object is the source end and 'false' if it is the destination end). -->
  <define id="link_no_table">
    <define id="src"><if cond="$source=='true'">source<else>dest</else></if></define>
    <define id="link_label">link.<insert ref='local:src'/>.<insert ref='name'/></define>
    <tr>
      <td align="right" valign="top" class="fieldname"><insert ref="viewdef:dslib:PropHelp(name='$link_label')"/></td>
      <td>
        <iter ref="request:object:getLinkedObjects(name='$name', source='$source')">
          <a href="$:get_url(record='check')" class="fieldvalue">
          <insert ref=":title"/></a>
          <if cond="$:_last!=1">,&nbsp;
          </if>
        </iter>
      </td>
    </tr>
  </define>

  <define id="preferred_version_no_table">
    <if cond="$request:object:is_readable_content">
      <tr>
        <td align="right" valign="top" class="fieldname"><insert ref="viewdef:dslib:PropHelp(name='preferred_version')"/></td>
        <td>
          <if cond="${request:object:preferred_version_title} != ''">
            <with ref="request:object:preferred_version">
              <a href="${request:html:url_escape(astring=$:get_url)}" class="fieldvalue"><insert ref=":title"/></a>
            </with>
          </if>
        </td>
      </tr>
    </if>
  </define>

  <define id="num_attachments_no_table">
    <tr>
      <td align="right" valign="top" class="fieldname"><insert ref="viewdef:dslib:PropHelp(name='attachment')"/></td>
      <td>
        <insert ref="request:object:num_attachments"/>
      </td>
    </tr>
  </define>


  <define id="owner_no_table">
    <tr>
      <td align="right" valign="top" class="fieldname"><insert ref="viewdef:dslib:PropHelp(name='owner')"/></td>
      <td class="fieldvalue">

        <if cond="${request:object:isFromExternalServer}">
          <insert ref="request:object:owner_obj:getFullName"/>
          <else>
            <with ref="request:object:owner_obj">
              <a href="$:get_url" class="fieldvalue"><insert ref=":getFullName"/></a>
            </with>
          </else>
        </if>

      </td>
    </tr>
  </define>

  <!-- This is a hack to use a static xf:output so that the CSS styling that applies to properties will apply here -->
  <define id="owner_xforms">
    <!-- TODO: We cannot put hyperlinks on the value and have a label both -->
    <xf:output xmlns:xf="http://www.w3.org/2002/xforms" ref="instance('ViewAuxillaryInstance')/ownerFullName">
      <xf:label><insert ref="viewdef:dslib:PropHelp(name='owner')"/></xf:label>
    </xf:output>
  </define>


  <define id="initial_permissions_no_table">
    <tr>
      <td align="right" valign="top" class="fieldname"><insert ref="viewdef:dslib:PropHelp(name='initial_permissions')"/></td>
      <td>
        <input type="radio" name="inherit" value="yes" checked="checked" tabindex="1" id="inherit_yes" /><label for="inherit_yes"><insert ref="viewdef:dslibMessages:sameAsContainer" /></label><br />
        <input type="radio" name="inherit" value="restrictWrite" tabindex="1" id="inherit_restrictWrite" /><label for="inherit_restrictWrite"><insert ref="viewdef:dslibMessages:sameAsContainerExcept" /></label><br />
        <input type="radio" name="inherit" value="owner" tabindex="1" id="inherit_owner" /><label for="inherit_owner"><insert ref="viewdef:dslibMessages:restrictedToOwner" /></label>
      </td>
    </tr>
  </define>


  <define id="initial_permissions_xforms">
    <xf:select1 class="inherit" ref="@inherit" xmlns:xf="http://www.w3.org/2002/xforms" navindex="1">
      <xf:label><insert ref="viewdef:dslib:PropHelp(name='initial_permissions')"/></xf:label>
      <xf:item>
        <xf:label class="fieldvalue"><insert ref="viewdef:dslibMessages:sameAsContainerExcept" /></xf:label>
        <xf:value>restrictWrite</xf:value>
      </xf:item>
      <xf:item>
        <xf:label class="fieldvalue"><insert ref="viewdef:dslibMessages:sameAsContainer" /></xf:label>
        <xf:value>yes</xf:value>
      </xf:item>
      <xf:item>
        <xf:label class="fieldvalue"><insert ref="viewdef:dslibMessages:restrictedToOwner" /></xf:label>
        <xf:value>owner</xf:value>
      </xf:item>
    </xf:select1>
  </define>


  <!-- ==========================================================
       handle_no_table

       Returns a TR element with object's handle.
       ========================================================== -->
  <define id="handle_no_table">
    <tr>
      <td align="right" valign="top" class="fieldname"><insert ref="viewdef:dslib:PropHelp(name='handle')"/></td>
      <td>
        <span class="fieldvalue"><insert ref="request:object:handle"/></span>
      </td>
    </tr>
  </define>

  <define id="handle_xforms">
    <xf:output xmlns:xf="http://www.w3.org/2002/xforms" ref="@handle">
      <xf:label><insert ref="viewdef:dslib:PropHelp(name='handle')"/></xf:label>
    </xf:output>
  </define>

  <define id="modified_by_no_table">
    <tr>
      <td align="right" valign="top" class="fieldname"><insert ref="viewdef:dslib:PropHelp(name='link.source.modifiedBy')"/></td>
      <td class="fieldvalue">
        <if cond="${request:object:modified_by:is_readable_properties}">
          <if cond="${request:object:isFromExternalServer}">
            <with ref="request:object:modified_by">
              <insert ref=":getFullName"/>
            </with>
            <else>
              <with ref="request:object:modified_by">
                <a href="$:get_url" class="fieldvalue"><insert ref=":getFullName"/></a>
              </with>
            </else>
          </if>
        </if>
      </td>
    </tr>
  </define>

  <!-- This is a hack to use a static xf:output so that the CSS styling that applies to properties will apply here -->
  <define id="modified_by_xforms">
    <if cond="${request:object:modified_by:is_readable_properties}">
      <!-- TODO: We cannot put hyperlinks on the value and have a label both -->
      <xf:output xmlns:xf="http://www.w3.org/2002/xforms" ref="instance('ViewAuxillaryInstance')/modifiedByFullName">
        <xf:label><insert ref="viewdef:dslib:PropHelp(name='link.source.modifiedBy')"/></xf:label>
      </xf:output>
    </if>
  </define>

  <define id="locked_by_no_table">
    <tr>
      <td align="right" valign="top" class="fieldname"><insert ref="viewdef:dslib:PropHelp(name='lock_File')"/></td>
      <td>

        <if cond="${request:object:is_locked}">
          <with ref="request:object:locked_by">
            <a href="$:get_url" class="fieldvalue"><insert ref=":getShortName"/></a>
          </with>
        </if>
      </td>
    </tr>
  </define>

  <!--  The no-break space entity reference from HTML. -->
  <define id="nbsp">&nbsp;</define>

  <!-- Keep for legacy support for third-parties who might be using it from dslib -->
  <define id="br">
    <br />
  </define>


  <!-- This footer element may be modified to customize your site
       but mustn't change the name.  Certain code expects there to
       be an element here called "footer".  If it isn't here it will
       revert to the default footer markup -->
  <define id="footer">
    <!-- EA: begin condition portalType != 'sharepointWP' -->
    <if cond="${request:get_cmd_arg(argname='portalType')}!='sharepointWP'">
      <!-- Admin Message -->
      <insert ref="local:messages_admin" />
    </if>
    <!-- EA: end condition portalType != 'sharepointWP' -->
    <script language="javascript" type="text/javascript" defer="defer">
    function checkCollKey(event)
    {
         if(event.key !== "Enter") return;
         document.querySelector("#TMT_find_collection_button").click();
         event.preventDefault(); // No need to `return false;`.
    }
    document.querySelector("#TMT_find_collection").addEventListener("keydown", checkCollKey);
    </script>
    <script language="javascript" type="text/javascript">
	function redirect(inpt)
	{
	    var collection_number = inpt.form.TMT_find_collection.value;
	    var search_value = inpt.form.value1.value;

	    if (collection_number.length > 0)
	    {
		if (collection_number.indexOf("-") > 0) /* looks like "Collection-123" or "Document-567" */
		{
		    inpt.form.action = "/docushare/dsweb/View/" + collection_number;
		}
		else if (collection_number.charAt(0) == 'c' || collection_number.charAt(0) == 'C')
		{
		   inpt.form.action = "/docushare/dsweb/View/Collection-" + collection_number.substring(1,collection_number.length);
		}
		else
		{
		    inpt.form.action = "/docushare/dsweb/View/Collection-"+collection_number;
		}
	        inpt.form.submit();
	    }
	    else if (search_value.length > 0)
	    {
		inpt.form.action = "/docushare/dsweb/ApplySimpleSearch";
	        inpt.form.submit();
	    }
	}
    </script>
  </define>

  <!-- This copyright element may be modified to customize your site
       but mustn't change the name.  Certain code expects there to
       be an element here called "copyright".  If it isn't here it will
       revert to the default copyright markup -->
  <define id="siteFooterMode"/>
  <define id="copyrightNoLine"><insert ref="copyright(siteFooterMode='noline')"/></define>
  <define id="siteFooterClass"><if cond="${siteFooterMode}=='noline'">siteFooter_noline<else>siteFooter_line</else></if></define>
  <define id="copyright">
    <!-- EA: begin condition portalType != 'sharepointWP' -->
    <if cond="${request:get_cmd_arg(argname='portalType')}!='sharepointWP'">

      <div id="${siteFooterClass}" class="footer">
        <div class="footer__pre">
          <div class="footersitelinks">
            <!-- THE ONE AND ONLY FOOTER LIST -->
            <if cond="${request:isValidUser}">
            <ul class="footer__column">
              
              <if cond="${request:directory:has_registry_access}=='true' or ${request:canDo(feature='com.xerox.docushare.createUser')} or ${request:canDo(feature='com.xerox.docushare.createGroup')}">
                <li><a href="${request:config:cmd_base}Registry" target="${viewdef:dslib:window_target}"><insert ref="viewdef:dslibMessages:usersGroups" /></a></li>
              </if>
              <if cond="${request:directory:is_base_admin_or_domain_content_admin}">
                <li><a href="${request:config:admin_home}" title="${viewdef:dslibMessages:clickToAdminUI}" target="${viewdef:dslib:window_target}"><insert ref="viewdef:dslibMessages:adminHome" /></a></li>
              </if>
            </ul>
            </if>
            <ul class="footer__column">
              <if cond="${request:is_licensed(key='file_cabinet_replacement')} and ${request:category}!='FCRHomePage'">
                 <li><a href="${request:config:cmd_base}QuickSearchHome" title="${viewdef:HomePageMessages:clickToQuickSearchGo}" target="${viewdef:dslib:window_target}"><insert ref="local:f_showSpaceName" /><insert ref="viewdef:HomePageMessages:quickSearchDSHome" /></a></li>
              </if>
              <if cond="${request:category}!='DocuShareHomePage'">
                <li><a href="${request:config:cmd_base}ClassicHome" title="${viewdef:HomePageMessages:clickToClassicGo}" target="${viewdef:dslib:window_target}"><insert ref="local:f_showSpaceName" /><insert ref="viewdef:HomePageMessages:classicDSHome" /></a></li>
              </if>
            </ul>

            <ul class="footer__column">
              
              <if cond="not ${request:directory:is_user_level(level='imageManager')}">
                <li><a href="${request:config:cmd_base}helpdesk"><insert ref="viewdef:dslibMessages:help" /></a></li>
              </if>
              <if cond="${request:canDo(feature='com.xerox.docushare.viewContentMap')}">
                <li><a href="${request:config:cmd_base}Index/${request:context}?init=true">
                  <insert ref="local:f_showSpaceName" />
                <if cond="${request:directory:is_user_level(level='imageManager')}"> 
                  <insert ref="viewdef:ImageStoreHomePageMessages:browse" />
                  <else>
                    <insert ref="viewdef:dslibMessages:contentMap" />
                  </else>
                </if>

                </a></li>
              </if>
            </ul>
            <ul class="footer__column">
              <if cond="${request:directory:is_user_level(level='imageManager')}">
                <li><a href="${request:config:abs_path}dsweb/About"><insert ref="viewdef:ImageStoreHomePageMessages:about" /></a></li>
                <else>
                  <li><a href="${request:config:abs_path}dsweb/About"><insert ref="viewdef:HomePageMessages:about" /></a></li>                  
                </else>
              </if>
              
              <li><a href="${request:config:abs_path}dsweb/Stats"><insert ref="viewdef:dslibMessages:siteStatistics" /></a></li>
              <if cond="${request:directory:is_base_admin_or_domain_content_admin}">
                <li><a href="${request:config:abs_path}dsweb/SiteServerStats"><insert ref="viewdef:dslibMessages:serverStatistics" /></a></li>
              </if>
            </ul>
            <ul class="footer__column">
              <!--MobileClient_INSERT-->
              <if cond="not ${request:company_brand}=='FX'">
                <define id="enable_mobile_client"><insert ref="request:includeJSP(jsp='..\..\mobileclient\CheckMobileClientEnable.jsp',my_var='my_value')"/></define>
                <if cond="$enable_mobile_client=='true'">
                  <li><a href="${request:config:abs_path}dsweb/MobileClientSettings"><insert ref="viewdef:MobileClientMessages:title" /></a></li>
                </if>
              </if>
              <!--MobileClient_INSERT-->
              <li><a href="${request:config:cmd_base}CookiesInfo"><insert ref="viewdef:dslibMessages:cookie_info_link_label" /></a></li>
              <!-- AR 32381 -->
              <define id="dsOnWebURL"><insert ref="request:vdfmgr:lookup(vdfName='dslibMessages', id='dsOnWebURL${request:company_brand}')" /></define>
              <define id="dsOnWeb"><insert ref="request:vdfmgr:lookup(vdfName='dslibMessages', id='dsOnWeb${request:company_brand}')" /></define>
              <li><a href="${local:dsOnWebURL}" target="_blank"><insert ref="local:dsOnWeb" /></a></li>
            </ul>
            <!-- THE ONE AND ONLY FOOTER LIST -->
          </div>
          <!-- end wrapper for one footer -->
        </div>
        <!-- end footer__pre -->



          <!-- If inside a space, show the space name before the personal link to reinforce to the user they are going to space version of that
               personal link -->
          <define id="f_showSpaceName">
            <if cond="$request:has_spaces and $request:within_space">
              <span class="footerspacename" title="${viewdef:dslibMessages:withinSpace}"><insert ref="viewdef:dslibMessages:space" /></span>
            </if>
          </define>

          <define id="showOnlyMyLinks">
            <if cond="${request:category}=='HomePage' and ${request:directory:is_user_level(level='imageManager')}">
              firstsection
            </if>
          </define>




      <if cond="${request:get_cmd_arg(argname='portalStyle')}!='naked'">
        <if cond="${request:company_brand}=='FX'"> <!-- AR 32646 -->
          <div id="subfooter" class="FXfooter__sub">
            <div id="subfooter_inner">
              <p rel="copyright" id="copyright_text"><insert ref="viewdef:dslibMessages:copyrightText" /></p>
              <if cond="${request:federated:isFederated}">
                <div id="fedbadge">
                  <a id="fedbadgelink" href="${request:config:cmd_base}AboutFederated" target="${viewdef:dslib:window_target}" title="${viewdef:dslibMessages:aboutThisFederation}"><insert ref="viewdef:dslibMessages:memberOfText(federationName=${request:federated:getFederationName})" /></a>
                </div>
              </if>
              <div class="FXfooterbranding">
                <define id="gotoFujiXerox"><insert ref="request:vdfmgr:lookup(vdfName='dslibMessages', id='gotoXeroxFX')" /></define>
                <define id="gotoFujiXeroxURL"><insert ref="request:vdfmgr:lookup(vdfName='dslibMessages', id='gotoXeroxUrlFX')" /></define>
                <a href="${local:gotoFujiXeroxURL}" title="${local:gotoFujiXerox}"><span>&shy;</span><insert ref="local:gotoFujiXerox"/></a>
              </div>
            </div>
          </div>
        <else>
        <div id="subfooter" class="footer__sub">
          <div id="subfooter_inner">
            <p rel="copyright" id="copyright_text"><insert ref="viewdef:dslibMessages:copyrightText" /></p>
            <if cond="${request:federated:isFederated}">
              <div id="fedbadge">
                <a id="fedbadgelink" href="${request:config:cmd_base}AboutFederated" target="${viewdef:dslib:window_target}" title="${viewdef:dslibMessages:aboutThisFederation}"><insert ref="viewdef:dslibMessages:memberOfText(federationName=${request:federated:getFederationName})" /></a>
              </div>
            </if>
            <div class="footerbranding">
              <define id="gotoXerox"><insert ref="request:vdfmgr:lookup(vdfName='dslibMessages', id='gotoXerox${request:company_brand}')" /></define>
              <define id="gotoXeroxURL"><insert ref="request:vdfmgr:lookup(vdfName='dslibMessages', id='gotoXeroxUrl${request:company_brand}')" /></define>
              <a href="${local:gotoXeroxURL}" title="${local:gotoXerox}"><span>&shy;</span><insert ref="local:gotoXerox"/></a>
            </div>
          </div>
        </div>
        </else>  
        </if>
      </if>
      </div>

      <define id="marketBrand"><insert ref="request:vdfmgr:lookup(vdfName='dslibMessages', id='market${request:company_brand}')" /></define>

 <!--      <define id="left"><insert ref="request:license_days_left"/></define>
      <if cond="${local:left}&lt;'1' and not ${request:is_licensed(key='evaluation_key')}">
        <div id="licensemessage">
          <div id="licensemessage_inner">
            <i class="icon icon-info">&nbsp;</i>
            <if cond="${request:directory:is_base_admin_user}">
              <if cond="${request:directory:is_admin}">
                <if cond="${request:is_licensed(key='image_store')}">
                  <insert ref="viewdef:dslibMessages:notActivatedTextIM(absPath=${request:config:abs_path}, brand=${local:marketBrand})" />
                  <else>
                    <insert ref="viewdef:dslibMessages:notActivatedText(absPath=${request:config:abs_path}, brand=${local:marketBrand})" />
                  </else>
                </if>
                <else>
                  <if cond="${request:is_licensed(key='image_store')}">
                    <insert ref="viewdef:dslibMessages:notActivatedTextIM2(mailToVar=${request:get_object(handle='Base-User-2'):email}, brand=${local:marketBrand})" />
                    <else>
                      <insert ref="viewdef:dslibMessages:notActivatedText2(mailToVar=${request:get_object(handle='Base-User-2'):email}, brand=${local:marketBrand})" />
                    </else>
                  </if>
                </else>
              </if>
              <else>
                <insert ref="viewdef:dslibMessages:notYetActivatedText" />
              </else>
            </if>
          </div>
        </div>
      </if>

      <if cond="${request:is_licensed(key='evaluation_key')}">
        <div id="licensemessage">
          <div id="licensemessage_inner">
            <i class="icon icon-info">&nbsp;</i>
            <strong><insert ref="viewdef:dslibMessages:limitedLicText1" /></strong><insert ref="local:br"/>
            <if cond="${local:left}&gt;'1'">
              <insert ref="viewdef:dslibMessages:limitedLicText2(timeLeft=${local:left})" />
              <elif cond="${local:left}=='1'">
                <insert ref="viewdef:dslibMessages:limitedLicText3" />
              </elif>
              <else>
                <insert ref="viewdef:dslibMessages:limitedLicText4" />
              </else>
            </if>
            <if cond="${request:directory:is_base_admin_user}">
              <insert ref="viewdef:dslibMessages:obtainLicense(brand=${local:marketBrand})" />
              <insert ref="local:br"/>
              <insert ref="viewdef:dslibMessages:obtainLicense2(mailToVar=${request:get_object(handle='Base-User-2'):email})" />
            </if>
          </div>
        </div>
      </if> -->


    </if>
    <!-- end condition portalType != 'sharepointWP' -->
  </define>

  <define id="sitelinks">
    <if cond="${request:get_cmd_arg(argname='portalStyle')}!='naked'">
      <ul>
        <if cond="${request:within_space}">
          <li class="first"><a href="${request:config:dsweb_home}Home"><strong><insert ref="viewdef:dslibMessages:sitehome" /></strong></a></li>
          <li><a href="${request:config:cmd_base}Home"><insert ref="local:f_showSpaceName" /><insert ref="viewdef:dslibMessages:home" /></a></li>
          <else>
            <li class="first"><a href="${request:config:dsweb_home}Home"><insert ref="viewdef:dslibMessages:home" /></a></li>
          </else>
        </if>
        <if cond="${request:canDo(feature='com.xerox.docushare.viewContentMap')}">
          <li><a href="${request:config:cmd_base}Index/${request:context}?init=true">
            <insert ref="local:f_showSpaceName" />
          <if cond="${request:directory:is_user_level(level='imageManager')}">
            <insert ref="viewdef:ImageStoreHomePageMessages:browse" />
            <else>
              <insert ref="viewdef:dslibMessages:contentMap" />
            </else>
          </if>
          </a></li>
        </if>
        <if cond="not ${request:directory:is_user_level(level='imageManager')}">
          <li><a href="${request:config:cmd_base}ApplyListNew/${request:context}?nresults=100"><insert ref="local:f_showSpaceName" /><insert ref="viewdef:dslibMessages:whatsNew" /></a></li>
        </if>

        <if cond="${request:directory:has_registry_access}=='true' or ${request:canDo(feature='com.xerox.docushare.createUser')} or ${request:canDo(feature='com.xerox.docushare.createGroup')}">
          <li><a href="${request:config:cmd_base}Registry"><insert ref="viewdef:dslibMessages:usersGroups" /></a></li>
        </if>

        <li><a href="${request:config:cmd_base}helpdesk"><insert ref="viewdef:dslibMessages:help" /></a></li>
      </ul>

      <else>
        <!-- EA: begin condition portalType != 'sharepointWP' -->
        <if cond="${request:get_cmd_arg(argname='portalType')}!='sharepointWP'">
          <ul role="navigation" id="accountlinks">
            <if cond="${request:isValidUser}">
              <li class="loginname"><a href="${request:config:cmd_base}Services/${request:user_obj:handle}" title="${viewdef:dslibMessages:clickViewProps} "><insert ref="request:user_obj:getShortName"/></a></li>
            </if>
            <if cond="not ${request:directory:is_logged_in_user} or not ${request:isValidUser}">
              <li><a href="${request:config:cmd_base}AuthorizationError?jsr168BookMarkHandle=${request:handle}" title="${viewdef:dslibMessages:clickViewProps} "><insert ref="viewdef:dslibMessages:login" /></a></li>
              <else>
                <li><a href="${request:config:cmd_base}JSR168Logout?portalAddress=${request:get_cmd_arg(argname='portalAddress')}" title="${viewdef:dslibMessages:clickToLogout}" target="_parent"><insert ref="viewdef:dslibMessages:logout" /></a></li>
              </else>
            </if>
            <li><a href="${request:config:cmd_base}helpdesk"><insert ref="viewdef:dslibMessages:help" /></a></li>
          </ul>
        </if>
        <!-- end condition portalType != 'sharepointWP' -->
      </else>
    </if>
  </define>


  <define id="href_link_text">
    <if cond="${request:user_obj:use_popup} == 'Yes'">
      <a  href="${url}" target="${handle}" title="${func}"><b><insert ref="label"/></b></a>
      <else>
        <a  href="$url" target="${window_target}" title="$func"><insert ref="label"/></a>
      </else>
    </if>
  </define>

  <define id="href_link_img">
    <if cond="${request:user_obj:use_popup} == 'Yes'">
      <a href="${url}" target="${handle}"><img width="18" height="18" border="${img_border}" alt="${img_alt}" title="${img_alt}" src="${img_src}"></img></a>
      <else>
        <a href="${url}" target="${window_target}"><img width="18" height="18" class="midalign" border="${img_border}" alt="${img_alt}" title="${img_alt}" src="${img_src}" /></a>
      </else>
    </if>
  </define>


  <!-- ==========================================================
       edit_prop(prop)
       Returns a TR element which represents a property editor.
       ========================================================== -->
  <define id="edit_prop">
    <tr>
      <td align="right"><insert ref="prop_label(prop=$prop)"/></td>
      <td align="left"><insert ref="edit_prop_raw(prop=$prop)"/></td>
    </tr>
  </define>

  <!-- ==========================================================
       edit_long_text_prop(prop)
       Returns a TR element which represents a property editor.
       ========================================================== -->
  <define id="edit_long_text_prop">
    <tr>
      <td align="right"><insert ref="prop_label(prop=$prop)"/></td>
      <td align="left"><textarea name="${prop:name}" wrap="soft" rows="12" cols="80" tabindex="1"><insert ref="request:html:escape_cdata(astring=$prop:gets)"/></textarea></td>
    </tr>
  </define>


  <!-- ==========================================================
       edit_password(title, name)

       Returns a TR element a editor for password.
       ========================================================== -->
  <define id="edit_password">
    <tr>
      <td align="right">
        <insert ref="viewdef:dslib:PropHelpPlusLabel(name='${name}', linklabel='${title}', class='fieldname labelHelpLink', colon='yes')"/>
        <br /><small><insert ref="viewdef:message:required"/></small>
      </td>
      <td valign="top" aling="left">
        <input name="$name" id="$name" type="password" required="required" tabindex="1"/>
      </td>
    </tr>
  </define>

  <!-- ==========================================================
       edit_domain(prop)

       Returns a TR element a editor for password.
       ========================================================== -->
  <define id="edit_domain">
    <if cond="${request:isDomainEnabled}">
      <tr>
        <td align="right"><insert ref="prop_label(prop=$prop)"/></td>
        <td valign="top" aling="left">
          <select size="1" name="${prop:name}" tabindex="1">
            <iter ref="request:internal_domain_list">
              <if cond="$prop:gets_raw=='$:'">
                <option value="$:" selected="selected"><insert ref=":"/></option>
                <else>
                  <option value="$:"><insert ref=":"/></option>
                </else>
              </if>
            </iter>
          </select>
        </td>
      </tr>
      <else>
        <input type="hidden" name="${prop:name}" value="DocuShare"/>
      </else>
    </if>
  </define>


  <!-- ==========================================================
       prop_label(prop)

       Returns elements
       ========================================================== -->
  <define id="prop_label">
    <!--<b><a class="fieldname" href="${cgi}PropHelp/$prop:fullname"><insert ref="prop:label"/>:</a></b>-->
    <strong><insert ref="viewdef:dslib:PropHelp(name='${prop:fullname}')"/></strong>
    <if cond="${prop:is_required}">
      <br /><small><insert ref="viewdef:message:required"/></small>
    </if>
  </define>


  <!-- ==========================================================
       edit_prop_raw(prop)

       Returns a control element to edit value of property.

       Parameters:
       prop -  the property.
       ========================================================== -->
  <define id="edit_prop_raw">
    <if cond="${prop:type} == 'Integer'">
      <if cond="${viewdef:dslib:runjs}=='Yes'">
        <insert ref="viewdef:javascript:enable_validate_integer_prop"/>
        <input name="${prop:name}" type="text" size="10" value="$prop:gets_escaped" onchange="$viewdef:javascript:validate_integer_prop(prop=$prop)" tabindex="1"/>
        <else>
          <input name="${prop:name}" type="text" size="10" value="$prop:gets_escaped" tabindex="1"/>
        </else>
      </if>
      <elif cond="${prop:type} == 'Float'">
        <if cond="${viewdef:dslib:runjs}=='Yes'">
          <insert ref="viewdef:javascript:enable_validate_float_prop"/>
          <input name="${prop:name}" type="text" size="10" value="$prop:gets_escaped" onchange="$viewdef:javascript:validate_float_prop(prop=$prop)" tabindex="1"/>
          <else>
            <input name="${prop:name}" type="text" size="10" value="$prop:gets_escaped" tabindex="1"/>\
          </else>
        </if>
      </elif>
      <elif cond="${prop:type} == 'Boolean'">
        <insert ref="boolean_control(prop=$prop)"/>
      </elif>
      <elif cond="${prop:type} == 'Date'">
        <insert ref="date_control(prop=$prop)"/>
      </elif>
      <elif cond="${prop:type} == 'Time'">
        <insert ref="time_control(prop=$prop)"/>
      </elif>
      <elif cond="${prop:type} == 'Text'       or ${prop:type} == 'Email'       or ${prop:type} == 'URL'">
        <input name="${prop:name}" type="text" size="60" value="$request:html:escape_cdata(astring=$prop:gets)" tabindex="1"/>
      </elif>


      <elif cond="${prop:type} == 'String'              and ${prop:is_multi_valued} == 'true'">
        <input name="${prop:name}" type="text" size="60" value="$request:html:escape_multivalued_cdata(astring=$prop:get)" tabindex="1"/>
      </elif>

      <elif cond="${prop:type} == 'String'              and ${prop:is_multi_valued} == 'false'">
        <if cond ="${prop:is_required}">
          <input name="${prop:name}" type="text" size="60" value="$request:html:escape_cdata(astring=$prop:gets)" required="required" tabindex="1"/>
        <else>
        <input name="${prop:name}" type="text" size="60" value="$request:html:escape_cdata(astring=$prop:gets)" tabindex="1"/>
        </else>
        </if>
      </elif>
      <elif cond="${prop:type} == 'Menu'">
        <insert ref="menu_control(prop=$prop)"/>
      </elif>
    </if>
  </define>

  <!-- ==========================================================
       boolean_control(prop)

       Returns an input element to edit boolean property.

       Parameters:
       prop - the property.
       It must support
       name, get, true_label, false_label
       ========================================================== -->
  <define id="boolean_control">
    <if cond="$prop:get">
      <input name="${prop:name}" type="radio" value="true" checked="checked" tabindex="1" id="${prop:name}_true" />
      <label for="${prop:name}_true"><insert ref="prop:true_label"/></label>

      <input name="${prop:name}" type="radio" value="false" tabindex="1" id="${prop:name}_false" />
      <label for="${prop:name}_false"><insert ref="prop:false_label"/></label>

      <else>
        <input name="${prop:name}" type="radio" value="true" tabindex="1" id="${prop:name}_true" />
        <label for="${prop:name}_true"><insert ref="prop:true_label"/></label>

        <input name="${prop:name}" type="radio" value="false" checked="checked" tabindex="1" id="${prop:name}_false" />
        <label for="${prop:name}_false"><insert ref="prop:false_label"/></label>
 
      </else>
    </if>
  </define>

  <!-- ==========================================================
       date_control(prop)

       Returns an input element to edit date property.

       Parameters:
       prop - the property.
       It must support
       name, year, month, day, hour, minute and seconds.
       ========================================================== -->
  <define id="date_control">
    <insert ref="edit_date(year=$prop:year,                            month=$prop:month,                            day=$prop:day,                            prefix='${prop:name}_')"/>
    &nbsp;
    <insert ref="select_number(name='${prop:name}_hour', start=0, end=24, default=$prop:hour)"/>:
    <insert ref="select_number(name='${prop:name}_minute', start=0, end=59, default=$prop:minute)"/>:
    <insert ref="select_number(name='${prop:name}_second', start=0, end=59, default=$prop:second)"/>
  </define>

  <!-- ==========================================================
       time_control(prop)

       Returns an input element to edit time property.

       Parameters:
       prop - the property.
       It must support
       name, hour, and minute.
       ========================================================== -->
  <define id="time_control">
    <insert ref="select_number(name='${prop:name}_hour', start=0, end=24, default=$prop:hour)"/>:
    <insert ref="select_number(name='${prop:name}_minute', start=0, end=59, default=$prop:minute)"/>:
  </define>

  <!-- ==========================================================
       menu_control(prop)

       Returns an input element to edit menu property.

       Parameters:
       prop -  the property.
       It must support
       name, is_muiti_valued, and menu_items.
       ========================================================== -->
  <define id="menu_control">
    <if cond="$prop:is_multi_valued">
      <select name="${prop:name}" multiple="multiple" size="6">
        <insert ref="menu_control_sub(prop=$prop)"/>
      </select>
      <else>
        <select name="${prop:name}">
          <insert ref="menu_control_sub(prop=$prop)"/>
        </select>
      </else>
    </if>
  </define>

  <define id="menu_control_sub">
    <iter ref="prop:menu_items">
      <if cond="$:selected">
        <option value="$:name" selected="selected">
          <insert ref=":label"/>
        </option>
        <else>
          <option value="$:name"><insert ref=":label"/></option>
        </else>
      </if>
    </iter>
  </define>


  <!-- ==========================================================
       select_from_list(list, name, defalut)

       Returns a select element to select an entry from the given list.
       The list must contains objects which supports the followning methods:

       name - the value of the entry.
       label - the label of the entry

       Parameters:
       list - a list to select
       name - the name of returned select element
       default - the name of entry selected by default
       ========================================================== -->
  <define id="select_from_list"><select name="$name">
    <iter ref="list"><if cond="${:name}==$default"><option value="$:name" selected="selected"><insert ref=":label"/></option><else><option value="$:name"><insert ref=":label"/></option></else></if>
  </iter></select>
  </define>

  <define id="select_from_list_js"><select name="$name" onchange="$script">
    <iter ref="list"><if cond="${:name}==$default"><option value="$:name" selected="selected"><insert ref=":label"/></option><else><option value="$:name"><insert ref=":label"/></option></else></if>
  </iter></select>
  </define>

  <!-- ==========================================================
       select_number(name, start, end, default)

       Returns a TR element which represents a editor for time.

       Parameters:
       default - the value of entry selected by default
       ========================================================== -->
  <define id="select_number"><select name="$name">
    <iter ref="request:utility:range(start=$start, end=$end)"><if cond="$default == $:"><option value="$:" selected="selected"><insert ref=":"/></option><else><option value="$:"><insert ref=":"/></option></else></if>
  </iter></select>
  </define>

  <!-- ==========================================================

       edit_time(time, prefix)

       Returns elements which represents a editor for time.
       ========================================================== -->

  <define id="to_string"><insert ref="arg"/></define>
  <define id="to_2char"><if cond="10 &gt; $arg">0</if><insert ref="arg"/></define>

  <define id="edit_time"><insert ref="edit_hour(hour=$time / 3600, prefix=$prefix)"/><insert ref="edit_minute(minute=$time % 3600 / 60, prefix=$prefix)"/></define>

  <define id="edit_hour"><insert ref="select_number(name=${prefix}+'hour', start=0, end=23, default=$hour)"/></define>

  <define id="edit_minute">
    <select name="${prefix}minute">
      <iter ref="request:utility:range(start=0, end=6)">
        <if cond="$minute == 10 * $:">
          <option value="$to_string(arg=10 * $:)" selected="selected">
            <insert ref="to_2char(arg=10 * $:)"/>
          </option>
          <else>
            <option value="$to_string(arg=10 * $:)">
              <insert ref="to_2char(arg=10 * $:)"/>
            </option>
          </else>
        </if>
      </iter>
    </select>
  </define>

  <!-- ==========================================================
       edit_date(year, month, day, prefix)

       Returns a elements which represents a editor for date.
       ========================================================== -->
  <define id="edit_date">
    <insert ref="edit_year(year=$year, prefix=$prefix)"/>
    <insert ref="edit_month(month=$month, prefix=$prefix)"/>
    <insert ref="edit_day(day=$day, prefix=$prefix)"/>
  </define>

  <define id="edit_year"><insert ref="select_from_list_js(list=$request:utility:years(year=$year), name=${prefix}+'year', default=$year, script='verifyDay(month,day,year)')"/></define>

  <define id="edit_month"><insert ref="select_from_list_js(list=$request:utility:months, name=${prefix}+'month',default=$month,script='verifyDay(month,day,year)')"/></define>

  <define id="edit_day"><insert ref="select_from_list_js(list=$request:utility:days,name=${prefix}+'day',default=$day,script='verifyDay(month,day,year)')"/></define>

  <!-- =====================================================================
       props_to_csv(props)
       Returns a list of name/label pairs to pass ValidateForm.
       ====================================================================== -->
  <define id="props_to_csv"><iter ref="props">'<insert ref=":name"/>', '<insert ref=":label"/>'<if cond="not $:_last">, </if></iter></define>

  <!-- ==========================================================
       view_prop(prop)

       Returns a TR element which represents a pair of value and name
       of specified property.
       ========================================================== -->
  <define id="view_prop">
    <tr>
      <!--<td align="right"><b><insert ref="prop:label"></insert>:</b></td>-->
      <td align="right"><b><insert ref="prop_label(prop=$prop)"/></b></td>
      <td>
        <if cond="$prop:type == 'email'">
          <iter ref="prop:addresses">
            <a href="$:get_url"><insert ref=":value"/></a>
            <if cond="$:_last!=1">,</if>
          </iter>
          <else>
            <insert ref="request:html:replace_br(astring=$request:html:escape(astring=$prop:gets))"/>
          </else>
        </if>
      </td>
    </tr>
  </define>

  <!-- ==========================================================
       view_subscriptions_received(object)

       Returns a TR element which represents subscriptions_received.
       ========================================================== -->
  <define id="view_subscriptions_received">
    <tr>
      <td valign="top" align="right">
        <insert ref="viewdef:dslib:PropHelp(name='subscriptions_received.User')"/>
      </td>
      <td>

        <iter ref="object:subscriptions_received">
          <a href="${cgi}Services/$:handle" class="fieldvalue"><insert ref="request:html:escape(astring=$:title:gets)"/></a>
          <if cond="not $:_last">, </if>
        </iter>
      </td>
    </tr>
  </define>


  <!-- ==========================================================
       view_standard_props(object)

       Returns TR elements representing standard props and links.
       (title, description, summary, keywords, owner, create_date,
       modified_date, modified_by, subscriptions)

       ========================================================== -->
  <define id="view_standard_props">
    <insert ref="view_title(object=$object)"/>
    <insert ref="view_prop(prop=$object:summary)"/>
    <insert ref="view_prop(prop=$object:description)"/>
    <insert ref="view_prop(prop=$object:keywords)"/>
    <insert ref="view_owner(object=$object)"/>
    <insert ref="view_prop(prop=$object:create_date)"/>
    <insert ref="view_prop(prop=$object:modified_date)"/>
    <insert ref="view_modified_by(object=$object)"/>
  </define>

  <!-- ==========================================================
       view_title(object)

       Returns a TR element which represents a pair of value and name
       of title.
       ========================================================== -->
  <define id="view_title">
    <tr>
      <td align="right">
        <b><insert ref="object:title:label"/>:</b>
      </td>
      <td>
        <a href="$object:get_url"><insert ref="request:html:escape(astring=$object:title:gets)"/></a>
      </td>
    </tr>
  </define>

  <!-- ==========================================================
       view_owner(object)

       Returns a TR element which represents owner.
       ========================================================== -->
  <define id="view_owner">
    <tr>
      <td align="right">
        <b><insert ref="request:objmgr:view_link_label(name='owner')"/>:</b>
      </td>
      <td>
        <with ref="object:owner">
          <if cond="$:is_readable_properties">
            <a href="${cgi}ViewProps/${:handle}"><insert ref="request:html:escape(astring=$:title:gets)"/></a>
            <else>
              <insert ref="viewdef:message:unknown"/>
            </else>
          </if>
        </with>
      </td>
    </tr>
  </define>

  <!-- ==========================================================
       view_modified_by(object)

       Returns a TR element which represents modified_by.
       ========================================================== -->
  <define id="view_modified_by">
    <tr>
      <td align="right">
        <b><insert ref="request:objmgr:view_link_label(name='modified_by')"/>:</b>
      </td>
      <td>
        <with ref="object:modified_by">
          <if cond="$:is_readable_properties">
            <a href="${cgi}ViewProps/$:handle"><insert ref="request:html:escape(astring=$:title:gets)"/></a>
            <else>
              <insert ref="viewdef:message:blank"/>
            </else>
          </if>
        </with>
      </td>
    </tr>
  </define>

  <define id="space_name"><if cond="${request:within_space}"><insert ref="request:space_name"/></if></define>

  <define id="ListingHeader">
    <define id="listingFormName"><if cond="${caller} == 'search' or ${caller} == 'search_mail'">ViewList<else>ToolbarMulti</else></if></define>
    <thead>
    <tr>
        <if cond="${caller}!='discussion' and ${caller}!='mailmessagethread' and ${caller}!='duplicateItems' and ${caller}!='favoritesPopup'">
        <if cond="${request:isLocalSite}=='true'">
            <th class="nospace checkbox">
            <if cond="${request:directory:is_logged_in_user}">
              <if cond="${viewdef:dslib:runjs}=='Yes'">
                  <input type="checkbox" name="selectcheckbox" value="selected"
                         id="select_all_checkbox"
                         class="checkbox"
                         title="${viewdef:dslibMessages:selectCheckboxes}"
                         onclick="if (this.checked==true) { SelectAll(true); this.checked = true; } else { SelectAll(false); this.checked = false; }"
                         onmouseover="if (this.checked==true) { describe('${viewdef:dslibMessages:clickToUnselectAll}'); } else { describe('${viewdef:dslibMessages:clickToSelectAll}'); }; return true;"
                         onmouseout="clearstatus();"/>
                  <label for="select_all_checkbox">&nbsp;</label>
                <else>
                  <img src="${request:config:abs_path}images/checkbox.gif" alt="${viewdef:dslibMessages:selectCheckboxes}" title="${viewdef:dslibMessages:selectCheckboxes}"/>
                </else>
              </if>
              <else>
                <insert ref="viewdef:dslib:nbsp"/>
              </else>
            </if>
          </th>
        </if>
      </if>
      <if cond="${caller}=='favorites'">
        <th class="icon"><a href="${request:pagedUri(caller='${caller}', javaClass='FavoritesListImpl', sessionKey='com.xerox.docushare.favorites${local:space_name}')}?sortOrder=TypeAndTitle" class="variablewidth9urlbold" title="${viewdef:dslibMessages:clickSortTypeTitle}" target="${window_target}"><insert ref="viewdef:dslibMessages:type" /></a></th>
        <th class="name"><a href="${request:pagedUri(caller='${caller}', javaClass='FavoritesListImpl', sessionKey='com.xerox.docushare.favorites${local:space_name}')}?sortOrder=Title" class="variablewidth9urlbold" title="${viewdef:dslibMessages:clickSortTitle}" target="${window_target}"><insert ref="request:propLabel(longPropName='Object.title')" /></a></th>
        <th class="generic"><insert ref="viewdef:dslibMessages:owner" /></th>
        <if cond="$request:config:enable_security_icon"><th class="nospace"><insert ref="viewdef:dslib:nbsp"/></th></if>
        <th class="generic"><a href="${request:pagedUri(caller='${caller}', javaClass='FavoritesListImpl', sessionKey='com.xerox.docushare.favorites${local:space_name}')}?sortOrder=Date" class="variablewidth9urlbold" title="${viewdef:dslibMessages:clickSortDate}" target="${window_target}"><insert ref="request:propLabel(longPropName='Object.modified_date')" /></a></th>
        <th class="generic"><insert ref="viewdef:dslibMessages:size" /></th>
          <elif cond="${caller}=='favoritesPopup'">
            <th></th>
            <th class="name"><a href="${request:pagedUri(caller='${caller}', javaClass='FavoritesListImpl', sessionKey='com.xerox.docushare.favorites${local:space_name}')}?sortOrder=Title" class="variablewidth9urlbold" title="${viewdef:dslibMessages:clickSortTitle}" target="${window_target}"><insert ref="request:propLabel(longPropName='Object.title')" /></a></th>
            <th class="generic"><insert ref="viewdef:dslibMessages:owner" /></th>
            <if cond="$request:config:enable_security_icon"><th class="nospace"><insert ref="viewdef:dslib:nbsp"/></th></if>
            <th class="generic"><a href="${request:pagedUri(caller='${caller}', javaClass='FavoritesListImpl', sessionKey='com.xerox.docushare.favorites${local:space_name}')}?sortOrder=Date" class="variablewidth9urlbold" title="${viewdef:dslibMessages:clickSortDate}" target="${window_target}"><insert ref="request:propLabel(longPropName='Object.modified_date')" /></a></th>
            <th class="generic"><insert ref="viewdef:dslibMessages:size" /></th>
          </elif>

        <elif cond="${caller}=='mailmessagethread'">
          <th class="icon"><insert ref="viewdef:dslib:nbsp" /></th>
          <th class="name"><insert ref="viewdef:dslibMessages:subject" /></th>
          <th width="1" align="left"/>
          <th class="generic"><insert ref="viewdef:dslibMessages:from" /></th>
          <th class="generic"><insert ref="viewdef:dslibMessages:owner" /></th>
          <if cond="$request:config:enable_security_icon">
            <th class="nospace"><insert ref="viewdef:dslib:nbsp" /></th>
          </if>
          <th class="generic"><insert ref="viewdef:dslibMessages:recieved" /></th>
          <th class="generic"><insert ref="viewdef:dslibMessages:attach" /></th>
        </elif>
        <elif cond="${caller}=='mailmessage'">
          <th class="name"><a href="${request:pagedUri(caller='${caller}')}?sortOrder=TypeAndTitle" title="${viewdef:dslibMessages:clickSortTypeTitle}" target="${window_target}"><insert ref="viewdef:dslibMessages:type" /></a></th>
          <th class="name"><a href="${request:pagedUri(caller='${caller}')}?sortOrder=Title" title="${viewdef:dslibMessages:clickToSortSubject}" target="${window_target}"><insert ref="viewdef:dslibMessages:subject" /></a></th>
          <th class="generic"><insert ref="viewdef:dslib:nbsp" /></th>
          <th>
            <a href="${request:pagedUri(caller='${caller}')}?sortOrder=MailMessage.from" title="${viewdef:dslibMessages:clickSortAddress}" target="${window_target}"><insert ref="viewdef:dslibMessages:from" /></a>
          </th>
          <th class="generic">
            <a href="${request:pagedUri(caller='${caller}')}?sortOrder=Owner" title="${viewdef:dslibMessages:clickSortOwner}" target="${window_target}"><insert ref="viewdef:dslibMessages:owner" /></a>
          </th>
          <if cond="$request:config:enable_security_icon">
            <th class="nospace">
              <insert ref="viewdef:dslib:nbsp" />
            </th>
          </if>
          <th class="generic">
            <a href="${request:pagedUri(caller='${caller}')}?sortOrder=Date" class="variablewidth9urlbold" title="${viewdef:dslibMessages:clickSortDate}" target="${window_target}"><insert ref="viewdef:dslibMessages:recieved" /></a>
          </th>
          <th>
            <a href="${request:pagedUri(caller='${caller}')}?sortOrder=TypeAndSize" class="variablewidth9urlbold" title="${viewdef:dslibMessages:clickSortAttachments}" target="${window_target}"><insert ref="viewdef:dslibMessages:attach" /></a>
          </th>
        </elif>
        <elif cond="${caller}=='discussion'">
          <td align="left" width="${request:discussion_width}" class="VariableWidth9Bold">
            <if cond="${request:directory:is_logged_in_user}">
              <if cond="${viewdef:dslib:runjs}=='Yes'">
                <input type="checkbox" name="selectcheckbox" value="selected" onclick="if (this.checked==true) { SelectAll(true); this.checked = true; } else { SelectAll(false); this.checked = false; }" onmouseover="if (this.checked==true) { describe('${viewdef:dslibMessages:clickToUnselectAll}'); } else { describe('${viewdef:dslibMessages:clickToSelectAll}'); }; return true;" onmouseout="clearstatus();"/>
                <else>
                  <img src="${request:config:abs_path}images/checkbox.gif" alt="${viewdef:dslibMessages:selectCheckboxes}" title="${viewdef:dslibMessages:selectCheckboxes}"/>
                  <!--<INPUT TYPE="reset" VALUE="Clear" class="bs"/>-->
                  <!-- If no javascript, I'll put the clear button in the tool bar -->
                </else>
              </if>
            </if>
            <a href="${request:pagedUri(caller='${caller}')}?sortOrder=Title" class="variablewidth9urlbold" title="${viewdef:dslibMessages:clickToSortSubject}" target="${window_target}"><insert ref="viewdef:dslibMessages:subject" /></a>
          </td>
          <td width="${request:owner_width}" align="center" class="VariableWidth9Bold"><insert ref="viewdef:dslibMessages:owner" /></td>
          <if cond="$request:config:enable_security_icon"><td width="1" align="center" class="VariableWidth9Bold"/></if>
          <td width="${request:date_width}" align="center"><a href="${request:pagedUri(caller='${caller}')}?sortOrder=Date" class="variablewidth9urlbold" title="${viewdef:dslibMessages:clickSortDate}" target="${window_target}"><insert ref="request:propLabel(longPropName='Object.modified_date')" /></a></td>
          <td><img border="0" alt="|" width="32" src="${request:config:abs_path}images/local/dot_clear.gif"/></td>
        </elif>
        <else>
          <th class="icon"><insert ref="viewdef:dslibMessages:type" /></th>
          <th class="name"><insert ref="request:propLabel(longPropName='Object.title')" /></th>
          <th><insert ref="viewdef:dslibMessages:owner" /></th>
          <if cond="$request:config:enable_security_icon"><th><insert ref="viewdef:dslib:nbsp"/></th></if>
          <th><insert ref="request:propLabel(longPropName='Object.modified_date')" /></th>
          <th><insert ref="viewdef:dslibMessages:size" /></th>
        </else>
      </if>
        <if cond="${caller}!='discussion' and ${caller}!='favoritesPopup'">
          <th class="actions_th_nomore"><insert ref="viewdef:dslibMessages:actions" /></th>
      </if>
    </tr>
    </thead>
  </define>

  <define id="PropHelp">
    <!-- Call this method when the link label on your page is the same as the label in the help text. -->
    <!-- called by: <insert ref="viewdef:dslib:PropHelp(name='object_types')"/>-->
    <define id="label"><insert ref="request:objmgr:view_prop_label(name='${name}')"/></define>
    <a rel="help" href="${local:cgi}PropHelp/${name}" class='fieldname labelHelpLink' target="${window_target}"><insert ref="label"/>:</a>
  </define>

  <define id="PropHelpPlusLabel"><!-- Call this method when the link label on your page is different than the label in the help text (allows a little flexability). --><!-- called by: <insert ref="viewdef:dslib:PropHelpPlusLabel(name='maximum_results_query', linklabel='Maximum Results:', class='fieldname', colon='yes')"/>--><!--
   --><a rel="help" href="${local:cgi}PropHelp/${name}" class="${class}" target="${window_target}"><insert ref="linklabel labelHelpLink ${class}"/><if cond="${colon}=='yes'">:</if></a><!--
   --></define>

  <!-- Insert this in head instead of adding attributes to body -->
  <define id="backgroundStyle">
    <style type="text/css">
      body {
      background-color: <insert ref="request:config:bgcolor"/>;
      <if cond="${request:has_object} and ${request:object:has_bg_image}">
        background: url(<insert ref="request:object:get_bg_image"/>);
        <elif cond="${request:config:background} != ''">
          background: url(<insert ref="request:config:background"/>);
        </elif>
      </if>
      }
    </style>
  </define>

  <!-- Someone please help me find the VDF*.java function for this -->
  <define
      id="baseClassName"><if
                             cond="${request:is_type_of( classname='$classname', base_class='Event' )}">Event<elif
                             cond="${request:is_type_of( classname='$classname', base_class='Bulletin' )}">Bulletin</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='Subscription' )}">Subscription</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='Wiki' )}">Wiki</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='WikiEntry' )}">WikiEntry</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='Collection' )}">Collection</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='Document' )}">Document</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='Version' )}">Version</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='URL' )}">URL</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='BulletinBoard' )}">BulletinBoard</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='Calendar' )}">Calendar</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='SavedQuery' )}">SavedQuery</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='WeblogEntry' )}">WeblogEntry</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='Weblog' )}">Weblog</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='Wiki' )}">Wiki</elif>
  <elif
      cond="${request:is_type_of( classname='$classname', base_class='WikiPage' )}">WikiPage</elif>
  <else>Generic</else>
  </if></define>

  <!-- Handle results of multiple Routing checkboxes -->
  <define id="process_route_handles">
    <if cond="${viewdef:dslib:runjs}=='Yes'">
      <define id="route_handles"><insert ref="request:get_value(parameter='route')" /></define>
      <if cond="${local:route_handles}!=''">
        <script type="text/javascript" src="${request:config:abs_path}javascript/common/ds_routing.js?v=${request:config:short_version}" />
        <script type="text/javascript">
          var location_base = '<insert ref="request:config:abs_path"/>';
          var handles = '<insert ref="local:route_handles"/>';
          addOnLoadHandler(function() { openRoutingSlip(location_base, handles); } );
        </script>
        <insert ref="request:remove_value(parameter='route')"/>
      </if>
    </if>
  </define>

</viewdef>
